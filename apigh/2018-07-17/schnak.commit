{
  "sha": "453d33dcfc450b01543ed1ffccb449740934af87",
  "node_id": "MDY6Q29tbWl0MTA1Nzg5MzY1OjQ1M2QzM2RjZmM0NTBiMDE1NDNlZDFmZmNjYjQ0OTc0MDkzNGFmODc=",
  "commit": {
    "author": {
      "name": "g-div",
      "email": "g-div@anche.no",
      "date": "2018-06-07T11:32:03Z"
    },
    "committer": {
      "name": "g-div",
      "email": "g-div@anche.no",
      "date": "2018-06-07T11:32:07Z"
    },
    "message": "fix(RSS): use temporary site_url\n\nCloses #74",
    "tree": {
      "sha": "0449f458e49f119337fe440bf6d58f67fdf8f822",
      "url": "https://api.github.com/repos/schn4ck/schnack/git/trees/0449f458e49f119337fe440bf6d58f67fdf8f822"
    },
    "url": "https://api.github.com/repos/schn4ck/schnack/git/commits/453d33dcfc450b01543ed1ffccb449740934af87",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/schn4ck/schnack/commits/453d33dcfc450b01543ed1ffccb449740934af87",
  "html_url": "https://github.com/schn4ck/schnack/commit/453d33dcfc450b01543ed1ffccb449740934af87",
  "comments_url": "https://api.github.com/repos/schn4ck/schnack/commits/453d33dcfc450b01543ed1ffccb449740934af87/comments",
  "author": {
    "login": "g-div",
    "id": 3722536,
    "node_id": "MDQ6VXNlcjM3MjI1MzY=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/3722536?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/g-div",
    "html_url": "https://github.com/g-div",
    "followers_url": "https://api.github.com/users/g-div/followers",
    "following_url": "https://api.github.com/users/g-div/following{/other_user}",
    "gists_url": "https://api.github.com/users/g-div/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/g-div/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/g-div/subscriptions",
    "organizations_url": "https://api.github.com/users/g-div/orgs",
    "repos_url": "https://api.github.com/users/g-div/repos",
    "events_url": "https://api.github.com/users/g-div/events{/privacy}",
    "received_events_url": "https://api.github.com/users/g-div/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "g-div",
    "id": 3722536,
    "node_id": "MDQ6VXNlcjM3MjI1MzY=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/3722536?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/g-div",
    "html_url": "https://github.com/g-div",
    "followers_url": "https://api.github.com/users/g-div/followers",
    "following_url": "https://api.github.com/users/g-div/following{/other_user}",
    "gists_url": "https://api.github.com/users/g-div/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/g-div/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/g-div/subscriptions",
    "organizations_url": "https://api.github.com/users/g-div/orgs",
    "repos_url": "https://api.github.com/users/g-div/repos",
    "events_url": "https://api.github.com/users/g-div/events{/privacy}",
    "received_events_url": "https://api.github.com/users/g-div/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "76fd6c02db9c4982218fa0abb3ee2f267459cab9",
      "url": "https://api.github.com/repos/schn4ck/schnack/commits/76fd6c02db9c4982218fa0abb3ee2f267459cab9",
      "html_url": "https://github.com/schn4ck/schnack/commit/76fd6c02db9c4982218fa0abb3ee2f267459cab9"
    }
  ],
  "stats": {
    "total": 4,
    "additions": 3,
    "deletions": 1
  },
  "files": [
    {
      "sha": "ef24513922e51e303d0a07334ea9cc8fcfb6c944",
      "filename": "src/server.js",
      "status": "modified",
      "additions": 3,
      "deletions": 1,
      "changes": 4,
      "blob_url": "https://github.com/schn4ck/schnack/blob/453d33dcfc450b01543ed1ffccb449740934af87/src/server.js",
      "raw_url": "https://github.com/schn4ck/schnack/raw/453d33dcfc450b01543ed1ffccb449740934af87/src/server.js",
      "contents_url": "https://api.github.com/repos/schn4ck/schnack/contents/src/server.js?ref=453d33dcfc450b01543ed1ffccb449740934af87",
      "patch": "@@ -125,9 +125,11 @@ function run(db) {\n \n     // rss feed of comments in need of moderation\n     app.get('/feed', (request, reply) => {\n+        const user = getUser(request);\n+        if (!isAdmin(user)) return reply.status(403).send({error: 'Forbidden'});\n         var feed = new RSS({\n             title: 'Awaiting moderation',\n-            site_url: config.allow_origin[0] // @FIXME\n+            site_url: config.get('schnack_host')\n         });\n         db.each(queries.awaiting_moderation, (err, row) => {\n             if (err) console.error(err.message);"
    }
  ]
}
