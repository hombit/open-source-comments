{
  "sha": "1c7482e37e9a1a25dfabc06725548d71dd33058d",
  "node_id": "MDY6Q29tbWl0MTIwMTkwOTU3OjFjNzQ4MmUzN2U5YTFhMjVkZmFiYzA2NzI1NTQ4ZDcxZGQzMzA1OGQ=",
  "commit": {
    "author": {
      "name": "Viktoras",
      "email": "vkuznecovas@users.noreply.github.com",
      "date": "2018-07-30T10:00:14Z"
    },
    "committer": {
      "name": "GitHub",
      "email": "noreply@github.com",
      "date": "2018-07-30T10:00:14Z"
    },
    "message": "Improve test coverage for the global package (#88)\n\n* We now correctly set the max author length, independent of the commend length. Also tests for config\r\n\r\n* testing of global",
    "tree": {
      "sha": "c70efd260b14cbda8d3c1fa4065fbb54afc9af61",
      "url": "https://api.github.com/repos/vkuznecovas/mouthful/git/trees/c70efd260b14cbda8d3c1fa4065fbb54afc9af61"
    },
    "url": "https://api.github.com/repos/vkuznecovas/mouthful/git/commits/1c7482e37e9a1a25dfabc06725548d71dd33058d",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJbXuGuCRBK7hj4Ov3rIwAAdHIIAGOcks3yc2j+FZUEURl9fSpl\nKkhzWeUZv3nAneiRIbf/uQvJnEJBc6cOobgCKw/Mfu3TI1HMJ5PC+cb2yZc5Afkr\ngMERxIs7u7ecIkpE0IVSg38XrRqt8KqqyHe/inKQnhr0GtKEfXGndfylMkik96Sv\nEKYNPuTn5uGZsIBkr0kbu2ley2NWTwLZnYIC7SeVcC7O8F46MteCToNB1yX/lo5b\nD/uco6akRwlMOljdtAJRyvDNmwEQXTpfNgRDqs5qZ9Wabq52hWaw/bEDX4FLOuvo\n2/BpZJQxgZrWCvn2yn37ecUR6v6wWp7jic4bIBB1iv28/Y3Vdt/2elUzo8PRPzE=\n=EADc\n-----END PGP SIGNATURE-----\n",
      "payload": "tree c70efd260b14cbda8d3c1fa4065fbb54afc9af61\nparent e78842507f7fd6bdb0eca80c0566726f1495f533\nauthor Viktoras <vkuznecovas@users.noreply.github.com> 1532944814 +0300\ncommitter GitHub <noreply@github.com> 1532944814 +0300\n\nImprove test coverage for the global package (#88)\n\n* We now correctly set the max author length, independent of the commend length. Also tests for config\r\n\r\n* testing of global\r\n"
    }
  },
  "url": "https://api.github.com/repos/vkuznecovas/mouthful/commits/1c7482e37e9a1a25dfabc06725548d71dd33058d",
  "html_url": "https://github.com/vkuznecovas/mouthful/commit/1c7482e37e9a1a25dfabc06725548d71dd33058d",
  "comments_url": "https://api.github.com/repos/vkuznecovas/mouthful/commits/1c7482e37e9a1a25dfabc06725548d71dd33058d/comments",
  "author": {
    "login": "vkuznecovas",
    "id": 18392269,
    "node_id": "MDQ6VXNlcjE4MzkyMjY5",
    "avatar_url": "https://avatars2.githubusercontent.com/u/18392269?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vkuznecovas",
    "html_url": "https://github.com/vkuznecovas",
    "followers_url": "https://api.github.com/users/vkuznecovas/followers",
    "following_url": "https://api.github.com/users/vkuznecovas/following{/other_user}",
    "gists_url": "https://api.github.com/users/vkuznecovas/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vkuznecovas/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vkuznecovas/subscriptions",
    "organizations_url": "https://api.github.com/users/vkuznecovas/orgs",
    "repos_url": "https://api.github.com/users/vkuznecovas/repos",
    "events_url": "https://api.github.com/users/vkuznecovas/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vkuznecovas/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "web-flow",
    "id": 19864447,
    "node_id": "MDQ6VXNlcjE5ODY0NDQ3",
    "avatar_url": "https://avatars3.githubusercontent.com/u/19864447?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/web-flow",
    "html_url": "https://github.com/web-flow",
    "followers_url": "https://api.github.com/users/web-flow/followers",
    "following_url": "https://api.github.com/users/web-flow/following{/other_user}",
    "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions",
    "organizations_url": "https://api.github.com/users/web-flow/orgs",
    "repos_url": "https://api.github.com/users/web-flow/repos",
    "events_url": "https://api.github.com/users/web-flow/events{/privacy}",
    "received_events_url": "https://api.github.com/users/web-flow/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "e78842507f7fd6bdb0eca80c0566726f1495f533",
      "url": "https://api.github.com/repos/vkuznecovas/mouthful/commits/e78842507f7fd6bdb0eca80c0566726f1495f533",
      "html_url": "https://github.com/vkuznecovas/mouthful/commit/e78842507f7fd6bdb0eca80c0566726f1495f533"
    }
  ],
  "stats": {
    "total": 127,
    "additions": 118,
    "deletions": 9
  },
  "files": [
    {
      "sha": "4c59ffc23594c8bc52e946255d47f1208c0791df",
      "filename": "global/admin.go",
      "status": "modified",
      "additions": 2,
      "deletions": 9,
      "changes": 11,
      "blob_url": "https://github.com/vkuznecovas/mouthful/blob/1c7482e37e9a1a25dfabc06725548d71dd33058d/global/admin.go",
      "raw_url": "https://github.com/vkuznecovas/mouthful/raw/1c7482e37e9a1a25dfabc06725548d71dd33058d/global/admin.go",
      "contents_url": "https://api.github.com/repos/vkuznecovas/mouthful/contents/global/admin.go?ref=1c7482e37e9a1a25dfabc06725548d71dd33058d",
      "patch": "@@ -19,11 +19,7 @@ func OverrideScriptRootInAdminHTML(prefix, filepath string) error {\n \tif err != nil {\n \t\treturn err\n \t}\n-\tr, err := regexp.Compile(scriptOverridePattern)\n-\tif err != nil {\n-\t\treturn err\n-\t}\n-\n+\tr := regexp.MustCompile(scriptOverridePattern)\n \tnewHTML := string(b)\n \tres := r.FindAllSubmatch(b, -1)\n \tfor _, v := range res {\n@@ -52,10 +48,7 @@ func OverrideScriptPathInBundle(prefix, filepath string) error {\n \t\tprefix += \"/\"\n \t}\n \n-\tr, err := regexp.Compile(budleOverridePattern)\n-\tif err != nil {\n-\t\treturn err\n-\t}\n+\tr := regexp.MustCompile(budleOverridePattern)\n \tnewHTML := string(b)\n \tsplits := r.FindStringSubmatchIndex(newHTML)\n \tif len(splits) != 4 {"
    },
    {
      "sha": "7e29b698ec96fcc9162b7c32aa8026f6a7bb7f1d",
      "filename": "global/admin_test.go",
      "status": "modified",
      "additions": 99,
      "deletions": 0,
      "changes": 99,
      "blob_url": "https://github.com/vkuznecovas/mouthful/blob/1c7482e37e9a1a25dfabc06725548d71dd33058d/global/admin_test.go",
      "raw_url": "https://github.com/vkuznecovas/mouthful/raw/1c7482e37e9a1a25dfabc06725548d71dd33058d/global/admin_test.go",
      "contents_url": "https://api.github.com/repos/vkuznecovas/mouthful/contents/global/admin_test.go?ref=1c7482e37e9a1a25dfabc06725548d71dd33058d",
      "patch": "@@ -107,6 +107,16 @@ func TestOverrideScriptPathInBundle(t *testing.T) {\n \tassert.Nil(t, err)\n }\n \n+func TestOverrideScriptPathInBundle_Errors_On_No_File(t *testing.T) {\n+\terr := global.OverrideScriptPathInBundle(\"/\", \"this does not exist\")\n+\tassert.Error(t, err)\n+}\n+\n+func TestOverrideScriptPathInAdminHTML_Errors_On_No_File(t *testing.T) {\n+\terr := global.OverrideScriptRootInAdminHTML(\"/\", \"this does not exist\")\n+\tassert.Error(t, err)\n+}\n+\n func TestOverrideScriptPathInBundleReturnsErrorOnWrongSliceLength(t *testing.T) {\n \tfilepath := \"./t.js\"\n \n@@ -145,3 +155,92 @@ func TestFindAdminPanelChunkFilename(t *testing.T) {\n \terr = os.Remove(filepath)\n \tassert.Nil(t, err)\n }\n+\n+func TestRewriteAdminPanelScripts_CouldNotOverrideRoot(t *testing.T) {\n+\terr := global.RewriteAdminPanelScripts(\"filepath\")\n+\tassert.NotNil(t, err)\n+\tassert.Equal(t, \"Couldn't override the static admin html root. Please check if the file index file(./static/index.html) is available and the mouthful user has the permissions to access it\", err.Error())\n+}\n+\n+func TestRewriteAdminPanelScripts_CouldNotFindBundle(t *testing.T) {\n+\tfilepath := \"./static/index.html\"\n+\n+\tvar _, err = os.Stat(filepath)\n+\t// create file if not exists\n+\tif os.IsNotExist(err) {\n+\t\terr := os.Mkdir(\"./static\", 0777)\n+\t\tassert.Nil(t, err)\n+\n+\t\tassert.Nil(t, err)\n+\t\tfile, err := os.Create(filepath)\n+\t\tassert.Nil(t, err)\n+\t\tdefer file.Close()\n+\t\tdefer os.RemoveAll(filepath)\n+\t\tdefer os.RemoveAll(\"./static\")\n+\t\t_, err = file.WriteString(input)\n+\t\tassert.Nil(t, err)\n+\n+\t\tfile.Close()\n+\t}\n+\terr = global.RewriteAdminPanelScripts(\"/test\")\n+\tassert.NotNil(t, err)\n+\tassert.Equal(t, \"Couldn't find the admin panel chunk file. Please check if the budle file is available and the mouthful user has permissions to access it in the directory ./static\", err.Error())\n+}\n+\n+func TestRewriteAdminPanelScripts_CouldNotOverrideBundle(t *testing.T) {\n+\tfilepath := \"./static/index.html\"\n+\tbundlePath := \"./static/bundle.2aa25.js\"\n+\tvar _, err = os.Stat(filepath)\n+\t// create file if not exists\n+\tif os.IsNotExist(err) {\n+\t\terr := os.Mkdir(\"./static\", 0777)\n+\t\tassert.Nil(t, err)\n+\t\tfile, err := os.Create(bundlePath)\n+\t\tdefer os.RemoveAll(bundlePath)\n+\t\tassert.Nil(t, err)\n+\t\tfile, err = os.Create(filepath)\n+\t\tassert.Nil(t, err)\n+\t\tdefer file.Close()\n+\t\tdefer os.RemoveAll(filepath)\n+\t\tdefer os.RemoveAll(\"./static\")\n+\t\t_, err = file.WriteString(input)\n+\t\tassert.Nil(t, err)\n+\t\tfile.Close()\n+\t}\n+\terr = global.RewriteAdminPanelScripts(\"/test\")\n+\tassert.NotNil(t, err)\n+\tassert.Equal(t, \"Couldn't override the static admin script path. Please check if the script file(./static/bundle.2aa25.js) is available and the mouthful user has the permissions to access it\", err.Error())\n+}\n+\n+func TestRewriteAdminPanelScripts_OK(t *testing.T) {\n+\tfilepath := \"./static/index.html\"\n+\tbundlePath := \"./static/bundle.2aa25.js\"\n+\tvar _, err = os.Stat(filepath)\n+\t// create file if not exists\n+\tif os.IsNotExist(err) {\n+\t\terr := os.Mkdir(\"./static\", 0777)\n+\t\tassert.Nil(t, err)\n+\t\tbundleFile, err := os.Create(bundlePath)\n+\t\tdefer os.RemoveAll(bundlePath)\n+\t\tassert.Nil(t, err)\n+\t\t_, err = bundleFile.WriteString(scriptInput)\n+\t\tassert.Nil(t, err)\n+\t\tbundleFile.Close()\n+\t\tfile, err := os.Create(filepath)\n+\t\tassert.Nil(t, err)\n+\t\tdefer file.Close()\n+\t\tdefer os.RemoveAll(filepath)\n+\t\tdefer os.RemoveAll(\"./static\")\n+\t\t_, err = file.WriteString(input)\n+\t\tassert.Nil(t, err)\n+\t\tfile.Close()\n+\t}\n+\terr = global.RewriteAdminPanelScripts(\"/test\")\n+\tassert.Nil(t, err)\n+}\n+\n+func TestFindAdminPanelChunkFilename_Errors_On_No_file(t *testing.T) {\n+\tparsedName, err := global.FindAdminPanelChunkFilename(\"./\")\n+\tassert.Equal(t, \"\", parsedName)\n+\tassert.Error(t, err)\n+}"
    },
    {
      "sha": "a4c6e01970a82b1cd46395bb25c9c8872c0ac17b",
      "filename": "global/enum_test.go",
      "status": "added",
      "additions": 17,
      "deletions": 0,
      "changes": 17,
      "blob_url": "https://github.com/vkuznecovas/mouthful/blob/1c7482e37e9a1a25dfabc06725548d71dd33058d/global/enum_test.go",
      "raw_url": "https://github.com/vkuznecovas/mouthful/raw/1c7482e37e9a1a25dfabc06725548d71dd33058d/global/enum_test.go",
      "contents_url": "https://api.github.com/repos/vkuznecovas/mouthful/contents/global/enum_test.go?ref=1c7482e37e9a1a25dfabc06725548d71dd33058d",
      "patch": "@@ -0,0 +1,17 @@\n+package global_test\n+\n+import (\n+\t\"testing\"\n+\n+\t\"github.com/stretchr/testify/assert\"\n+\n+\t\"github.com/vkuznecovas/mouthful/global\"\n+)\n+\n+func TestCleanupTypeString(t *testing.T) {\n+\tsomethingElseEntirely := global.CleanupType(-1)\n+\n+\tassert.Equal(t, \"CleanupType(-1)\", somethingElseEntirely.String())\n+\tassert.Equal(t, \"Unconfirmed\", global.Unconfirmed.String())\n+\tassert.Equal(t, \"Deleted\", global.Deleted.String())\n+}"
    }
  ]
}
