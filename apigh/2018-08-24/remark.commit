{
  "sha": "419d2ae75e558d32ddb930e8beecc0e990d2ad28",
  "node_id": "MDY6Q29tbWl0MTE0ODI5NTAzOjQxOWQyYWU3NWU1NThkMzJkZGI5MzBlOGJlZWNjMGU5OTBkMmFkMjg=",
  "commit": {
    "author": {
      "name": "Alexandr K",
      "email": "akplus3@gmail.com",
      "date": "2018-08-23T16:46:16Z"
    },
    "committer": {
      "name": "Aleksei Gurianov",
      "email": "gurianov@gmail.com",
      "date": "2018-08-23T16:46:16Z"
    },
    "message": "Add focus-visible polyfill, issue #187 (#193)\n\n* add focus-visible polyfill\r\n* remove unnecessary outline: none from styles\r\n* make buttons Pin, Block, Delete visible when focused\r\n* fix outline of user details close button\r\n* close user info by ESC\r\n* user info: don't focus the close button",
    "tree": {
      "sha": "3cc2dacf724d21186ac2bcab89bfc93600c4bb12",
      "url": "https://api.github.com/repos/umputun/remark/git/trees/3cc2dacf724d21186ac2bcab89bfc93600c4bb12"
    },
    "url": "https://api.github.com/repos/umputun/remark/git/commits/419d2ae75e558d32ddb930e8beecc0e990d2ad28",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/umputun/remark/commits/419d2ae75e558d32ddb930e8beecc0e990d2ad28",
  "html_url": "https://github.com/umputun/remark/commit/419d2ae75e558d32ddb930e8beecc0e990d2ad28",
  "comments_url": "https://api.github.com/repos/umputun/remark/commits/419d2ae75e558d32ddb930e8beecc0e990d2ad28/comments",
  "author": {
    "login": "Clearic",
    "id": 1527396,
    "node_id": "MDQ6VXNlcjE1MjczOTY=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/1527396?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Clearic",
    "html_url": "https://github.com/Clearic",
    "followers_url": "https://api.github.com/users/Clearic/followers",
    "following_url": "https://api.github.com/users/Clearic/following{/other_user}",
    "gists_url": "https://api.github.com/users/Clearic/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Clearic/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Clearic/subscriptions",
    "organizations_url": "https://api.github.com/users/Clearic/orgs",
    "repos_url": "https://api.github.com/users/Clearic/repos",
    "events_url": "https://api.github.com/users/Clearic/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Clearic/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "Guria",
    "id": 36270,
    "node_id": "MDQ6VXNlcjM2Mjcw",
    "avatar_url": "https://avatars1.githubusercontent.com/u/36270?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Guria",
    "html_url": "https://github.com/Guria",
    "followers_url": "https://api.github.com/users/Guria/followers",
    "following_url": "https://api.github.com/users/Guria/following{/other_user}",
    "gists_url": "https://api.github.com/users/Guria/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Guria/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Guria/subscriptions",
    "organizations_url": "https://api.github.com/users/Guria/orgs",
    "repos_url": "https://api.github.com/users/Guria/repos",
    "events_url": "https://api.github.com/users/Guria/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Guria/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "a6277d764a70c2d3abe81677abe9164f0f96e3cd",
      "url": "https://api.github.com/repos/umputun/remark/commits/a6277d764a70c2d3abe81677abe9164f0f96e3cd",
      "html_url": "https://github.com/umputun/remark/commit/a6277d764a70c2d3abe81677abe9164f0f96e3cd"
    }
  ],
  "stats": {
    "total": 53,
    "additions": 30,
    "deletions": 23
  },
  "files": [
    {
      "sha": "aad6a808d019c5feb2b9b02a7fe3d75d1848954e",
      "filename": "web/app/common/polyfills.js",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/umputun/remark/blob/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/app/common/polyfills.js",
      "raw_url": "https://github.com/umputun/remark/raw/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/app/common/polyfills.js",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/web/app/common/polyfills.js?ref=419d2ae75e558d32ddb930e8beecc0e990d2ad28",
      "patch": "@@ -1,4 +1,5 @@\n import 'core-js/es7/promise';\n+import 'focus-visible';\n \n export default function loadPolyfills() {\n   const fillCoreJs = () => {"
    },
    {
      "sha": "39452f45a232a7322adee6dca18616e3eebbb24a",
      "filename": "web/app/components/comment/__action/comment__action.scss",
      "status": "modified",
      "additions": 0,
      "deletions": 4,
      "changes": 4,
      "blob_url": "https://github.com/umputun/remark/blob/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/app/components/comment/__action/comment__action.scss",
      "raw_url": "https://github.com/umputun/remark/raw/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/app/components/comment/__action/comment__action.scss",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/web/app/components/comment/__action/comment__action.scss?ref=419d2ae75e558d32ddb930e8beecc0e990d2ad28",
      "patch": "@@ -9,10 +9,6 @@\n     color: #31c7c5;\n   }\n \n-  &:focus {\n-    outline: none;\n-  }\n-\n   + .comment__action {\n     margin-left: 8px;\n   }"
    },
    {
      "sha": "53caeef30610938bce08170721160dabb18e8524",
      "filename": "web/app/components/comment/__control/comment__control.scss",
      "status": "modified",
      "additions": 0,
      "deletions": 4,
      "changes": 4,
      "blob_url": "https://github.com/umputun/remark/blob/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/app/components/comment/__control/comment__control.scss",
      "raw_url": "https://github.com/umputun/remark/raw/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/app/components/comment/__control/comment__control.scss",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/web/app/components/comment/__control/comment__control.scss?ref=419d2ae75e558d32ddb930e8beecc0e990d2ad28",
      "patch": "@@ -10,8 +10,4 @@\n   &:hover {\n     color: #0aa;\n   }\n-\n-  &:focus {\n-    outline: none;\n-  }\n }"
    },
    {
      "sha": "056a60ad335beeb54a302cd17f77b70e5545d233",
      "filename": "web/app/components/comment/__controls/comment__controls.scss",
      "status": "modified",
      "additions": 4,
      "deletions": 3,
      "changes": 7,
      "blob_url": "https://github.com/umputun/remark/blob/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/app/components/comment/__controls/comment__controls.scss",
      "raw_url": "https://github.com/umputun/remark/raw/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/app/components/comment/__controls/comment__controls.scss",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/web/app/components/comment/__controls/comment__controls.scss?ref=419d2ae75e558d32ddb930e8beecc0e990d2ad28",
      "patch": "@@ -4,9 +4,10 @@\n   user-select: none;\n   font-size: 14px;\n   font-weight: 700;\n+  opacity: 0;\n \n-  @media (hover: hover) {\n-    font-weight: 700;\n-    opacity: 0;\n+  &:hover,\n+  &:focus-within {\n+    opacity: 1;\n   }\n }"
    },
    {
      "sha": "cf6dc84cef595cecbc335abf9d10a795af12ed30",
      "filename": "web/app/components/comment/__vote/comment__vote.scss",
      "status": "modified",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/umputun/remark/blob/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/app/components/comment/__vote/comment__vote.scss",
      "raw_url": "https://github.com/umputun/remark/raw/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/app/components/comment/__vote/comment__vote.scss",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/web/app/components/comment/__vote/comment__vote.scss?ref=419d2ae75e558d32ddb930e8beecc0e990d2ad28",
      "patch": "@@ -8,7 +8,6 @@\n   background: url('comment__vote.svg') center no-repeat;\n   background-size: contain;\n   cursor: pointer;\n-  outline: none;\n \n   &:hover {\n     background-image: url('_selected/comment__vote_selected.svg');"
    },
    {
      "sha": "92c6948b7465835827e4b95ff75628379f155243",
      "filename": "web/app/components/input/__button/input__button.scss",
      "status": "modified",
      "additions": 0,
      "deletions": 4,
      "changes": 4,
      "blob_url": "https://github.com/umputun/remark/blob/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/app/components/input/__button/input__button.scss",
      "raw_url": "https://github.com/umputun/remark/raw/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/app/components/input/__button/input__button.scss",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/web/app/components/input/__button/input__button.scss?ref=419d2ae75e558d32ddb930e8beecc0e990d2ad28",
      "patch": "@@ -7,10 +7,6 @@\n   border-radius: 2px;\n   cursor: pointer;\n \n-  &:focus {\n-    outline: none;\n-  }\n-\n   &:disabled {\n     opacity: 0.5;\n     pointer-events: none;"
    },
    {
      "sha": "1b0fe8008306c141eb4275a3215377e0c6009583",
      "filename": "web/app/components/root/__show-more/root__show-more.scss",
      "status": "modified",
      "additions": 0,
      "deletions": 4,
      "changes": 4,
      "blob_url": "https://github.com/umputun/remark/blob/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/app/components/root/__show-more/root__show-more.scss",
      "raw_url": "https://github.com/umputun/remark/raw/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/app/components/root/__show-more/root__show-more.scss",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/web/app/components/root/__show-more/root__show-more.scss?ref=419d2ae75e558d32ddb930e8beecc0e990d2ad28",
      "patch": "@@ -18,8 +18,4 @@\n   &:focus {\n     background: #0aa;\n   }\n-\n-  &:focus {\n-    outline: none;\n-  }\n }"
    },
    {
      "sha": "b801dcc0d41955baf5c72c006587cdc67e909b86",
      "filename": "web/app/embed.js",
      "status": "modified",
      "additions": 15,
      "deletions": 3,
      "changes": 18,
      "blob_url": "https://github.com/umputun/remark/blob/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/app/embed.js",
      "raw_url": "https://github.com/umputun/remark/raw/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/app/embed.js",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/web/app/embed.js?ref=419d2ae75e558d32ddb930e8beecc0e990d2ad28",
      "patch": "@@ -60,6 +60,7 @@ function init() {\n     node: null,\n     back: null,\n     closeEl: null,\n+    iframe: null,\n     style: null,\n     init(user) {\n       this.animationStop();\n@@ -97,8 +98,6 @@ function init() {\n           #${remarkRootId}-close {\n             top: 0px;\n             right: 400px;\n-            width: 30px;\n-            height: 30px;\n             position: absolute;\n             text-align: center;\n             font-size: 25px;\n@@ -107,6 +106,7 @@ function init() {\n             border-color: transparent;\n             border-width: 0;\n             padding: 0;\n+            margin-right: 4px;\n             background-color: transparent;\n           }\n           @media all and (max-width: 430px) {\n@@ -150,14 +150,19 @@ function init() {\n         verticalscrolling=\"no\"\n         horizontalscrolling=\"no\"\n       />`;\n+      this.iframe = this.node.querySelector('iframe');\n+      this.iframe.onload = () => {\n+        this.iframe.contentDocument.addEventListener('keydown', this.onKeyDown);\n+      };\n       this.node.appendChild(this.closeEl);\n       document.body.appendChild(this.style);\n       document.body.appendChild(this.back);\n       document.body.appendChild(this.node);\n+      document.addEventListener('keydown', this.onKeyDown);\n       setTimeout(() => {\n         this.back.setAttribute('data-animation', '');\n         this.node.setAttribute('data-animation', '');\n-        this.closeEl.focus();\n+        this.iframe.focus();\n       }, 400);\n     },\n     close() {\n@@ -168,6 +173,7 @@ function init() {\n       if (this.back) {\n         this.back.removeAttribute('data-animation');\n       }\n+      document.removeEventListener('keydown', this.onKeyDown);\n     },\n     delay: null,\n     events: ['', 'webkit', 'moz', 'MS', 'o'].map(prefix => (prefix ? `${prefix}TransitionEnd` : 'transitionend')),\n@@ -179,6 +185,12 @@ function init() {\n       this.delay = setTimeout(this.animationStop, 1000);\n       this.events.forEach(event => el.addEventListener(event, this.animationStop, false));\n     },\n+    onKeyDown(e) {\n+      // ESCAPE key pressed\n+      if (e.keyCode == 27) {\n+        userInfo.close();\n+      }\n+    },\n     animationStop() {\n       const t = userInfo;\n       if (!t.node) {"
    },
    {
      "sha": "e9dc515cfb833beec03b8342a77e9b45b766b681",
      "filename": "web/iframe.html",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/umputun/remark/blob/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/iframe.html",
      "raw_url": "https://github.com/umputun/remark/raw/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/iframe.html",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/web/iframe.html?ref=419d2ae75e558d32ddb930e8beecc0e990d2ad28",
      "patch": "@@ -64,6 +64,10 @@\n         transform: scale(0);\n       }\n     }\n+\n+    :focus:not(.focus-visible):not(.button) {\n+      outline: none;\n+    }\n   </style>\n </head>\n <body>"
    },
    {
      "sha": "cb6f9fa1bf3221b5b2bb90a2d27d689deb15d650",
      "filename": "web/package-lock.json",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/umputun/remark/blob/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/package-lock.json",
      "raw_url": "https://github.com/umputun/remark/raw/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/package-lock.json",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/web/package-lock.json?ref=419d2ae75e558d32ddb930e8beecc0e990d2ad28",
      "patch": "@@ -4800,6 +4800,11 @@\n         }\n       }\n     },\n+    \"focus-visible\": {\n+      \"version\": \"4.1.5\",\n+      \"resolved\": \"https://registry.npmjs.org/focus-visible/-/focus-visible-4.1.5.tgz\",\n+      \"integrity\": \"sha512-yo/njtk/BB4Z2euzaZe3CZrg4u5s5uEi7ZwbHBJS2quHx51N0mmcx9nTIiImUGlgy+vf26d0CcQluahBBBL/Fw==\"\n+    },\n     \"follow-redirects\": {\n       \"version\": \"1.4.1\",\n       \"resolved\": \"https://registry.npmjs.org/follow-redirects/-/follow-redirects-1.4.1.tgz\","
    },
    {
      "sha": "f04f5c524e4ed98f54c5b4463d96f11c304fc1f7",
      "filename": "web/package.json",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/umputun/remark/blob/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/package.json",
      "raw_url": "https://github.com/umputun/remark/raw/419d2ae75e558d32ddb930e8beecc0e990d2ad28/web/package.json",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/web/package.json?ref=419d2ae75e558d32ddb930e8beecc0e990d2ad28",
      "patch": "@@ -62,6 +62,7 @@\n     \"axios\": \"^0.18.0\",\n     \"bem-react-helper\": \"^1.1.2\",\n     \"core-js\": \"^2.5.7\",\n+    \"focus-visible\": \"^4.1.5\",\n     \"preact\": \"^8.2.9\",\n     \"preact-redux\": \"^2.0.3\",\n     \"redux\": \"^4.0.0\""
    }
  ]
}
