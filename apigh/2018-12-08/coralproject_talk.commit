{
  "sha": "f1a3a5ca28d92e2d611a7dfe712a37ecd3e610c9",
  "node_id": "MDY6Q29tbWl0NzI0NTQyNDI6ZjFhM2E1Y2EyOGQ5MmUyZDYxMWE3ZGZlNzEyYTM3ZWNkM2U2MTBjOQ==",
  "commit": {
    "author": {
      "name": "Kim Gardner",
      "email": "kgardnr@gmail.com",
      "date": "2018-12-06T22:45:52Z"
    },
    "committer": {
      "name": "Wyatt Johnson",
      "email": "wyattjoh@gmail.com",
      "date": "2018-12-06T22:45:52Z"
    },
    "message": "Lazy Load Fix (#2110)\n\n* Bump version 4.6.8\r\n\r\n* fix: added JS fix for static URL's",
    "tree": {
      "sha": "5aababca42e0f0b6be2c3d1b373cb0103384dd21",
      "url": "https://api.github.com/repos/coralproject/talk/git/trees/5aababca42e0f0b6be2c3d1b373cb0103384dd21"
    },
    "url": "https://api.github.com/repos/coralproject/talk/git/commits/f1a3a5ca28d92e2d611a7dfe712a37ecd3e610c9",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/coralproject/talk/commits/f1a3a5ca28d92e2d611a7dfe712a37ecd3e610c9",
  "html_url": "https://github.com/coralproject/talk/commit/f1a3a5ca28d92e2d611a7dfe712a37ecd3e610c9",
  "comments_url": "https://api.github.com/repos/coralproject/talk/commits/f1a3a5ca28d92e2d611a7dfe712a37ecd3e610c9/comments",
  "author": {
    "login": "kgardnr",
    "id": 1077300,
    "node_id": "MDQ6VXNlcjEwNzczMDA=",
    "avatar_url": "https://avatars2.githubusercontent.com/u/1077300?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kgardnr",
    "html_url": "https://github.com/kgardnr",
    "followers_url": "https://api.github.com/users/kgardnr/followers",
    "following_url": "https://api.github.com/users/kgardnr/following{/other_user}",
    "gists_url": "https://api.github.com/users/kgardnr/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kgardnr/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kgardnr/subscriptions",
    "organizations_url": "https://api.github.com/users/kgardnr/orgs",
    "repos_url": "https://api.github.com/users/kgardnr/repos",
    "events_url": "https://api.github.com/users/kgardnr/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kgardnr/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "wyattjoh",
    "id": 633002,
    "node_id": "MDQ6VXNlcjYzMzAwMg==",
    "avatar_url": "https://avatars2.githubusercontent.com/u/633002?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wyattjoh",
    "html_url": "https://github.com/wyattjoh",
    "followers_url": "https://api.github.com/users/wyattjoh/followers",
    "following_url": "https://api.github.com/users/wyattjoh/following{/other_user}",
    "gists_url": "https://api.github.com/users/wyattjoh/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wyattjoh/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wyattjoh/subscriptions",
    "organizations_url": "https://api.github.com/users/wyattjoh/orgs",
    "repos_url": "https://api.github.com/users/wyattjoh/repos",
    "events_url": "https://api.github.com/users/wyattjoh/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wyattjoh/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "8ef44dc6f52721f93a4724888df78acdc832b070",
      "url": "https://api.github.com/repos/coralproject/talk/commits/8ef44dc6f52721f93a4724888df78acdc832b070",
      "html_url": "https://github.com/coralproject/talk/commit/8ef44dc6f52721f93a4724888df78acdc832b070"
    }
  ],
  "stats": {
    "total": 28,
    "additions": 21,
    "deletions": 7
  },
  "files": [
    {
      "sha": "09843618f32dcebb8e026f791c035cffbda9ca96",
      "filename": "client/coral-embed/src/Stream.js",
      "status": "modified",
      "additions": 20,
      "deletions": 6,
      "changes": 26,
      "blob_url": "https://github.com/coralproject/talk/blob/f1a3a5ca28d92e2d611a7dfe712a37ecd3e610c9/client/coral-embed/src/Stream.js",
      "raw_url": "https://github.com/coralproject/talk/raw/f1a3a5ca28d92e2d611a7dfe712a37ecd3e610c9/client/coral-embed/src/Stream.js",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/client/coral-embed/src/Stream.js?ref=f1a3a5ca28d92e2d611a7dfe712a37ecd3e610c9",
      "patch": "@@ -1,3 +1,5 @@\n+/* global __webpack_public_path__ */ // eslint-disable-line no-unused-vars\n+\n import queryString from 'querystringify';\n import pym from 'pym.js';\n import EventEmitter from 'eventemitter2';\n@@ -11,13 +13,14 @@ import {\n \n const NOTIFICATION_OFFSET = 200;\n \n+// Ensure there is a trailing slash.\n+function ensureEndSlash(p) {\n+  return p.match(/\\/$/) ? p : `${p}/`;\n+}\n+\n // Build the URL to load in the pym iframe.\n function buildStreamIframeUrl(talkBaseUrl, query) {\n-  let url = [\n-    talkBaseUrl,\n-    talkBaseUrl.match(/\\/$/) ? '' : '/', // make sure no double-'/' if opts.talk already ends with '/'\n-    'embed/stream?',\n-  ].join('');\n+  let url = talkBaseUrl + 'embed/stream?';\n \n   url += queryString.stringify(query);\n \n@@ -48,15 +51,26 @@ export default class Stream {\n       events = null,\n       snackBarStyles = null,\n       onAuthChanged = null,\n+      talkStaticUrl = talkBaseUrl,\n       ...opts\n     } = config;\n \n     this.onAuthChanged = onAuthChanged;\n     this.el = el;\n-    this.talkBaseUrl = talkBaseUrl;\n+    this.talkBaseUrl = ensureEndSlash(talkBaseUrl);\n+    this.talkStaticUrl = ensureEndSlash(talkStaticUrl);\n     this.opts = opts;\n     this.snackBar = new Snackbar(snackBarStyles || {});\n     this.emitter = new EventEmitter({ wildcard: true });\n+\n+    // Because we're loading chunks dynamically below, we need to point to the\n+    // static URL.\n+    //\n+    // The __webpack_public_path__ can be referenced:\n+    // https://webpack.js.org/configuration/output/#output-publicpath\n+    //\n+    __webpack_public_path__ = this.talkStaticUrl + 'static/';\n+\n     // Attach to the events emitted by the pym parent.\n     if (events) {\n       events(this.emitter);"
    },
    {
      "sha": "56eb07acd3b5488963d7313c3b06107a3e93c6af",
      "filename": "package.json",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/coralproject/talk/blob/f1a3a5ca28d92e2d611a7dfe712a37ecd3e610c9/package.json",
      "raw_url": "https://github.com/coralproject/talk/raw/f1a3a5ca28d92e2d611a7dfe712a37ecd3e610c9/package.json",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/package.json?ref=f1a3a5ca28d92e2d611a7dfe712a37ecd3e610c9",
      "patch": "@@ -1,6 +1,6 @@\n {\n   \"name\": \"talk\",\n-  \"version\": \"4.6.7\",\n+  \"version\": \"4.6.8\",\n   \"description\": \"A better commenting experience from Mozilla, The New York Times, and the Washington Post. https://coralproject.net\",\n   \"main\": \"app.js\",\n   \"private\": true,"
    }
  ]
}
