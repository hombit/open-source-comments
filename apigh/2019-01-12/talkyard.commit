{
  "sha": "c4edaa4fc94d8ed96d81345cd8e77e86a76051c0",
  "node_id": "MDY6Q29tbWl0MTA1NjMzMjI6YzRlZGFhNGZjOTRkOGVkOTZkODEzNDVjZDhlNzdlODZhNzYwNTFjMA==",
  "commit": {
    "author": {
      "name": "Kaj Magnus Lindberg",
      "email": "kajmagnus3@gmail.com",
      "date": "2019-01-10T17:56:49Z"
    },
    "committer": {
      "name": "Kaj Magnus Lindberg",
      "email": "kajmagnus3@gmail.com",
      "date": "2019-01-11T07:16:33Z"
    },
    "message": "Work around Nginx/Nchan segfault? 1 worker.",
    "tree": {
      "sha": "9ecd3d1494de89a7330d6fdbf370704120296c51",
      "url": "https://api.github.com/repos/debiki/talkyard/git/trees/9ecd3d1494de89a7330d6fdbf370704120296c51"
    },
    "url": "https://api.github.com/repos/debiki/talkyard/git/commits/c4edaa4fc94d8ed96d81345cd8e77e86a76051c0",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/debiki/talkyard/commits/c4edaa4fc94d8ed96d81345cd8e77e86a76051c0",
  "html_url": "https://github.com/debiki/talkyard/commit/c4edaa4fc94d8ed96d81345cd8e77e86a76051c0",
  "comments_url": "https://api.github.com/repos/debiki/talkyard/commits/c4edaa4fc94d8ed96d81345cd8e77e86a76051c0/comments",
  "author": {
    "login": "kajmagnus",
    "id": 7477359,
    "node_id": "MDQ6VXNlcjc0NzczNTk=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/7477359?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kajmagnus",
    "html_url": "https://github.com/kajmagnus",
    "followers_url": "https://api.github.com/users/kajmagnus/followers",
    "following_url": "https://api.github.com/users/kajmagnus/following{/other_user}",
    "gists_url": "https://api.github.com/users/kajmagnus/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kajmagnus/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kajmagnus/subscriptions",
    "organizations_url": "https://api.github.com/users/kajmagnus/orgs",
    "repos_url": "https://api.github.com/users/kajmagnus/repos",
    "events_url": "https://api.github.com/users/kajmagnus/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kajmagnus/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "kajmagnus",
    "id": 7477359,
    "node_id": "MDQ6VXNlcjc0NzczNTk=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/7477359?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kajmagnus",
    "html_url": "https://github.com/kajmagnus",
    "followers_url": "https://api.github.com/users/kajmagnus/followers",
    "following_url": "https://api.github.com/users/kajmagnus/following{/other_user}",
    "gists_url": "https://api.github.com/users/kajmagnus/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kajmagnus/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kajmagnus/subscriptions",
    "organizations_url": "https://api.github.com/users/kajmagnus/orgs",
    "repos_url": "https://api.github.com/users/kajmagnus/repos",
    "events_url": "https://api.github.com/users/kajmagnus/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kajmagnus/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "d7468863fd600979cb112948b642913e9467ec97",
      "url": "https://api.github.com/repos/debiki/talkyard/commits/d7468863fd600979cb112948b642913e9467ec97",
      "html_url": "https://github.com/debiki/talkyard/commit/d7468863fd600979cb112948b642913e9467ec97"
    }
  ],
  "stats": {
    "total": 12,
    "additions": 9,
    "deletions": 3
  },
  "files": [
    {
      "sha": "b6c73bda697c057f80bce142a229ffad2e915729",
      "filename": "images/web/nginx.conf",
      "status": "modified",
      "additions": 9,
      "deletions": 3,
      "changes": 12,
      "blob_url": "https://github.com/debiki/talkyard/blob/c4edaa4fc94d8ed96d81345cd8e77e86a76051c0/images/web/nginx.conf",
      "raw_url": "https://github.com/debiki/talkyard/raw/c4edaa4fc94d8ed96d81345cd8e77e86a76051c0/images/web/nginx.conf",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/images/web/nginx.conf?ref=c4edaa4fc94d8ed96d81345cd8e77e86a76051c0",
      "patch": "@@ -10,7 +10,11 @@\n user nginx;\n \n # 'auto' attempts to auto detect the number of CPU cores.\n-worker_processes auto;\n+# However, if using just 1 worker, and Nchan crashes the worker, then Nginx will\n+# restart it so Nchan will supposedly start working again, meaning, [NGXSEGFBUG]\n+# live notifications via Nchan won't stop working.\n+# https://github.com/slact/nchan/issues/477#issuecomment-452848234\n+worker_processes 1;  # not 'auto'\n \n # Core dump path, and max core dump size. They can be about 200M large (so 400M usually large enough?).\n #working_directory /tmp/cores/;  # needs to mount/create dir, otherwise Nginx won't start [NGXCORED]\n@@ -23,8 +27,10 @@ worker_processes auto;\n daemon off;\n \n events {\n-  # in the Docker image, `ulimit -n` –> 524288, and say 10 cores? -> max 52400, say 30 000 then\n-  worker_connections 30000;\n+  # In the Docker image, `ulimit -n` –> 524288, and say 10 cores? -> max 52400, say 30 000 then\n+  # Currently just 1 worker process though (see above) so let's pick 50 000 for now.\n+  # Max total connections = worker_processes * worker_connections.\n+  worker_connections 50000;\n }\n \n "
    }
  ]
}
