{
  "sha": "81108ee7834d387d5495e8d0d137b73279e70907",
  "node_id": "MDY6Q29tbWl0NzU2OTU3ODo4MTEwOGVlNzgzNGQzODdkNTQ5NWU4ZDBkMTM3YjczMjc5ZTcwOTA3",
  "commit": {
    "author": {
      "name": "Gerhard Schlager",
      "email": "mail@gerhard-schlager.at",
      "date": "2019-03-18T16:39:25Z"
    },
    "committer": {
      "name": "Gerhard Schlager",
      "email": "mail@gerhard-schlager.at",
      "date": "2019-03-18T16:39:53Z"
    },
    "message": "DEV: Increase timeout for JS tests and add env variable",
    "tree": {
      "sha": "4d6c255c3204260835eff51934272febcc2cb57a",
      "url": "https://api.github.com/repos/discourse/discourse/git/trees/4d6c255c3204260835eff51934272febcc2cb57a"
    },
    "url": "https://api.github.com/repos/discourse/discourse/git/commits/81108ee7834d387d5495e8d0d137b73279e70907",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/discourse/discourse/commits/81108ee7834d387d5495e8d0d137b73279e70907",
  "html_url": "https://github.com/discourse/discourse/commit/81108ee7834d387d5495e8d0d137b73279e70907",
  "comments_url": "https://api.github.com/repos/discourse/discourse/commits/81108ee7834d387d5495e8d0d137b73279e70907/comments",
  "author": {
    "login": "gschlager",
    "id": 473736,
    "node_id": "MDQ6VXNlcjQ3MzczNg==",
    "avatar_url": "https://avatars3.githubusercontent.com/u/473736?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gschlager",
    "html_url": "https://github.com/gschlager",
    "followers_url": "https://api.github.com/users/gschlager/followers",
    "following_url": "https://api.github.com/users/gschlager/following{/other_user}",
    "gists_url": "https://api.github.com/users/gschlager/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gschlager/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gschlager/subscriptions",
    "organizations_url": "https://api.github.com/users/gschlager/orgs",
    "repos_url": "https://api.github.com/users/gschlager/repos",
    "events_url": "https://api.github.com/users/gschlager/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gschlager/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "gschlager",
    "id": 473736,
    "node_id": "MDQ6VXNlcjQ3MzczNg==",
    "avatar_url": "https://avatars3.githubusercontent.com/u/473736?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gschlager",
    "html_url": "https://github.com/gschlager",
    "followers_url": "https://api.github.com/users/gschlager/followers",
    "following_url": "https://api.github.com/users/gschlager/following{/other_user}",
    "gists_url": "https://api.github.com/users/gschlager/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gschlager/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gschlager/subscriptions",
    "organizations_url": "https://api.github.com/users/gschlager/orgs",
    "repos_url": "https://api.github.com/users/gschlager/repos",
    "events_url": "https://api.github.com/users/gschlager/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gschlager/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "976ea160e9444725d4edc733cf25248c62c97015",
      "url": "https://api.github.com/repos/discourse/discourse/commits/976ea160e9444725d4edc733cf25248c62c97015",
      "html_url": "https://github.com/discourse/discourse/commit/976ea160e9444725d4edc733cf25248c62c97015"
    }
  ],
  "stats": {
    "total": 11,
    "additions": 7,
    "deletions": 4
  },
  "files": [
    {
      "sha": "9c18850b05b3f568083964827f7ec0f66a57a100",
      "filename": "lib/tasks/docker.rake",
      "status": "modified",
      "additions": 7,
      "deletions": 4,
      "changes": 11,
      "blob_url": "https://github.com/discourse/discourse/blob/81108ee7834d387d5495e8d0d137b73279e70907/lib/tasks/docker.rake",
      "raw_url": "https://github.com/discourse/discourse/raw/81108ee7834d387d5495e8d0d137b73279e70907/lib/tasks/docker.rake",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/lib/tasks/docker.rake?ref=81108ee7834d387d5495e8d0d137b73279e70907",
      "patch": "@@ -13,6 +13,7 @@\n # => BISECT                    set to 1 to run rspec --bisect (applies to core rspec tests only)\n # => RSPEC_SEED                set to seed to use for rspec tests (applies to core rspec tests only)\n # => PAUSE_ON_TERMINATE        set to 1 to pause prior to terminating redis and pg\n+# => JS_TIMEOUT                set timeout for qunit tests in ms\n #\n # Other useful environment variables (not specific to this rake task)\n # => COMMIT_HASH    used by the discourse_test docker image to load a specific commit of discourse\n@@ -152,17 +153,19 @@ task 'docker:test' do\n       end\n \n       unless ENV[\"RUBY_ONLY\"]\n+        js_timeout = ENV[\"JS_TIMEOUT\"].presence || 900_000 # 15 minutes\n+\n         puts \"travis_fold:start:js_tests\" if ENV[\"TRAVIS\"]\n         unless ENV[\"SKIP_CORE\"]\n-          @good &&= run_or_fail(\"bundle exec rake qunit:test['600000']\")\n-          @good &&= run_or_fail(\"bundle exec rake qunit:test['600000','/wizard/qunit']\")\n+          @good &&= run_or_fail(\"bundle exec rake qunit:test['#{js_timeout}']\")\n+          @good &&= run_or_fail(\"bundle exec rake qunit:test['#{js_timeout}','/wizard/qunit']\")\n         end\n \n         unless ENV[\"SKIP_PLUGINS\"]\n           if ENV[\"SINGLE_PLUGIN\"]\n-            @good &&= run_or_fail(\"bundle exec rake plugin:qunit['#{ENV['SINGLE_PLUGIN']}','600000']\")\n+            @good &&= run_or_fail(\"bundle exec rake plugin:qunit['#{ENV['SINGLE_PLUGIN']}','#{js_timeout}']\")\n           else\n-            @good &&= run_or_fail(\"bundle exec rake plugin:qunit['*','600000']\")\n+            @good &&= run_or_fail(\"bundle exec rake plugin:qunit['*','#{js_timeout}']\")\n           end\n         end\n         puts \"travis_fold:end:js_tests\" if ENV[\"TRAVIS\"]"
    }
  ]
}
