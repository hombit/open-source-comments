{
  "sha": "61e594786c8b6dfba2756f66a122645858696cc0",
  "node_id": "MDY6Q29tbWl0MTE0ODI5NTAzOjYxZTU5NDc4NmM4YjZkZmJhMjc1NmY2NmExMjI2NDU4NTg2OTZjYzA=",
  "commit": {
    "author": {
      "name": "Misha Vyrtsev",
      "email": "reeywhaar@gmail.com",
      "date": "2019-05-13T15:51:17Z"
    },
    "committer": {
      "name": "Umputun",
      "email": "umputun@gmail.com",
      "date": "2019-05-13T15:51:17Z"
    },
    "message": "Define remark host in runtime (#325)\n\n* convert closest-polyfill to ts\r\n\r\n* make remark respect host property in client setup",
    "tree": {
      "sha": "d01de9dcd4283c6e9a5ff78c7ef96d827696f8ab",
      "url": "https://api.github.com/repos/umputun/remark/git/trees/d01de9dcd4283c6e9a5ff78c7ef96d827696f8ab"
    },
    "url": "https://api.github.com/repos/umputun/remark/git/commits/61e594786c8b6dfba2756f66a122645858696cc0",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/umputun/remark/commits/61e594786c8b6dfba2756f66a122645858696cc0",
  "html_url": "https://github.com/umputun/remark/commit/61e594786c8b6dfba2756f66a122645858696cc0",
  "comments_url": "https://api.github.com/repos/umputun/remark/commits/61e594786c8b6dfba2756f66a122645858696cc0/comments",
  "author": {
    "login": "Reeywhaar",
    "id": 884649,
    "node_id": "MDQ6VXNlcjg4NDY0OQ==",
    "avatar_url": "https://avatars0.githubusercontent.com/u/884649?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Reeywhaar",
    "html_url": "https://github.com/Reeywhaar",
    "followers_url": "https://api.github.com/users/Reeywhaar/followers",
    "following_url": "https://api.github.com/users/Reeywhaar/following{/other_user}",
    "gists_url": "https://api.github.com/users/Reeywhaar/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Reeywhaar/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Reeywhaar/subscriptions",
    "organizations_url": "https://api.github.com/users/Reeywhaar/orgs",
    "repos_url": "https://api.github.com/users/Reeywhaar/repos",
    "events_url": "https://api.github.com/users/Reeywhaar/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Reeywhaar/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "umputun",
    "id": 535880,
    "node_id": "MDQ6VXNlcjUzNTg4MA==",
    "avatar_url": "https://avatars0.githubusercontent.com/u/535880?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/umputun",
    "html_url": "https://github.com/umputun",
    "followers_url": "https://api.github.com/users/umputun/followers",
    "following_url": "https://api.github.com/users/umputun/following{/other_user}",
    "gists_url": "https://api.github.com/users/umputun/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/umputun/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/umputun/subscriptions",
    "organizations_url": "https://api.github.com/users/umputun/orgs",
    "repos_url": "https://api.github.com/users/umputun/repos",
    "events_url": "https://api.github.com/users/umputun/events{/privacy}",
    "received_events_url": "https://api.github.com/users/umputun/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "53f2f82e054414d8f2d8cbb2069093917d67cccc",
      "url": "https://api.github.com/repos/umputun/remark/commits/53f2f82e054414d8f2d8cbb2069093917d67cccc",
      "html_url": "https://github.com/umputun/remark/commit/53f2f82e054414d8f2d8cbb2069093917d67cccc"
    }
  ],
  "stats": {
    "total": 208,
    "additions": 138,
    "deletions": 70
  },
  "files": [
    {
      "sha": "237edd299aa5f0f3d034c56aac2b903698b5bf35",
      "filename": "README.md",
      "status": "modified",
      "additions": 37,
      "deletions": 17,
      "changes": 54,
      "blob_url": "https://github.com/umputun/remark/blob/61e594786c8b6dfba2756f66a122645858696cc0/README.md",
      "raw_url": "https://github.com/umputun/remark/raw/61e594786c8b6dfba2756f66a122645858696cc0/README.md",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/README.md?ref=61e594786c8b6dfba2756f66a122645858696cc0",
      "patch": "@@ -308,18 +308,28 @@ Add this snippet to the bottom of web page:\n ```html\n <script>\n   var remark_config = {\n+    host: \"REMARK_URL\", // hostname of remark server, same as REMARK_URL in backend config, e.g. \"https://demo.remark42.com\"\n     site_id: 'YOUR_SITE_ID',\n+    components: ['embed'] // optional param; which components to load. default to [\"embed\"]\n+                          // to load all components define components as ['embed', 'last-comments', 'counter']\n+                          // available component are:\n+                          //     - 'embed': basic comments widget\n+                          //     - 'last-comments': last comments widget, see `Last Comments` section below\n+                          //     - 'counter': counter widget, see `Counter` section below\n     url: 'PAGE_URL', // optional param; if it isn't defined window.location.href will be used\n     max_shown_comments: 10, // optional param; if it isn't defined default value (15) will be used\n     theme: 'dark', // optional param; if it isn't defined default value ('light') will be used\n     page_title: 'Moving to Remark42' // optional param; if it isn't defined `document.title` will be used\n   };\n \n-  (function() {\n-    var d = document, s = d.createElement('script');\n-    s.src = '/web/embed.js'; // prepends this address with domain where remark42 is placed\n-    (d.head || d.body).appendChild(s);\n-  })();\n+  (function(c) {\n+    for(var i = 0; i < c.length; i++){\n+      var d = document, s = d.createElement('script');\n+      s.src = remark_config.host + '/web/' +c[i] +'.js';\n+      s.defer = true;\n+      (d.head || d.body).appendChild(s);\n+    }\n+  })(remark_config.components || ['embed']);\n </script>\n ```\n \n@@ -348,19 +358,24 @@ window.REMARK42.changeTheme('light');\n \n It's a widget which renders list of last comments from your site.\n \n-Add this snippet to the bottom of web page:\n+Add this snippet to the bottom of web page, or adjust already present `remark_config` to have `last-comments` in `components` list:\n \n ```html\n <script>\n   var remark_config = {\n+    host: \"REMARK_URL\", // hostname of remark server, same as REMARK_URL in backend config, e.g. \"https://demo.remark42.com\"\n     site_id: 'YOUR_SITE_ID',\n+    components: ['last-comments']\n   };\n \n-  (function() {\n-    var d = document, s = d.createElement('script');\n-    s.src = '/web/last-comments.js'; // prepends this address with domain where remark42 is placed\n-    (d.head || d.body).appendChild(s);\n-  })();\n+  (function(c) {\n+    for(var i = 0; i < c.length; i++){\n+      var d = document, s = d.createElement('script');\n+      s.src = remark_config.host + '/web/' +c[i] +'.js';\n+      s.defer = true;\n+      (d.head || d.body).appendChild(s);\n+    }\n+  })(remark_config.components || ['embed']);\n </script>\n ```\n \n@@ -376,19 +391,24 @@ And then add this node in the place where you want to see last comments widget:\n \n It's a widget which renders a number of comments for the specified page.\n \n-Add this snippet to the bottom of web page:\n+Add this snippet to the bottom of web page, or adjust already present `remark_config` to have `counter` in `components` list:\n \n ```html\n <script>\n   var remark_config = {\n+    host: \"REMARK_URL\", // hostname of remark server, same as REMARK_URL in backend config, e.g. \"https://demo.remark42.com\"\n     site_id: 'YOUR_SITE_ID',\n+    components: ['counter']\n   };\n \n-  (function() {\n-    var d = document, s = d.createElement('script');\n-    s.src = '/web/counter.js'; // prepends this address with domain where remark42 is placed\n-    (d.head || d.body).appendChild(s);\n-  })();\n+  (function(c) {\n+    for(var i = 0; i < c.length; i++){\n+      var d = document, s = d.createElement('script');\n+      s.src = remark_config.host + '/web/' +c[i] +'.js';\n+      s.defer = true;\n+      (d.head || d.body).appendChild(s);\n+    }\n+  })(remark_config.components || ['embed']);\n </script>\n ```\n "
    },
    {
      "sha": "d83819b246647a7c1dea741ce8bf20f56fa9cb0a",
      "filename": "frontend/app/common/closest-polyfill.js",
      "status": "removed",
      "additions": 0,
      "deletions": 15,
      "changes": 15,
      "blob_url": "https://github.com/umputun/remark/blob/53f2f82e054414d8f2d8cbb2069093917d67cccc/frontend/app/common/closest-polyfill.js",
      "raw_url": "https://github.com/umputun/remark/raw/53f2f82e054414d8f2d8cbb2069093917d67cccc/frontend/app/common/closest-polyfill.js",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/frontend/app/common/closest-polyfill.js?ref=53f2f82e054414d8f2d8cbb2069093917d67cccc",
      "patch": "@@ -1,15 +0,0 @@\n-if (!Element.prototype.matches) {\n-  Element.prototype.matches = Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;\n-}\n-\n-if (!Element.prototype.closest) {\n-  Element.prototype.closest = function(s) {\n-    let el = this;\n-\n-    do {\n-      if (el.matches(s)) return el;\n-      el = el.parentElement || el.parentNode;\n-    } while (el !== null && el.nodeType === 1);\n-    return null;\n-  };\n-}"
    },
    {
      "sha": "1fe57b046fb64c75919d36d416fbbfe4b56e264d",
      "filename": "frontend/app/common/closest-polyfill.ts",
      "status": "added",
      "additions": 17,
      "deletions": 0,
      "changes": 17,
      "blob_url": "https://github.com/umputun/remark/blob/61e594786c8b6dfba2756f66a122645858696cc0/frontend/app/common/closest-polyfill.ts",
      "raw_url": "https://github.com/umputun/remark/raw/61e594786c8b6dfba2756f66a122645858696cc0/frontend/app/common/closest-polyfill.ts",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/frontend/app/common/closest-polyfill.ts?ref=61e594786c8b6dfba2756f66a122645858696cc0",
      "patch": "@@ -0,0 +1,17 @@\n+if (!Element.prototype.matches) {\n+  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+  Element.prototype.matches = (Element.prototype as any).msMatchesSelector || Element.prototype.webkitMatchesSelector;\n+}\n+\n+if (!Element.prototype.closest) {\n+  Element.prototype.closest = function(s: string) {\n+    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+    let el: any = this;\n+\n+    do {\n+      if (el.matches(s)) return el;\n+      el = el.parentElement || el.parentNode;\n+    } while (el !== null && el.nodeType === 1);\n+    return null;\n+  };\n+}"
    },
    {
      "sha": "369e5db2d38861fcfcd19b5d02fe4f33948f5539",
      "filename": "frontend/app/common/config-types.ts",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/umputun/remark/blob/61e594786c8b6dfba2756f66a122645858696cc0/frontend/app/common/config-types.ts",
      "raw_url": "https://github.com/umputun/remark/raw/61e594786c8b6dfba2756f66a122645858696cc0/frontend/app/common/config-types.ts",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/frontend/app/common/config-types.ts?ref=61e594786c8b6dfba2756f66a122645858696cc0",
      "patch": "@@ -1,13 +1,15 @@\n import { UserInfo, Theme } from './types';\n \n export interface CounterConfig {\n+  host: string;\n   site_id: string;\n   url?: string;\n }\n \n export type UserInfoConfig = UserInfo;\n \n export interface CommentsConfig {\n+  host: string;\n   site_id: string;\n   url?: string;\n   max_shown_comments?: number;\n@@ -16,6 +18,7 @@ export interface CommentsConfig {\n }\n \n export interface LastCommentsConfig {\n+  host: string;\n   site_id: string;\n   max_last_comments: number;\n }"
    },
    {
      "sha": "e95482f75e2238fe79332e199d1ae83141047656",
      "filename": "frontend/app/common/constants.ts",
      "status": "modified",
      "additions": 3,
      "deletions": 1,
      "changes": 4,
      "blob_url": "https://github.com/umputun/remark/blob/61e594786c8b6dfba2756f66a122645858696cc0/frontend/app/common/constants.ts",
      "raw_url": "https://github.com/umputun/remark/raw/61e594786c8b6dfba2756f66a122645858696cc0/frontend/app/common/constants.ts",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/frontend/app/common/constants.ts?ref=61e594786c8b6dfba2756f66a122645858696cc0",
      "patch": "@@ -1,6 +1,8 @@\n import { Sorting, AuthProvider, BlockingDuration, Theme } from './types';\n \n-export const BASE_URL: string = process.env.REMARK_URL!;\n+export const BASE_URL: string =\n+  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n+  ((window as any).remark_config && (window as any).remark_config.host) || process.env.REMARK_URL!;\n export const API_BASE = '/api/v1';\n export const NODE_ID: string = process.env.REMARK_NODE!;\n export const COUNTER_NODE_CLASSNAME = 'remark42__counter';"
    },
    {
      "sha": "f86e6397b89dfef6bac3173629b8bd2efa501aa0",
      "filename": "frontend/app/embed.ts",
      "status": "modified",
      "additions": 5,
      "deletions": 3,
      "changes": 8,
      "blob_url": "https://github.com/umputun/remark/blob/61e594786c8b6dfba2756f66a122645858696cc0/frontend/app/embed.ts",
      "raw_url": "https://github.com/umputun/remark/raw/61e594786c8b6dfba2756f66a122645858696cc0/frontend/app/embed.ts",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/frontend/app/embed.ts?ref=61e594786c8b6dfba2756f66a122645858696cc0",
      "patch": "@@ -7,14 +7,16 @@ import { BASE_URL, NODE_ID, COMMENT_NODE_CLASSNAME_PREFIX } from '@app/common/co\n import { UserInfo, Theme } from '@app/common/types';\n import { CommentsConfig } from '@app/common/config-types';\n \n+const HOST = remark_config.host || BASE_URL;\n+\n if (document.readyState === 'loading') {\n   document.addEventListener('DOMContentLoaded', init);\n } else {\n   init();\n }\n \n async function init(): Promise<void> {\n-  __webpack_public_path__ = BASE_URL + '/web/';\n+  __webpack_public_path__ = HOST + '/web/';\n   await loadPolyfills();\n \n   const node = document.getElementById(NODE_ID);\n@@ -47,7 +49,7 @@ async function init(): Promise<void> {\n \n   node.innerHTML = `\n     <iframe\n-      src=\"${BASE_URL}/web/iframe.html?${query}\"\n+      src=\"${HOST}/web/iframe.html?${query}\"\n       width=\"100%\"\n       frameborder=\"0\"\n       allowtransparency=\"true\"\n@@ -173,7 +175,7 @@ async function init(): Promise<void> {\n         `&id=${user.id}&name=${user.name}&picture=${user.picture || ''}&isDefaultPicture=${user.isDefaultPicture || 0}`;\n       this.node.innerHTML = `\n       <iframe\n-        src=\"${BASE_URL}/web/iframe.html?${queryUserInfo}\"\n+        src=\"${HOST}/web/iframe.html?${queryUserInfo}\"\n         width=\"100%\"\n         height=\"100%\"\n         frameborder=\"0\""
    },
    {
      "sha": "26d4720497a9dbe66e3cc8e9e4d372bdda593f58",
      "filename": "frontend/app/utils/parseQuery.ts",
      "status": "added",
      "additions": 22,
      "deletions": 0,
      "changes": 22,
      "blob_url": "https://github.com/umputun/remark/blob/61e594786c8b6dfba2756f66a122645858696cc0/frontend/app/utils/parseQuery.ts",
      "raw_url": "https://github.com/umputun/remark/raw/61e594786c8b6dfba2756f66a122645858696cc0/frontend/app/utils/parseQuery.ts",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/frontend/app/utils/parseQuery.ts?ref=61e594786c8b6dfba2756f66a122645858696cc0",
      "patch": "@@ -0,0 +1,22 @@\n+/** converts widnow.location.search into object */\n+export function parseQuery(search: string): { [key: string]: string } {\n+  if (search.length < 2) return {};\n+  return search\n+    .substr(1)\n+    .split('&')\n+    .map(\n+      (chunk): [string, string] => {\n+        const parts = chunk.split('=');\n+        if (parts.length < 2) {\n+          parts[1] = '';\n+        } else {\n+          parts[1] = decodeURIComponent(parts[1]);\n+        }\n+        return parts as [string, string];\n+      }\n+    )\n+    .reduce<{ [key: string]: string }>((c, x) => {\n+      c[x[0]] = x[1];\n+      return c;\n+    }, {});\n+}"
    },
    {
      "sha": "caba10fcb3331ab002873d94e21d385b09e47428",
      "filename": "frontend/comments.ejs",
      "status": "modified",
      "additions": 9,
      "deletions": 8,
      "changes": 17,
      "blob_url": "https://github.com/umputun/remark/blob/61e594786c8b6dfba2756f66a122645858696cc0/frontend/comments.ejs",
      "raw_url": "https://github.com/umputun/remark/raw/61e594786c8b6dfba2756f66a122645858696cc0/frontend/comments.ejs",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/frontend/comments.ejs?ref=61e594786c8b6dfba2756f66a122645858696cc0",
      "patch": "@@ -68,16 +68,17 @@\n \n         var remark_config = {\n           site_id: query.site_id,\n-          url: query.url,\n+          host: window.location.origin,\n+          url: query.url\n         };\n \n-        (function() {\n-          var d = document,\n-            s = d.createElement('script');\n-          s.src = '/web/embed.js';\n-          s.type = 'text/javascript';\n-          (d.head || d.body).appendChild(s);\n-        })();\n+        (function(c) {\n+          for(var i = 0; i < c.length; i++){\n+            var d = document, s = d.createElement('script');\n+            s.src = remark_config.host + '/web/' +c[i] +'.js';\n+            (d.head || d.body).appendChild(s);\n+          }\n+        })(remark_config.components || ['embed']);\n       }\n     </script>\n     <noscript> Please enable JavaScript to view the comments powered by Remark. </noscript>"
    },
    {
      "sha": "b0f6392008835a0a5a97f25567ce1ef43164e3a7",
      "filename": "frontend/counter.ejs",
      "status": "modified",
      "additions": 10,
      "deletions": 7,
      "changes": 17,
      "blob_url": "https://github.com/umputun/remark/blob/61e594786c8b6dfba2756f66a122645858696cc0/frontend/counter.ejs",
      "raw_url": "https://github.com/umputun/remark/raw/61e594786c8b6dfba2756f66a122645858696cc0/frontend/counter.ejs",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/frontend/counter.ejs?ref=61e594786c8b6dfba2756f66a122645858696cc0",
      "patch": "@@ -39,15 +39,18 @@\n   <script>\n     var remark_config = {\n       site_id: 'remark',\n-\t\t\turl: 'https://remark42.com/demo/',\n+      host: window.location.origin,\n+      url: 'https://remark42.com/demo/',\n+      components: ['counter']\n     };\n \n-    (function() {\n-      var d = document, s = d.createElement('script');\n-      s.src = '/web/counter.js';\n-      s.type = 'text/javascript';\n-      (d.head || d.body).appendChild(s);\n-    })();\n+    (function(c) {\n+      for(var i = 0; i < c.length; i++){\n+        var d = document, s = d.createElement('script');\n+        s.src = remark_config.host + '/web/' +c[i] +'.js';\n+        (d.head || d.body).appendChild(s);\n+      }\n+    })(remark_config.components || ['embed']);\n   </script>\n   <noscript>\n     Please enable JavaScript to view the comments powered by Remark."
    },
    {
      "sha": "39eb20382f0dacc4e3e778829d569196f9dcad82",
      "filename": "frontend/deleteme.html",
      "status": "modified",
      "additions": 5,
      "deletions": 0,
      "changes": 5,
      "blob_url": "https://github.com/umputun/remark/blob/61e594786c8b6dfba2756f66a122645858696cc0/frontend/deleteme.html",
      "raw_url": "https://github.com/umputun/remark/raw/61e594786c8b6dfba2756f66a122645858696cc0/frontend/deleteme.html",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/frontend/deleteme.html?ref=61e594786c8b6dfba2756f66a122645858696cc0",
      "patch": "@@ -66,6 +66,11 @@\n       <div class=\"preloader__bounce\"></div>\n     </div>\n   </div>\n+\t<script>\n+\t\tvar remark_config = {\n+\t\t\thost: window.location.origin\n+\t\t}\n+\t</script>\n   <script src=\"deleteme.js\"></script>\n </body>\n </html>"
    },
    {
      "sha": "21c5263afe5bced62edb9822ee9189d0462f1d52",
      "filename": "frontend/iframe.html",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/umputun/remark/blob/61e594786c8b6dfba2756f66a122645858696cc0/frontend/iframe.html",
      "raw_url": "https://github.com/umputun/remark/raw/61e594786c8b6dfba2756f66a122645858696cc0/frontend/iframe.html",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/frontend/iframe.html?ref=61e594786c8b6dfba2756f66a122645858696cc0",
      "patch": "@@ -111,6 +111,15 @@\n       } catch (e) {}\n     }\n \n+    var remark_config = window.location.search.length < 2 ? {} : window.location.search.substr(1).split(\"&\").reduce(function (c, x) {\n+      var splitted = x.split(\"=\")\n+      if(!splitted[1]) {\n+        splitted[1] = \"\"\n+      }\n+      c[splitted[0]] = decodeURIComponent(splitted[1])\n+      return c\n+    }, {})\n+\n     window.parent.postMessage(JSON.stringify({ inited: true }), '*');\n   </script>\n   <script type=\"text/javascript\" src=\"remark.js\"></script>"
    },
    {
      "sha": "ad30ee785c098b6379e5385d9f2ab0124acc7509",
      "filename": "frontend/index.ejs",
      "status": "modified",
      "additions": 9,
      "deletions": 13,
      "changes": 22,
      "blob_url": "https://github.com/umputun/remark/blob/61e594786c8b6dfba2756f66a122645858696cc0/frontend/index.ejs",
      "raw_url": "https://github.com/umputun/remark/raw/61e594786c8b6dfba2756f66a122645858696cc0/frontend/index.ejs",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/frontend/index.ejs?ref=61e594786c8b6dfba2756f66a122645858696cc0",
      "patch": "@@ -74,22 +74,18 @@\n   <script>\n     var remark_config = {\n       site_id: 'remark',\n+      host: window.location.origin,\n       url: 'https://remark42.com/demo/',\n+      components: ['embed', 'counter']\n     };\n \n-    (function() {\n-      var d = document, s = d.createElement('script');\n-      s.src = '/web/embed.js';\n-      s.type = 'text/javascript';\n-      (d.head || d.body).appendChild(s);\n-    })();\n-\n-    (function() {\n-      var d = document, s = d.createElement('script');\n-      s.src = '/web/counter.js';\n-      s.type = 'text/javascript';\n-      (d.head || d.body).appendChild(s);\n-    })();\n+    (function(c) {\n+      for(var i = 0; i < c.length; i++){\n+        var d = document, s = d.createElement('script');\n+        s.src = remark_config.host + '/web/' +c[i] +'.js';\n+        (d.head || d.body).appendChild(s);\n+      }\n+    })(remark_config.components || ['embed']);\n   </script>\n   <noscript>\n     Please enable JavaScript to view the comments powered by Remark."
    },
    {
      "sha": "4bce1d8eb35b8f63e72b428132e61e32c21e4df9",
      "filename": "frontend/last-comments.ejs",
      "status": "modified",
      "additions": 9,
      "deletions": 6,
      "changes": 15,
      "blob_url": "https://github.com/umputun/remark/blob/61e594786c8b6dfba2756f66a122645858696cc0/frontend/last-comments.ejs",
      "raw_url": "https://github.com/umputun/remark/raw/61e594786c8b6dfba2756f66a122645858696cc0/frontend/last-comments.ejs",
      "contents_url": "https://api.github.com/repos/umputun/remark/contents/frontend/last-comments.ejs?ref=61e594786c8b6dfba2756f66a122645858696cc0",
      "patch": "@@ -25,14 +25,17 @@\n   <script>\n     var remark_config = {\n       site_id: 'remark',\n+      host: window.location.origin,\n+      components: [\"last-comments\"]\n     };\n \n-    (function() {\n-      var d = document, s = d.createElement('script');\n-      s.src = '/web/last-comments.js';\n-      s.type = 'text/javascript';\n-      (d.head || d.body).appendChild(s);\n-    })();\n+    (function(c) {\n+      for(var i = 0; i < c.length; i++){\n+        var d = document, s = d.createElement('script');\n+        s.src = remark_config.host + '/web/' +c[i] +'.js';\n+        (d.head || d.body).appendChild(s);\n+      }\n+    })(remark_config.components || ['embed']);\n   </script>\n   <noscript>\n     Please enable JavaScript to view the comments powered by Remark."
    }
  ]
}
