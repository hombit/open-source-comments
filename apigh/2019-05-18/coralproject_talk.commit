{
  "sha": "54f9b2808635e76b2e22d430b4520ffc0fef6198",
  "node_id": "MDY6Q29tbWl0NzI0NTQyNDI6NTRmOWIyODA4NjM1ZTc2YjJlMjJkNDMwYjQ1MjBmZmMwZmVmNjE5OA==",
  "commit": {
    "author": {
      "name": "Gerardo GÃ¡lvez",
      "email": "galvezgerardo01@gmail.com",
      "date": "2019-05-15T17:57:21Z"
    },
    "committer": {
      "name": "Kiwi",
      "email": "vinh@wikiwi.io",
      "date": "2019-05-15T17:57:21Z"
    },
    "message": "Show/hide a comment's edit history from Moderation and User Detail. (#2299)\n\n* Show/Hide comment edit history in moderation queues and user detail.\r\n\r\n* Add spanish translations\r\n\r\n* Place timestamp and comment body on separate lines\r\n\r\n* Remove padding between timestamp and comment",
    "tree": {
      "sha": "8992fe2b1c353b20a0209c0923b45e849d6c3d05",
      "url": "https://api.github.com/repos/coralproject/talk/git/trees/8992fe2b1c353b20a0209c0923b45e849d6c3d05"
    },
    "url": "https://api.github.com/repos/coralproject/talk/git/commits/54f9b2808635e76b2e22d430b4520ffc0fef6198",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/coralproject/talk/commits/54f9b2808635e76b2e22d430b4520ffc0fef6198",
  "html_url": "https://github.com/coralproject/talk/commit/54f9b2808635e76b2e22d430b4520ffc0fef6198",
  "comments_url": "https://api.github.com/repos/coralproject/talk/commits/54f9b2808635e76b2e22d430b4520ffc0fef6198/comments",
  "author": {
    "login": "gerardogalvez",
    "id": 8509232,
    "node_id": "MDQ6VXNlcjg1MDkyMzI=",
    "avatar_url": "https://avatars2.githubusercontent.com/u/8509232?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gerardogalvez",
    "html_url": "https://github.com/gerardogalvez",
    "followers_url": "https://api.github.com/users/gerardogalvez/followers",
    "following_url": "https://api.github.com/users/gerardogalvez/following{/other_user}",
    "gists_url": "https://api.github.com/users/gerardogalvez/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gerardogalvez/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gerardogalvez/subscriptions",
    "organizations_url": "https://api.github.com/users/gerardogalvez/orgs",
    "repos_url": "https://api.github.com/users/gerardogalvez/repos",
    "events_url": "https://api.github.com/users/gerardogalvez/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gerardogalvez/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "cvle",
    "id": 14221600,
    "node_id": "MDQ6VXNlcjE0MjIxNjAw",
    "avatar_url": "https://avatars2.githubusercontent.com/u/14221600?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cvle",
    "html_url": "https://github.com/cvle",
    "followers_url": "https://api.github.com/users/cvle/followers",
    "following_url": "https://api.github.com/users/cvle/following{/other_user}",
    "gists_url": "https://api.github.com/users/cvle/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cvle/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cvle/subscriptions",
    "organizations_url": "https://api.github.com/users/cvle/orgs",
    "repos_url": "https://api.github.com/users/cvle/repos",
    "events_url": "https://api.github.com/users/cvle/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cvle/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "03a5eb7f9b6dbece89b3ac1a1a9f1ff7f3278c80",
      "url": "https://api.github.com/repos/coralproject/talk/commits/03a5eb7f9b6dbece89b3ac1a1a9f1ff7f3278c80",
      "html_url": "https://github.com/coralproject/talk/commit/03a5eb7f9b6dbece89b3ac1a1a9f1ff7f3278c80"
    }
  ],
  "stats": {
    "total": 161,
    "additions": 151,
    "deletions": 10
  },
  "files": [
    {
      "sha": "bdf1ac52016d05c2ac28a2a057a1bdaaf3d5bd85",
      "filename": "client/coral-admin/src/components/UserDetailComment.css",
      "status": "modified",
      "additions": 25,
      "deletions": 3,
      "changes": 28,
      "blob_url": "https://github.com/coralproject/talk/blob/54f9b2808635e76b2e22d430b4520ffc0fef6198/client/coral-admin/src/components/UserDetailComment.css",
      "raw_url": "https://github.com/coralproject/talk/raw/54f9b2808635e76b2e22d430b4520ffc0fef6198/client/coral-admin/src/components/UserDetailComment.css",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/client/coral-admin/src/components/UserDetailComment.css?ref=54f9b2808635e76b2e22d430b4520ffc0fef6198",
      "patch": "@@ -34,7 +34,7 @@\n   color: #063b9a;\n   text-decoration: none;\n   font-weight: 500;\n-  letter-spacing: .5px;\n+  letter-spacing: 0.5px;\n   margin-left: 10px;\n   font-size: 13px;\n   margin-left: 5px;\n@@ -109,7 +109,7 @@\n }\n \n .external {\n-  font-size: .7em;\n+  font-size: 0.7em;\n   text-decoration: none;\n   color: #063b9a;\n   cursor: pointer;\n@@ -119,7 +119,7 @@\n \n   &:hover {\n     text-decoration: underline;\n-    opacity: .9;\n+    opacity: 0.9;\n   }\n \n   > i {\n@@ -139,3 +139,25 @@\n     margin-right: 5px;\n   }\n }\n+\n+.bodyHistoryToggle {\n+  color: #666;\n+  font-size: 12px;\n+  line-height: 1px;\n+  font-weight: 300;\n+  text-decoration: underline;\n+  &:hover {\n+    cursor: pointer;\n+  }\n+}\n+\n+.editedCommentBody {\n+  padding: 0 5px 5px 5px;\n+}\n+\n+.editedComment {\n+  margin-top: 6px;\n+  font-weight: 300;\n+  font-size: 16px;\n+  overflow-wrap: break-word;\n+}"
    },
    {
      "sha": "7e0495b423ff169bc67282126bebca47ecc68698",
      "filename": "client/coral-admin/src/components/UserDetailComment.js",
      "status": "modified",
      "additions": 41,
      "deletions": 0,
      "changes": 41,
      "blob_url": "https://github.com/coralproject/talk/blob/54f9b2808635e76b2e22d430b4520ffc0fef6198/client/coral-admin/src/components/UserDetailComment.js",
      "raw_url": "https://github.com/coralproject/talk/raw/54f9b2808635e76b2e22d430b4520ffc0fef6198/client/coral-admin/src/components/UserDetailComment.js",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/client/coral-admin/src/components/UserDetailComment.js?ref=54f9b2808635e76b2e22d430b4520ffc0fef6198",
      "patch": "@@ -19,6 +19,8 @@ import TimeAgo from 'coral-framework/components/TimeAgo';\n import t from 'coral-framework/services/i18n';\n \n class UserDetailComment extends React.Component {\n+  state = { showingEditHistory: false };\n+\n   approve = () =>\n     this.props.comment.status === 'ACCEPTED'\n       ? null\n@@ -29,6 +31,29 @@ class UserDetailComment extends React.Component {\n       ? null\n       : this.props.rejectComment({ commentId: this.props.comment.id });\n \n+  getBodyHistory = () => {\n+    const bodyHistory = [];\n+    const comment = this.props.comment;\n+    for (let i = 0; i < comment.body_history.length - 1; i++) {\n+      bodyHistory.push(\n+        <div key={i} className={styles.editedComment}>\n+          <div>\n+            <TimeAgo className={styles.created} datetime={comment.created_at} />\n+          </div>\n+          <div className={styles.editedCommentBody}>\n+            {comment.body_history[i].body}\n+          </div>\n+        </div>\n+      );\n+    }\n+\n+    return bodyHistory;\n+  };\n+\n+  toggleEditHistory = () => {\n+    this.setState({ showingEditHistory: !this.state.showingEditHistory });\n+  };\n+\n   render() {\n     const {\n       comment,\n@@ -81,6 +106,14 @@ class UserDetailComment extends React.Component {\n                 &nbsp;<span className={styles.editedMarker}>\n                   ({t('comment.edited')})\n                 </span>\n+                &nbsp;<span\n+                  className={styles.bodyHistoryToggle}\n+                  onClick={this.toggleEditHistory}\n+                >\n+                  {this.state.showingEditHistory\n+                    ? t('comment.hide_edit_history')\n+                    : t('comment.show_edit_history')}\n+                </span>\n               </span>\n             ) : null}\n \n@@ -142,6 +175,14 @@ class UserDetailComment extends React.Component {\n             </div>\n           </CommentAnimatedEdit>\n         </div>\n+\n+        {this.state.showingEditHistory ? (\n+          <div className={styles.container}>\n+            {t('comment.edit_history')}\n+            {this.getBodyHistory()}\n+          </div>\n+        ) : null}\n+\n         <CommentDetails root={root} comment={comment} />\n       </li>\n     );"
    },
    {
      "sha": "0e17e7cc778202553da5ecf6420479dc0f6e0f66",
      "filename": "client/coral-admin/src/containers/UserDetailComment.js",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/coralproject/talk/blob/54f9b2808635e76b2e22d430b4520ffc0fef6198/client/coral-admin/src/containers/UserDetailComment.js",
      "raw_url": "https://github.com/coralproject/talk/raw/54f9b2808635e76b2e22d430b4520ffc0fef6198/client/coral-admin/src/containers/UserDetailComment.js",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/client/coral-admin/src/containers/UserDetailComment.js?ref=54f9b2808635e76b2e22d430b4520ffc0fef6198",
      "patch": "@@ -42,6 +42,10 @@ export default withFragments({\n       status_history {\n         type\n       }\n+      body_history {\n+        body\n+        created_at\n+      }\n       ${getSlotFragmentSpreads(slots, 'comment')}\n       ...${getDefinitionName(CommentLabels.fragments.comment)}\n       ...${getDefinitionName(CommentDetails.fragments.comment)}"
    },
    {
      "sha": "1c6db1cb3815d5df267ec21055c4f8acb177e57b",
      "filename": "client/coral-admin/src/routes/Moderation/components/Comment.css",
      "status": "modified",
      "additions": 29,
      "deletions": 7,
      "changes": 36,
      "blob_url": "https://github.com/coralproject/talk/blob/54f9b2808635e76b2e22d430b4520ffc0fef6198/client/coral-admin/src/routes/Moderation/components/Comment.css",
      "raw_url": "https://github.com/coralproject/talk/raw/54f9b2808635e76b2e22d430b4520ffc0fef6198/client/coral-admin/src/routes/Moderation/components/Comment.css",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/client/coral-admin/src/routes/Moderation/components/Comment.css?ref=54f9b2808635e76b2e22d430b4520ffc0fef6198",
      "patch": "@@ -62,7 +62,7 @@\n   font-weight: 300;\n   margin-bottom: 8px;\n   overflow-wrap: break-word;\n-  word-break:break-word;\n+  word-break: break-word;\n }\n \n .body {\n@@ -103,22 +103,22 @@\n     color: #063b9a;\n     text-decoration: none;\n     font-weight: 500;\n-    letter-spacing: .5px;\n+    letter-spacing: 0.5px;\n     margin-left: 10px;\n     font-size: 13px;\n     margin-left: 5px;\n     padding-bottom: 0px;\n     border-bottom: solid 1px;\n     line-height: 16px;\n     &:hover {\n-      opacity: .9;\n+      opacity: 0.9;\n       cursor: pointer;\n     }\n   }\n }\n \n .username {\n-  color: #393B44;\n+  color: #393b44;\n   text-decoration: none;\n   cursor: pointer;\n   font-weight: 600;\n@@ -127,20 +127,20 @@\n   margin-left: -5px;\n   transition: background-color 200ms ease;\n   &:hover {\n-    background-color: #E0E0E0;\n+    background-color: #e0e0e0;\n   }\n }\n \n .external {\n-  font-size: .7em;\n+  font-size: 0.7em;\n   text-decoration: none;\n   color: #063b9a;\n   cursor: pointer;\n   font-weight: normal;\n   white-space: nowrap;\n   &:hover {\n     text-decoration: underline;\n-    opacity: .9;\n+    opacity: 0.9;\n   }\n   i {\n     font-size: 12px;\n@@ -196,3 +196,25 @@\n .commentContentFooter {\n   flex: 1;\n }\n+\n+.bodyHistoryToggle {\n+  color: #666;\n+  font-size: 12px;\n+  line-height: 1px;\n+  font-weight: 300;\n+  text-decoration: underline;\n+  &:hover {\n+    cursor: pointer;\n+  }\n+}\n+\n+.editedCommentBody {\n+  padding: 0 5px 5px 5px;\n+}\n+\n+.editedComment {\n+  margin-top: 6px;\n+  font-weight: 300;\n+  font-size: 16px;\n+  overflow-wrap: break-word;\n+}"
    },
    {
      "sha": "60d23e69f718f8a7453b71407de299b1d1f4a544",
      "filename": "client/coral-admin/src/routes/Moderation/components/Comment.js",
      "status": "modified",
      "additions": 42,
      "deletions": 0,
      "changes": 42,
      "blob_url": "https://github.com/coralproject/talk/blob/54f9b2808635e76b2e22d430b4520ffc0fef6198/client/coral-admin/src/routes/Moderation/components/Comment.js",
      "raw_url": "https://github.com/coralproject/talk/raw/54f9b2808635e76b2e22d430b4520ffc0fef6198/client/coral-admin/src/routes/Moderation/components/Comment.js",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/client/coral-admin/src/routes/Moderation/components/Comment.js?ref=54f9b2808635e76b2e22d430b4520ffc0fef6198",
      "patch": "@@ -22,6 +22,8 @@ import t from 'coral-framework/services/i18n';\n class Comment extends React.Component {\n   ref = null;\n \n+  state = { showingEditHistory: false };\n+\n   handleRef = ref => (this.ref = ref);\n \n   handleFocusOrClick = () => {\n@@ -45,6 +47,30 @@ class Comment extends React.Component {\n       ? null\n       : this.props.rejectComment({ commentId: this.props.comment.id });\n \n+  getBodyHistory = () => {\n+    const bodyHistory = [];\n+    const comment = this.props.comment;\n+    for (let i = 0; i < comment.body_history.length - 1; i++) {\n+      bodyHistory.push(\n+        <div key={i} className={styles.editedComment}>\n+          <div>\n+            <TimeAgo className={styles.created} datetime={comment.created_at} />\n+          </div>\n+          <div className={styles.editedCommentBody}>\n+            {comment.body_history[i].body}\n+          </div>\n+        </div>\n+      );\n+    }\n+\n+    return bodyHistory;\n+  };\n+\n+  toggleEditHistory = () => {\n+    this.setState({ showingEditHistory: !this.state.showingEditHistory });\n+    this.props.clearHeightCache && this.props.clearHeightCache();\n+  };\n+\n   componentDidUpdate(prev) {\n     if (!prev.selected && this.props.selected) {\n       this.ref.focus();\n@@ -137,6 +163,14 @@ class Comment extends React.Component {\n                   &nbsp;<span className={styles.editedMarker}>\n                     ({t('comment.edited')})\n                   </span>\n+                  &nbsp;<span\n+                    className={styles.bodyHistoryToggle}\n+                    onClick={this.toggleEditHistory}\n+                  >\n+                    {this.state.showingEditHistory\n+                      ? t('comment.hide_edit_history')\n+                      : t('comment.show_edit_history')}\n+                  </span>\n                 </span>\n               ) : null}\n               <div className={styles.adminCommentInfoBar}>\n@@ -201,6 +235,14 @@ class Comment extends React.Component {\n             </div>\n           </CommentAnimatedEdit>\n         </div>\n+\n+        {this.state.showingEditHistory ? (\n+          <div className={styles.container}>\n+            {t('comment.edit_history')}\n+            {this.getBodyHistory()}\n+          </div>\n+        ) : null}\n+\n         <CommentDetails\n           root={root}\n           comment={comment}"
    },
    {
      "sha": "08a2f12bd66d0daff2a72ca32fcef30fb5e6eee9",
      "filename": "client/coral-admin/src/routes/Moderation/containers/Comment.js",
      "status": "modified",
      "additions": 4,
      "deletions": 0,
      "changes": 4,
      "blob_url": "https://github.com/coralproject/talk/blob/54f9b2808635e76b2e22d430b4520ffc0fef6198/client/coral-admin/src/routes/Moderation/containers/Comment.js",
      "raw_url": "https://github.com/coralproject/talk/raw/54f9b2808635e76b2e22d430b4520ffc0fef6198/client/coral-admin/src/routes/Moderation/containers/Comment.js",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/client/coral-admin/src/routes/Moderation/containers/Comment.js?ref=54f9b2808635e76b2e22d430b4520ffc0fef6198",
      "patch": "@@ -52,6 +52,10 @@ export default withFragments({\n       status_history {\n         type\n       }\n+      body_history {\n+        body\n+        created_at\n+      }\n       hasParent\n       ${getSlotFragmentSpreads(slots, 'comment')}\n       ...${getDefinitionName(CommentLabels.fragments.comment)}"
    },
    {
      "sha": "803f869fc296a1591dcd322534b10e190e7afa39",
      "filename": "locales/en.yml",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/coralproject/talk/blob/54f9b2808635e76b2e22d430b4520ffc0fef6198/locales/en.yml",
      "raw_url": "https://github.com/coralproject/talk/raw/54f9b2808635e76b2e22d430b4520ffc0fef6198/locales/en.yml",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/locales/en.yml?ref=54f9b2808635e76b2e22d430b4520ffc0fef6198",
      "patch": "@@ -35,6 +35,9 @@ en:\n     flagged: flagged\n     undo_reject: Undo\n     view_context: 'View context'\n+    edit_history: 'Edit history'\n+    show_edit_history: 'Show edit history'\n+    hide_edit_history: 'Hide edit history'\n   comment_box:\n     cancel: Cancel\n     characters_remaining: 'characters remaining'"
    },
    {
      "sha": "ab6c083825c2e81fcb17d0339c86271827c6c2e5",
      "filename": "locales/es.yml",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/coralproject/talk/blob/54f9b2808635e76b2e22d430b4520ffc0fef6198/locales/es.yml",
      "raw_url": "https://github.com/coralproject/talk/raw/54f9b2808635e76b2e22d430b4520ffc0fef6198/locales/es.yml",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/locales/es.yml?ref=54f9b2808635e76b2e22d430b4520ffc0fef6198",
      "patch": "@@ -35,6 +35,9 @@ es:\n     flagged: Reportado\n     undo_reject: Deshacer\n     view_context: 'Ver contexto'\n+    edit_history: 'Historial de ediciones'\n+    show_edit_history: 'Mostrar historial de ediciones'\n+    hide_edit_history: 'Ocultar historial de ediciones'\n   comment_box:\n     cancel: Cancelar\n     characters_remaining: 'caracteres restantes'"
    }
  ]
}
