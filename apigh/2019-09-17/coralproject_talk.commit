{
  "sha": "24a27ca958ad851f35e3ce4895f176aa58d632a2",
  "node_id": "MDY6Q29tbWl0NzI0NTQyNDI6MjRhMjdjYTk1OGFkODUxZjM1ZTNjZTQ4OTVmMTc2YWE1OGQ2MzJhMg==",
  "commit": {
    "author": {
      "name": "Nick Funk",
      "email": "nick.funk@outlook.com",
      "date": "2019-09-17T16:59:03Z"
    },
    "committer": {
      "name": "GitHub",
      "email": "noreply@github.com",
      "date": "2019-09-17T16:59:03Z"
    },
    "message": "Show the viewer's username in \"moderated by\" on moderation cards (#2573)\n\nIf a mod is looking at a card they themselves moderated, we want their\r\nusername to show up under \"moderated by\". This helps them recognize cards\r\nthey themselves moderated.\r\n\r\nCORL-615",
    "tree": {
      "sha": "89facdb5bfc1f5f1dbc3fb3ffa362a8ff1e6b5b0",
      "url": "https://api.github.com/repos/coralproject/talk/git/trees/89facdb5bfc1f5f1dbc3fb3ffa362a8ff1e6b5b0"
    },
    "url": "https://api.github.com/repos/coralproject/talk/git/commits/24a27ca958ad851f35e3ce4895f176aa58d632a2",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJdgRDXCRBK7hj4Ov3rIwAAdHIIABxgqzQVfxhfujM2i/kdMOJC\nl2Ww/nZoWeKa4+3OFdO9aZ89La+tRftGD2DmjbFlaww765lFu1eE6sXo8K+8jRbI\nN56ze/o/0DYsgHWdL870AJegp1kGhkeQn080JO3is1ZwwsKHp5s/FBWyMmhOdY6F\nNDW1LX4Bd04Rjl4LWTChdWk7AznHZnutR/HEp1+BTHlKYjvSehEwpNIwl97rYxn8\n8ytQGrvsVf0yK+nmtZuvkHpG6GRQGfHzMfOOwmiOYSMJ1oy+rWLMtBjEPhiJORln\n2SZ9l7TMNicEYuJV3osGC3h3br91UquKVlRbOYiZ/XB/Jzupv6W7hhgKyF8oB9A=\n=g71/\n-----END PGP SIGNATURE-----\n",
      "payload": "tree 89facdb5bfc1f5f1dbc3fb3ffa362a8ff1e6b5b0\nparent d03b180a304accd8272631d8e63b8adc032c41b6\nauthor Nick Funk <nick.funk@outlook.com> 1568739543 -0600\ncommitter GitHub <noreply@github.com> 1568739543 -0600\n\nShow the viewer's username in \"moderated by\" on moderation cards (#2573)\n\nIf a mod is looking at a card they themselves moderated, we want their\r\nusername to show up under \"moderated by\". This helps them recognize cards\r\nthey themselves moderated.\r\n\r\nCORL-615"
    }
  },
  "url": "https://api.github.com/repos/coralproject/talk/commits/24a27ca958ad851f35e3ce4895f176aa58d632a2",
  "html_url": "https://github.com/coralproject/talk/commit/24a27ca958ad851f35e3ce4895f176aa58d632a2",
  "comments_url": "https://api.github.com/repos/coralproject/talk/commits/24a27ca958ad851f35e3ce4895f176aa58d632a2/comments",
  "author": {
    "login": "nick-funk",
    "id": 5751504,
    "node_id": "MDQ6VXNlcjU3NTE1MDQ=",
    "avatar_url": "https://avatars2.githubusercontent.com/u/5751504?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nick-funk",
    "html_url": "https://github.com/nick-funk",
    "followers_url": "https://api.github.com/users/nick-funk/followers",
    "following_url": "https://api.github.com/users/nick-funk/following{/other_user}",
    "gists_url": "https://api.github.com/users/nick-funk/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nick-funk/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nick-funk/subscriptions",
    "organizations_url": "https://api.github.com/users/nick-funk/orgs",
    "repos_url": "https://api.github.com/users/nick-funk/repos",
    "events_url": "https://api.github.com/users/nick-funk/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nick-funk/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "web-flow",
    "id": 19864447,
    "node_id": "MDQ6VXNlcjE5ODY0NDQ3",
    "avatar_url": "https://avatars3.githubusercontent.com/u/19864447?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/web-flow",
    "html_url": "https://github.com/web-flow",
    "followers_url": "https://api.github.com/users/web-flow/followers",
    "following_url": "https://api.github.com/users/web-flow/following{/other_user}",
    "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions",
    "organizations_url": "https://api.github.com/users/web-flow/orgs",
    "repos_url": "https://api.github.com/users/web-flow/repos",
    "events_url": "https://api.github.com/users/web-flow/events{/privacy}",
    "received_events_url": "https://api.github.com/users/web-flow/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "d03b180a304accd8272631d8e63b8adc032c41b6",
      "url": "https://api.github.com/repos/coralproject/talk/commits/d03b180a304accd8272631d8e63b8adc032c41b6",
      "html_url": "https://github.com/coralproject/talk/commit/d03b180a304accd8272631d8e63b8adc032c41b6"
    }
  ],
  "stats": {
    "total": 71,
    "additions": 70,
    "deletions": 1
  },
  "files": [
    {
      "sha": "2e501d4b0a9ee692895f54955fb96f65c20ab509",
      "filename": "src/core/client/admin/components/ModerateCard/ModeratedByContainer.spec.tsx",
      "status": "added",
      "additions": 39,
      "deletions": 0,
      "changes": 39,
      "blob_url": "https://github.com/coralproject/talk/blob/24a27ca958ad851f35e3ce4895f176aa58d632a2/src/core/client/admin/components/ModerateCard/ModeratedByContainer.spec.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/24a27ca958ad851f35e3ce4895f176aa58d632a2/src/core/client/admin/components/ModerateCard/ModeratedByContainer.spec.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/components/ModerateCard/ModeratedByContainer.spec.tsx?ref=24a27ca958ad851f35e3ce4895f176aa58d632a2",
      "patch": "@@ -0,0 +1,39 @@\n+import React from \"react\";\n+import { createRenderer } from \"react-test-renderer/shallow\";\n+\n+import { removeFragmentRefs } from \"coral-framework/testHelpers\";\n+import { PropTypesOf } from \"coral-framework/types\";\n+\n+import ModeratedByContainer from \"./ModeratedByContainer\";\n+\n+const ModeratedByContainerN = removeFragmentRefs(ModeratedByContainer);\n+\n+it(\"viewer's username shows on moderation cards moderated by viewer\", () => {\n+  const props: PropTypesOf<typeof ModeratedByContainerN> = {\n+    comment: {\n+      id: \"comment-id\",\n+      statusLiveUpdated: false,\n+      statusHistory: {\n+        edges: [\n+          {\n+            moderator: {\n+              id: \"viewer\",\n+              username: \"viewer\",\n+            },\n+          },\n+        ],\n+      },\n+    },\n+    viewer: {\n+      id: \"viewer\",\n+      username: \"viewer\",\n+    },\n+    onUsernameClicked: (id?: string | null) => {\n+      return;\n+    },\n+  };\n+\n+  const renderer = createRenderer();\n+  renderer.render(<ModeratedByContainerN {...props} />);\n+  expect(renderer.getRenderOutput()).toMatchSnapshot();\n+});"
    },
    {
      "sha": "47268cc4be82657824deed7ef655d0b475a43f4e",
      "filename": "src/core/client/admin/components/ModerateCard/ModeratedByContainer.tsx",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/coralproject/talk/blob/24a27ca958ad851f35e3ce4895f176aa58d632a2/src/core/client/admin/components/ModerateCard/ModeratedByContainer.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/24a27ca958ad851f35e3ce4895f176aa58d632a2/src/core/client/admin/components/ModerateCard/ModeratedByContainer.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/components/ModerateCard/ModeratedByContainer.tsx?ref=24a27ca958ad851f35e3ce4895f176aa58d632a2",
      "patch": "@@ -29,7 +29,7 @@ const ModeratedByContainer: React.FunctionComponent<Props> = ({\n       <Localized id=\"moderate-comment-moderatedBySystem\">System</Localized>\n     );\n   } else if (viewer.id === comment.statusHistory.edges[0].node.moderator.id) {\n-    moderatedBy = null;\n+    moderatedBy = viewer.username ? <>{viewer.username}</> : null;\n   } else {\n     moderatedBy = <>{comment.statusHistory.edges[0].node.moderator.username}</>;\n     id = comment.statusHistory.edges[0].node.moderator.id;\n@@ -73,6 +73,7 @@ const enhanced = withFragmentContainer<Props>({\n   viewer: graphql`\n     fragment ModeratedByContainer_viewer on User {\n       id\n+      username\n     }\n   `,\n })(ModeratedByContainer);"
    },
    {
      "sha": "d9ec8a8b730d68a9a5e8e71edd98bbeb14b41b7a",
      "filename": "src/core/client/admin/components/ModerateCard/__snapshots__/ModeratedByContainer.spec.tsx.snap",
      "status": "added",
      "additions": 29,
      "deletions": 0,
      "changes": 29,
      "blob_url": "https://github.com/coralproject/talk/blob/24a27ca958ad851f35e3ce4895f176aa58d632a2/src/core/client/admin/components/ModerateCard/__snapshots__/ModeratedByContainer.spec.tsx.snap",
      "raw_url": "https://github.com/coralproject/talk/raw/24a27ca958ad851f35e3ce4895f176aa58d632a2/src/core/client/admin/components/ModerateCard/__snapshots__/ModeratedByContainer.spec.tsx.snap",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/components/ModerateCard/__snapshots__/ModeratedByContainer.spec.tsx.snap?ref=24a27ca958ad851f35e3ce4895f176aa58d632a2",
      "patch": "@@ -0,0 +1,29 @@\n+// Jest Snapshot v1, https://goo.gl/fbAQLP\n+\n+exports[`viewer's username shows on moderation cards moderated by viewer 1`] = `\n+<ForwardRef(Relay(ModeratedByContainer))\n+  comment={\n+    Object {\n+      \"id\": \"comment-id\",\n+      \"statusHistory\": Object {\n+        \"edges\": Array [\n+          Object {\n+            \"moderator\": Object {\n+              \"id\": \"viewer\",\n+              \"username\": \"viewer\",\n+            },\n+          },\n+        ],\n+      },\n+      \"statusLiveUpdated\": false,\n+    }\n+  }\n+  onUsernameClicked={[Function]}\n+  viewer={\n+    Object {\n+      \"id\": \"viewer\",\n+      \"username\": \"viewer\",\n+    }\n+  }\n+/>\n+`;"
    }
  ]
}
