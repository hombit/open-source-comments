{
  "sha": "2c0efac25eede4477b28e03be72aa9cc72b05e96",
  "node_id": "MDY6Q29tbWl0NzU2OTU3ODoyYzBlZmFjMjVlZWRlNDQ3N2IyOGUwM2JlNzJhYTljYzcyYjA1ZTk2",
  "commit": {
    "author": {
      "name": "Robin Ward",
      "email": "robin.ward@gmail.com",
      "date": "2019-10-24T16:37:33Z"
    },
    "committer": {
      "name": "Robin Ward",
      "email": "robin.ward@gmail.com",
      "date": "2019-10-24T16:39:58Z"
    },
    "message": "FIX: Broken certificates",
    "tree": {
      "sha": "a3d93a4cd833c082614e6220593ff2e3ee5a3fa4",
      "url": "https://api.github.com/repos/discourse/discourse/git/trees/a3d93a4cd833c082614e6220593ff2e3ee5a3fa4"
    },
    "url": "https://api.github.com/repos/discourse/discourse/git/commits/2c0efac25eede4477b28e03be72aa9cc72b05e96",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/discourse/discourse/commits/2c0efac25eede4477b28e03be72aa9cc72b05e96",
  "html_url": "https://github.com/discourse/discourse/commit/2c0efac25eede4477b28e03be72aa9cc72b05e96",
  "comments_url": "https://api.github.com/repos/discourse/discourse/commits/2c0efac25eede4477b28e03be72aa9cc72b05e96/comments",
  "author": {
    "login": "eviltrout",
    "id": 17538,
    "node_id": "MDQ6VXNlcjE3NTM4",
    "avatar_url": "https://avatars0.githubusercontent.com/u/17538?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/eviltrout",
    "html_url": "https://github.com/eviltrout",
    "followers_url": "https://api.github.com/users/eviltrout/followers",
    "following_url": "https://api.github.com/users/eviltrout/following{/other_user}",
    "gists_url": "https://api.github.com/users/eviltrout/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/eviltrout/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/eviltrout/subscriptions",
    "organizations_url": "https://api.github.com/users/eviltrout/orgs",
    "repos_url": "https://api.github.com/users/eviltrout/repos",
    "events_url": "https://api.github.com/users/eviltrout/events{/privacy}",
    "received_events_url": "https://api.github.com/users/eviltrout/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "eviltrout",
    "id": 17538,
    "node_id": "MDQ6VXNlcjE3NTM4",
    "avatar_url": "https://avatars0.githubusercontent.com/u/17538?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/eviltrout",
    "html_url": "https://github.com/eviltrout",
    "followers_url": "https://api.github.com/users/eviltrout/followers",
    "following_url": "https://api.github.com/users/eviltrout/following{/other_user}",
    "gists_url": "https://api.github.com/users/eviltrout/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/eviltrout/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/eviltrout/subscriptions",
    "organizations_url": "https://api.github.com/users/eviltrout/orgs",
    "repos_url": "https://api.github.com/users/eviltrout/repos",
    "events_url": "https://api.github.com/users/eviltrout/events{/privacy}",
    "received_events_url": "https://api.github.com/users/eviltrout/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "85c08b84a578e6fc80582e1137e8bccd8e7f6cb6",
      "url": "https://api.github.com/repos/discourse/discourse/commits/85c08b84a578e6fc80582e1137e8bccd8e7f6cb6",
      "html_url": "https://github.com/discourse/discourse/commit/85c08b84a578e6fc80582e1137e8bccd8e7f6cb6"
    }
  ],
  "stats": {
    "total": 12,
    "additions": 8,
    "deletions": 4
  },
  "files": [
    {
      "sha": "5e25bb851f0eb3dfde3452f84a926553c96e58ea",
      "filename": "plugins/discourse-narrative-bot/lib/discourse_narrative_bot/certificate_generator.rb",
      "status": "modified",
      "additions": 8,
      "deletions": 4,
      "changes": 12,
      "blob_url": "https://github.com/discourse/discourse/blob/2c0efac25eede4477b28e03be72aa9cc72b05e96/plugins/discourse-narrative-bot/lib/discourse_narrative_bot/certificate_generator.rb",
      "raw_url": "https://github.com/discourse/discourse/raw/2c0efac25eede4477b28e03be72aa9cc72b05e96/plugins/discourse-narrative-bot/lib/discourse_narrative_bot/certificate_generator.rb",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/plugins/discourse-narrative-bot/lib/discourse_narrative_bot/certificate_generator.rb?ref=2c0efac25eede4477b28e03be72aa9cc72b05e96",
      "patch": "@@ -2,9 +2,9 @@\n \n module DiscourseNarrativeBot\n   class CertificateGenerator\n-    def initialize(user, date, avatar_url)\n+    def initialize(user, date, avatar_data)\n       @user = user\n-      @avatar_url = avatar_url\n+      @avatar_data = avatar_data\n \n       date =\n         begin\n@@ -46,7 +46,7 @@ def assign_options(width, logo_group)\n         width: width,\n         discobot_user: @discobot_user,\n         date: @date,\n-        avatar_url: base64_image_link(@avatar_url),\n+        avatar_url: base64_image_data(@avatar_data),\n         logo_group: logo_group,\n         name: name\n       }\n@@ -79,9 +79,13 @@ def logo_group(size, width, height)\n       end\n     end\n \n+    def base64_image_data(data)\n+      \"xlink:href=\\\"data:image/png;base64,#{Base64.strict_encode64(data)}\\\"\"\n+    end\n+\n     def base64_image_link(url)\n       if image = fetch_image(url)\n-        \"xlink:href=\\\"data:image/png;base64,#{Base64.strict_encode64(image)}\\\"\"\n+        base64_image_data(image)\n       else\n         \"\"\n       end"
    }
  ]
}
