{
  "sha": "3b1d4575221fd2565091000e025adc47e6e0dc3d",
  "node_id": "MDY6Q29tbWl0MTgwOTYzMjI6M2IxZDQ1NzUyMjFmZDI1NjUwOTEwMDBlMDI1YWRjNDdlNmUwZGMzZA==",
  "commit": {
    "author": {
      "name": "Jacob Barkdull",
      "email": "jacobbarkdull@gmail.com",
      "date": "2019-11-16T16:03:56Z"
    },
    "committer": {
      "name": "Jacob Barkdull",
      "email": "jacobbarkdull@gmail.com",
      "date": "2019-11-16T16:03:56Z"
    },
    "message": "Improved sendmail support\n\nSome servers don't deliver emails if the From and/or Reply-To headers are set with blank email addresses.",
    "tree": {
      "sha": "bacb84cfd27a27e111eada9747c5f4d4867908d7",
      "url": "https://api.github.com/repos/jacobwb/hashover-next/git/trees/bacb84cfd27a27e111eada9747c5f4d4867908d7"
    },
    "url": "https://api.github.com/repos/jacobwb/hashover-next/git/commits/3b1d4575221fd2565091000e025adc47e6e0dc3d",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEq4pVVPF17yxZ5cYw5kqpM55vbrAFAl3QHisACgkQ5kqpM55v\nbrAFIg//e6cvOfDhdYTKT5Xya170ceHqMI4oWxmUTk/iBxS63xeZ69a0hi5obPUo\nVSZis9ow8ekHxWzTBzS8ZpZ1gPh8z0NdIxQoqrcYNF6HAXNnnNic+QlgBh8C6K6k\nnvyZp3Q5zB1O5e/G+StcwM6AQjzb1xCfwzLNwrAIFOQB/bFbDYBzPfBzyK4UQTjB\n0ojceDj9U2YYz6lG/SQ3pYOJPGMNthwLdwjMDASML3ldiYBzSJ9dbDk07QcXyhY/\n1cRA96JVK77N3fzIJnpEVmuU2/RoWJndTpFm1BpvKJm7g9UvG3cSC5GVTJV4lur6\nmTF2kER5nb72JPVzQw+Kx0jPoRdPsMvLz5EE1AlzRu5LoGIYS3CTOWqGCi8Cft0J\n+Ofmrylm9nveHvIq1UGGAjn6eWmhiJglMW+Aas4xnUEd9Mb2YNvtINqB/VflIClP\nEcDMJqV2xvgKnYy/bQbiQK1s+ENjNmeplGff/lVCaimSMNrpnl8Z4hJ+XcmMfSyK\nhnmz6gwSBxBs97kroJOpV9MWaXedbumXOfsMI+5M0S0CQv5rAKMi8OrhsI/LlYMh\nfC5Fsl7QU44YP66ctNycII2teYZLObQyHCZG7qOWFnYDUabS+nxOfH5Hkx0gW+fD\ngA6/N3N/L/TbcE2Nl/mh/hnE+plS2HE8WgyiQkxAvxdhL1AFmj8=\n=yDuQ\n-----END PGP SIGNATURE-----",
      "payload": "tree bacb84cfd27a27e111eada9747c5f4d4867908d7\nparent 17e78ff63629c482fbb1833f819d75382e6fc1cf\nauthor Jacob Barkdull <jacobbarkdull@gmail.com> 1573920236 -0800\ncommitter Jacob Barkdull <jacobbarkdull@gmail.com> 1573920236 -0800\n\nImproved sendmail support\n\nSome servers don't deliver emails if the From and/or Reply-To headers are set with blank email addresses.\n"
    }
  },
  "url": "https://api.github.com/repos/jacobwb/hashover-next/commits/3b1d4575221fd2565091000e025adc47e6e0dc3d",
  "html_url": "https://github.com/jacobwb/hashover-next/commit/3b1d4575221fd2565091000e025adc47e6e0dc3d",
  "comments_url": "https://api.github.com/repos/jacobwb/hashover-next/commits/3b1d4575221fd2565091000e025adc47e6e0dc3d/comments",
  "author": {
    "login": "jacobwb",
    "id": 4677622,
    "node_id": "MDQ6VXNlcjQ2Nzc2MjI=",
    "avatar_url": "https://avatars3.githubusercontent.com/u/4677622?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jacobwb",
    "html_url": "https://github.com/jacobwb",
    "followers_url": "https://api.github.com/users/jacobwb/followers",
    "following_url": "https://api.github.com/users/jacobwb/following{/other_user}",
    "gists_url": "https://api.github.com/users/jacobwb/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jacobwb/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jacobwb/subscriptions",
    "organizations_url": "https://api.github.com/users/jacobwb/orgs",
    "repos_url": "https://api.github.com/users/jacobwb/repos",
    "events_url": "https://api.github.com/users/jacobwb/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jacobwb/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "jacobwb",
    "id": 4677622,
    "node_id": "MDQ6VXNlcjQ2Nzc2MjI=",
    "avatar_url": "https://avatars3.githubusercontent.com/u/4677622?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jacobwb",
    "html_url": "https://github.com/jacobwb",
    "followers_url": "https://api.github.com/users/jacobwb/followers",
    "following_url": "https://api.github.com/users/jacobwb/following{/other_user}",
    "gists_url": "https://api.github.com/users/jacobwb/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jacobwb/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jacobwb/subscriptions",
    "organizations_url": "https://api.github.com/users/jacobwb/orgs",
    "repos_url": "https://api.github.com/users/jacobwb/repos",
    "events_url": "https://api.github.com/users/jacobwb/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jacobwb/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "17e78ff63629c482fbb1833f819d75382e6fc1cf",
      "url": "https://api.github.com/repos/jacobwb/hashover-next/commits/17e78ff63629c482fbb1833f819d75382e6fc1cf",
      "html_url": "https://github.com/jacobwb/hashover-next/commit/17e78ff63629c482fbb1833f819d75382e6fc1cf"
    }
  ],
  "stats": {
    "total": 26,
    "additions": 20,
    "deletions": 6
  },
  "files": [
    {
      "sha": "36bd37d56273ec7db76647df20fbfce89c06af3d",
      "filename": "backend/classes/sendmail.php",
      "status": "modified",
      "additions": 20,
      "deletions": 6,
      "changes": 26,
      "blob_url": "https://github.com/jacobwb/hashover-next/blob/3b1d4575221fd2565091000e025adc47e6e0dc3d/backend/classes/sendmail.php",
      "raw_url": "https://github.com/jacobwb/hashover-next/raw/3b1d4575221fd2565091000e025adc47e6e0dc3d/backend/classes/sendmail.php",
      "contents_url": "https://api.github.com/repos/jacobwb/hashover-next/contents/backend/classes/sendmail.php?ref=3b1d4575221fd2565091000e025adc47e6e0dc3d",
      "patch": "@@ -160,8 +160,16 @@ protected function getHeaders ($boundary)\n \n \t\t// Add recipient headers\n \t\t$data[] = 'MIME-Version: 1.0';\n-\t\t$data[] = 'From: ' . $this->format ($this->from);\n-\t\t$data[] = 'Reply-To: ' . $this->format ($this->reply);\n+\n+\t\t// Set From address if one is present\n+\t\tif (!empty ($this->from['email'])) {\n+\t\t\t$data[] = 'From: ' . $this->format ($this->from);\n+\t\t}\n+\n+\t\t// Set Reply-To address if one is present\n+\t\tif (!empty ($this->reply['email'])) {\n+\t\t\t$data[] = 'Reply-To: ' . $this->format ($this->reply);\n+\t\t}\n \n \t\t// Check if message type is text\n \t\tif ($this->type === 'text') {\n@@ -238,10 +246,16 @@ public function send ()\n \t\t// Get email headers\n \t\t$headers = $this->getHeaders ($boundary);\n \n-\t\t// Set envelope sender address with -f option\n-\t\t$params = '-f' . $this->reply['email'];\n+\t\t// Check if a From email address is set\n+\t\tif (!empty ($this->from['email'])) {\n+\t\t\t// If so, set envelope sender address with -f option\n+\t\t\t$params = '-f ' . $this->from['email'];\n \n-\t\t// And actually send the email\n-\t\tmail ($to, $subject, $message, $headers, $params);\n+\t\t\t// And actually send the email\n+\t\t\tmail ($to, $subject, $message, $headers, $params);\n+\t\t} else {\n+\t\t\t// If not, send email normally\n+\t\t\tmail ($to, $subject, $message, $headers);\n+\t\t}\n \t}\n }"
    }
  ]
}
