{
  "sha": "5a70f50032f3f48644e6715cdf129b79842dd764",
  "node_id": "MDY6Q29tbWl0NzU2OTU3ODo1YTcwZjUwMDMyZjNmNDg2NDRlNjcxNWNkZjEyOWI3OTg0MmRkNzY0",
  "commit": {
    "author": {
      "name": "Rafael dos Santos Silva",
      "email": "xfalcox@gmail.com",
      "date": "2020-01-10T16:41:35Z"
    },
    "committer": {
      "name": "Rafael dos Santos Silva",
      "email": "xfalcox@gmail.com",
      "date": "2020-01-10T16:41:35Z"
    },
    "message": "FEATURE: Use new Badging API\n\nNow that the spec is finished use the unprefixed API, which was also moved\nfrom window to navigator.\n\nStill uses feature detection so it fail gracefully when not available in\nthe user agent.",
    "tree": {
      "sha": "80c508d6392de6d6ad882d7740f51dfbce9e61d2",
      "url": "https://api.github.com/repos/discourse/discourse/git/trees/80c508d6392de6d6ad882d7740f51dfbce9e61d2"
    },
    "url": "https://api.github.com/repos/discourse/discourse/git/commits/5a70f50032f3f48644e6715cdf129b79842dd764",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJGBAABCgAwFiEE47VrS56yVagSL+PHXlA2AiezSTgFAl4YqaQSHHhmYWxjb3hA\nZ21haWwuY29tAAoJEF5QNgIns0k47XYP/i7QTZmQlbI5TIIl47TqeEBqpknZaK5F\n4mXDe98jiaBJWpMBN+I5ujATUkiq+F3PjY5+WFEo4M4bUbVn0at3UvlpJHvv8QRj\njz5GLAwPQN1O8X46RMyjoGFA2yE8hLo3kcczDb9Ekf3GYrWdMX7V0C4FXujWNFGi\nB0Fnz8GyTWkSVtvGCGxczi7HJaEtRW/6aqrkb3pnegmlJCfsupf0XbEt2TdZToAW\nahVY5Nhv7YVO6/jPTgcWUAd8eEtdFIQ2VxXx8HAIXHSzFICTwC0UzUJVxnm64jGR\nSW3dPQsfuAJ2fBlEmKUFq62kw7wv0k9CMNdFnUvXpIheOjffRGy0JmyfWSYqA3Ft\nP88xt2+YB3iZmNxYIbgu6nWXkJoLultFoR+MvqPBFxa74vzj3lfV8b02vVxwhuqt\nO4YcrYYgkaJNyTm37OkkpQht7EqvYdHuTdB6qBJG5cbwqudhSJSqJufkSMTfLjbX\nw5866wm86Gu8qP5CctUQXY+Sgcu4qrwHeWgUliuxMBkHdoRvjxN7nNWWotO4Xlo/\nDR1OeeSZ9i+UchkjpGtr6DxCKxKGd0rpHz3a9MHvMvNkXm2UrF0Xprqe+MlvSMAk\nmBhbKnN1OBgyAbDMpFUIPMAK0S5YVtcgOXS6UH/rZXitmshHj+jumWaeZX5gdYH/\ndYph6A5WNEuF\n=MxwF\n-----END PGP SIGNATURE-----",
      "payload": "tree 80c508d6392de6d6ad882d7740f51dfbce9e61d2\nparent 3ddebc61a9c80f984c21263db1e3799afbb3ff13\nauthor Rafael dos Santos Silva <xfalcox@gmail.com> 1578674495 -0300\ncommitter Rafael dos Santos Silva <xfalcox@gmail.com> 1578674495 -0300\n\nFEATURE: Use new Badging API\n\nNow that the spec is finished use the unprefixed API, which was also moved\nfrom window to navigator.\n\nStill uses feature detection so it fail gracefully when not available in\nthe user agent.\n"
    }
  },
  "url": "https://api.github.com/repos/discourse/discourse/commits/5a70f50032f3f48644e6715cdf129b79842dd764",
  "html_url": "https://github.com/discourse/discourse/commit/5a70f50032f3f48644e6715cdf129b79842dd764",
  "comments_url": "https://api.github.com/repos/discourse/discourse/commits/5a70f50032f3f48644e6715cdf129b79842dd764/comments",
  "author": {
    "login": "xfalcox",
    "id": 1385470,
    "node_id": "MDQ6VXNlcjEzODU0NzA=",
    "avatar_url": "https://avatars3.githubusercontent.com/u/1385470?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/xfalcox",
    "html_url": "https://github.com/xfalcox",
    "followers_url": "https://api.github.com/users/xfalcox/followers",
    "following_url": "https://api.github.com/users/xfalcox/following{/other_user}",
    "gists_url": "https://api.github.com/users/xfalcox/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/xfalcox/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/xfalcox/subscriptions",
    "organizations_url": "https://api.github.com/users/xfalcox/orgs",
    "repos_url": "https://api.github.com/users/xfalcox/repos",
    "events_url": "https://api.github.com/users/xfalcox/events{/privacy}",
    "received_events_url": "https://api.github.com/users/xfalcox/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "xfalcox",
    "id": 1385470,
    "node_id": "MDQ6VXNlcjEzODU0NzA=",
    "avatar_url": "https://avatars3.githubusercontent.com/u/1385470?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/xfalcox",
    "html_url": "https://github.com/xfalcox",
    "followers_url": "https://api.github.com/users/xfalcox/followers",
    "following_url": "https://api.github.com/users/xfalcox/following{/other_user}",
    "gists_url": "https://api.github.com/users/xfalcox/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/xfalcox/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/xfalcox/subscriptions",
    "organizations_url": "https://api.github.com/users/xfalcox/orgs",
    "repos_url": "https://api.github.com/users/xfalcox/repos",
    "events_url": "https://api.github.com/users/xfalcox/events{/privacy}",
    "received_events_url": "https://api.github.com/users/xfalcox/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "3ddebc61a9c80f984c21263db1e3799afbb3ff13",
      "url": "https://api.github.com/repos/discourse/discourse/commits/3ddebc61a9c80f984c21263db1e3799afbb3ff13",
      "html_url": "https://github.com/discourse/discourse/commit/3ddebc61a9c80f984c21263db1e3799afbb3ff13"
    }
  ],
  "stats": {
    "total": 4,
    "additions": 2,
    "deletions": 2
  },
  "files": [
    {
      "sha": "f406604dfa7cce7f2f29934931f1205ac316f987",
      "filename": "app/assets/javascripts/discourse/initializers/badging.js.es6",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/discourse/discourse/blob/5a70f50032f3f48644e6715cdf129b79842dd764/app/assets/javascripts/discourse/initializers/badging.js.es6",
      "raw_url": "https://github.com/discourse/discourse/raw/5a70f50032f3f48644e6715cdf129b79842dd764/app/assets/javascripts/discourse/initializers/badging.js.es6",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/app/assets/javascripts/discourse/initializers/badging.js.es6?ref=5a70f50032f3f48644e6715cdf129b79842dd764",
      "patch": "@@ -4,7 +4,7 @@ export default {\n   after: \"message-bus\",\n \n   initialize(container) {\n-    if (!window.ExperimentalBadge) return; // must have the Badging API\n+    if (!navigator.setAppBadge) return; // must have the Badging API\n \n     const user = container.lookup(\"current-user:main\");\n     if (!user) return; // must be logged in\n@@ -18,6 +18,6 @@ export default {\n   },\n \n   _updateBadge() {\n-    window.ExperimentalBadge.set(this.notifications);\n+    navigator.setAppBadge(this.notifications);\n   }\n };"
    }
  ]
}
