{
  "sha": "93761d41c76689ae049cb395812545d25900ac38",
  "node_id": "MDY6Q29tbWl0MTA1NjMzMjI6OTM3NjFkNDFjNzY2ODlhZTA0OWNiMzk1ODEyNTQ1ZDI1OTAwYWMzOA==",
  "commit": {
    "author": {
      "name": "Kaj Magnus Lindberg",
      "email": "kajmagnus3@gmail.com",
      "date": "2020-01-12T03:52:48Z"
    },
    "committer": {
      "name": "Kaj Magnus Lindberg",
      "email": "kajmagnus3@gmail.com",
      "date": "2020-01-12T03:52:48Z"
    },
    "message": "Fix gulp prod build error.",
    "tree": {
      "sha": "848206345834924e6510e59cee402b4219835452",
      "url": "https://api.github.com/repos/debiki/talkyard/git/trees/848206345834924e6510e59cee402b4219835452"
    },
    "url": "https://api.github.com/repos/debiki/talkyard/git/commits/93761d41c76689ae049cb395812545d25900ac38",
    "comment_count": 0,
    "verification": {
      "verified": false,
      "reason": "unsigned",
      "signature": null,
      "payload": null
    }
  },
  "url": "https://api.github.com/repos/debiki/talkyard/commits/93761d41c76689ae049cb395812545d25900ac38",
  "html_url": "https://github.com/debiki/talkyard/commit/93761d41c76689ae049cb395812545d25900ac38",
  "comments_url": "https://api.github.com/repos/debiki/talkyard/commits/93761d41c76689ae049cb395812545d25900ac38/comments",
  "author": {
    "login": "kajmagnus",
    "id": 7477359,
    "node_id": "MDQ6VXNlcjc0NzczNTk=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/7477359?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kajmagnus",
    "html_url": "https://github.com/kajmagnus",
    "followers_url": "https://api.github.com/users/kajmagnus/followers",
    "following_url": "https://api.github.com/users/kajmagnus/following{/other_user}",
    "gists_url": "https://api.github.com/users/kajmagnus/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kajmagnus/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kajmagnus/subscriptions",
    "organizations_url": "https://api.github.com/users/kajmagnus/orgs",
    "repos_url": "https://api.github.com/users/kajmagnus/repos",
    "events_url": "https://api.github.com/users/kajmagnus/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kajmagnus/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "kajmagnus",
    "id": 7477359,
    "node_id": "MDQ6VXNlcjc0NzczNTk=",
    "avatar_url": "https://avatars1.githubusercontent.com/u/7477359?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kajmagnus",
    "html_url": "https://github.com/kajmagnus",
    "followers_url": "https://api.github.com/users/kajmagnus/followers",
    "following_url": "https://api.github.com/users/kajmagnus/following{/other_user}",
    "gists_url": "https://api.github.com/users/kajmagnus/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kajmagnus/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kajmagnus/subscriptions",
    "organizations_url": "https://api.github.com/users/kajmagnus/orgs",
    "repos_url": "https://api.github.com/users/kajmagnus/repos",
    "events_url": "https://api.github.com/users/kajmagnus/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kajmagnus/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "606be9cd74a5151eb9bebee7b3ee26311c31af96",
      "url": "https://api.github.com/repos/debiki/talkyard/commits/606be9cd74a5151eb9bebee7b3ee26311c31af96",
      "html_url": "https://github.com/debiki/talkyard/commit/606be9cd74a5151eb9bebee7b3ee26311c31af96"
    }
  ],
  "stats": {
    "total": 105,
    "additions": 101,
    "deletions": 4
  },
  "files": [
    {
      "sha": "9772838facc4218491643e85958984858209c73a",
      "filename": "client/app-slim/prelude.ts",
      "status": "modified",
      "additions": 3,
      "deletions": 2,
      "changes": 5,
      "blob_url": "https://github.com/debiki/talkyard/blob/93761d41c76689ae049cb395812545d25900ac38/client/app-slim/prelude.ts",
      "raw_url": "https://github.com/debiki/talkyard/raw/93761d41c76689ae049cb395812545d25900ac38/client/app-slim/prelude.ts",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/client/app-slim/prelude.ts?ref=93761d41c76689ae049cb395812545d25900ac38",
      "patch": "@@ -79,11 +79,12 @@ function doNextFrameOrNow(something: () => void) {\n    namespace debiki2 {\n //------------------------------------------------------------------------------\n \n-// @ifdef DEBUG\n+// Typescript changes this so the macro breaks somehow, in prod builds:\n+// x ifdef DEBUG\n export function toStr(x: any, indentation: number = 2): string {\n   return JSON.stringify(x, undefined, indentation);\n }\n-// @endif\n+// x endif\n \n \n // If in an embedded comments iframe."
    },
    {
      "sha": "6aa426a44c3c73b6f99c5adac7d0b9f4735886dd",
      "filename": "gulpfile.js",
      "status": "modified",
      "additions": 18,
      "deletions": 1,
      "changes": 19,
      "blob_url": "https://github.com/debiki/talkyard/blob/93761d41c76689ae049cb395812545d25900ac38/gulpfile.js",
      "raw_url": "https://github.com/debiki/talkyard/raw/93761d41c76689ae049cb395812545d25900ac38/gulpfile.js",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/gulpfile.js?ref=93761d41c76689ae049cb395812545d25900ac38",
      "patch": "@@ -25,6 +25,7 @@\n  */\n \n const gulp = require('gulp');\n+const gDebug = require('gulp-debug');\n const plumber = require('gulp-plumber');\n const newer = require('gulp-newer');\n const typeScript = require('gulp-typescript');\n@@ -582,6 +583,10 @@ gulp.task('enable-prod-stuff', (done) => {\n gulp.task('minifyTranslations', gulp.series('buildTranslations', () => {\n   return gulp.src([`${serverDestTranslations}/**/*.js`, `!${serverDestTranslations}/**/*.min.js`])\n       .pipe(plumber())\n+      .pipe(gDebug({\n+        minimal: false,\n+        title: `gulp-debug: minifying transl:`,\n+      }))\n       .pipe(preprocess({ context: preprocessProdContext }))\n       .pipe(uglify())\n       .pipe(rename({ extname: '.min.js' }))\n@@ -593,14 +598,18 @@ gulp.task('minifyTranslations', gulp.series('buildTranslations', () => {\n }));\n \n \n-gulp.task('minifyScripts', gulp.series('compileConcatAllScripts', 'minifyTranslations', () => {\n+gulp.task('minifyScriptsImpl', gulp.series(() => {\n   // preprocess() removes all @ifdef DEBUG â€” however (!) be sure to not place '// @endif'\n   // on the very last line in a {} block, because it would get removed, by... by what? the\n   // Typescript compiler? This results in an impossible-to-understand \"Unbalanced delimiter\n   // found in string\" error with a meaningless stacktrace, in preprocess().\n   function makeMinJsGzStream(sourceAndDest, gzipped) {\n     let stream = gulp.src([`${sourceAndDest}/*.js`, `!${sourceAndDest}/*.min.js`])\n       .pipe(plumber())\n+      .pipe(gDebug({\n+        minimal: false,\n+        title: `gulp-debug: minifying scripts: ${JSON.stringify(sourceAndDest)}`,\n+      }))\n       .pipe(preprocess({ context: preprocessProdContext })) // see comment above\n       .pipe(uglify())\n       .pipe(rename({ extname: '.min.js' }))\n@@ -619,6 +628,14 @@ gulp.task('minifyScripts', gulp.series('compileConcatAllScripts', 'minifyTransla\n }));\n \n \n+gulp.task('minifyScripts', gulp.series(\n+    'compileConcatAllScripts', 'minifyTranslations', 'minifyScriptsImpl'));\n+\n+\n+gulp.task('testProdMinify', gulp.series(\n+    'enable-prod-stuff', 'minifyScriptsImpl'));\n+\n+\n \n gulp.task('compile-stylus', () => {\n   const stylusOptsLeftToRight = {"
    },
    {
      "sha": "f62d51ae7b964f6ee82bcf2e6c7e28e867092ff4",
      "filename": "modules/ed-versions",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": null,
      "raw_url": null,
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/modules/ed-versions?ref=93761d41c76689ae049cb395812545d25900ac38",
      "patch": "@@ -1 +1 @@\n-Subproject commit 8f73a88587fc8fe84fbf83ac288f92525816db3f\n+Subproject commit f62d51ae7b964f6ee82bcf2e6c7e28e867092ff4"
    },
    {
      "sha": "2104757533a0c61b98dc003cdea3381955bd6c86",
      "filename": "package.json",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/debiki/talkyard/blob/93761d41c76689ae049cb395812545d25900ac38/package.json",
      "raw_url": "https://github.com/debiki/talkyard/raw/93761d41c76689ae049cb395812545d25900ac38/package.json",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/package.json?ref=93761d41c76689ae049cb395812545d25900ac38",
      "patch": "@@ -51,6 +51,7 @@\n     \"gulp-clean-css\": \"^4.0.0\",\n     \"gulp-cli\": \"^2.0.1\",\n     \"gulp-concat\": \"^2.6.1\",\n+    \"gulp-debug\": \"^4.0.0\",\n     \"gulp-gzip\": \"^1.4.2\",\n     \"gulp-insert\": \"^0.5.0\",\n     \"gulp-newer\": \"^1.4.0\","
    },
    {
      "sha": "1b4b8924f22be70ab4bf05ab1d402d65951979ae",
      "filename": "yarn.lock",
      "status": "modified",
      "additions": 78,
      "deletions": 0,
      "changes": 78,
      "blob_url": "https://github.com/debiki/talkyard/blob/93761d41c76689ae049cb395812545d25900ac38/yarn.lock",
      "raw_url": "https://github.com/debiki/talkyard/raw/93761d41c76689ae049cb395812545d25900ac38/yarn.lock",
      "contents_url": "https://api.github.com/repos/debiki/talkyard/contents/yarn.lock?ref=93761d41c76689ae049cb395812545d25900ac38",
      "patch": "@@ -191,6 +191,13 @@ ansi-styles@^3.1.0:\n   dependencies:\n     color-convert \"^1.9.0\"\n \n+ansi-styles@^3.2.1:\n+  version \"3.2.1\"\n+  resolved \"https://registry.yarnpkg.com/ansi-styles/-/ansi-styles-3.2.1.tgz#41fbb20243e50b12be0f04b8dedbf07520ce841d\"\n+  integrity sha512-VT0ZI6kZRdTh8YyJw3SMbYm/u+NqfsAxEpWO0Pf9sq8/e94WxxOpPKx9FR1FlyCtOVDNOQ+8ntlqFxiRc+r5qA==\n+  dependencies:\n+    color-convert \"^1.9.0\"\n+\n ansi-wrap@0.1.0, ansi-wrap@^0.1.0:\n   version \"0.1.0\"\n   resolved \"https://registry.yarnpkg.com/ansi-wrap/-/ansi-wrap-0.1.0.tgz#a82250ddb0015e9a27ca82e82ea603bbfa45efaf\"\n@@ -601,6 +608,15 @@ chalk@^2.0.0:\n     escape-string-regexp \"^1.0.5\"\n     supports-color \"^4.0.0\"\n \n+chalk@^2.3.0:\n+  version \"2.4.2\"\n+  resolved \"https://registry.yarnpkg.com/chalk/-/chalk-2.4.2.tgz#cd42541677a54333cf541a49108c1432b44c9424\"\n+  integrity sha512-Mti+f9lpJNcwF4tWV8/OrTTtF1gZi+f8FqlyAdouralcFWFQWF2+NgCHShjkCb+IFBLq9buZwE1xckQU4peSuQ==\n+  dependencies:\n+    ansi-styles \"^3.2.1\"\n+    escape-string-regexp \"^1.0.5\"\n+    supports-color \"^5.3.0\"\n+\n chardet@^0.4.0:\n   version \"0.4.2\"\n   resolved \"https://registry.yarnpkg.com/chardet/-/chardet-0.4.2.tgz#b5473b33dc97c424e5d98dc87d55d4d8a29c8bf2\"\n@@ -1423,6 +1439,11 @@ get-caller-file@^1.0.1:\n   version \"1.0.3\"\n   resolved \"https://registry.yarnpkg.com/get-caller-file/-/get-caller-file-1.0.3.tgz#f978fa4c90d1dfe7ff2d6beda2a515e713bdcf4a\"\n \n+get-own-enumerable-property-symbols@^3.0.0:\n+  version \"3.0.2\"\n+  resolved \"https://registry.yarnpkg.com/get-own-enumerable-property-symbols/-/get-own-enumerable-property-symbols-3.0.2.tgz#b5fde77f22cbe35f390b4e089922c50bce6ef664\"\n+  integrity sha512-I0UBV/XOz1XkIJHEUDMZAbzCThU/H8DxmSfmdGcKPnVhu2VfFqr34jr9777IyaTYvxjedWhqVIilEDsCdP5G6g==\n+\n get-port@^3.1.0:\n   version \"3.2.0\"\n   resolved \"https://registry.yarnpkg.com/get-port/-/get-port-3.2.0.tgz#dd7ce7de187c06c8bf353796ac71e099f0980ebc\"\n@@ -1606,6 +1627,18 @@ gulp-concat@^2.6.1:\n     through2 \"^2.0.0\"\n     vinyl \"^2.0.0\"\n \n+gulp-debug@^4.0.0:\n+  version \"4.0.0\"\n+  resolved \"https://registry.yarnpkg.com/gulp-debug/-/gulp-debug-4.0.0.tgz#036f9539c3fb6af720e01a9ea5c195fc73f29d5b\"\n+  integrity sha512-cn/GhMD2nVZCVxAl5vWao4/dcoZ8wUJ8w3oqTvQaGDmC1vT7swNOEbhQTWJp+/otKePT64aENcqAQXDcdj5H1g==\n+  dependencies:\n+    chalk \"^2.3.0\"\n+    fancy-log \"^1.3.2\"\n+    plur \"^3.0.0\"\n+    stringify-object \"^3.0.0\"\n+    through2 \"^2.0.0\"\n+    tildify \"^1.1.2\"\n+\n gulp-gzip@^1.4.2:\n   version \"1.4.2\"\n   resolved \"https://registry.yarnpkg.com/gulp-gzip/-/gulp-gzip-1.4.2.tgz#0422a94014248655b5b1a9eea1c2abee1d4f4337\"\n@@ -1969,6 +2002,11 @@ invert-kv@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/invert-kv/-/invert-kv-1.0.0.tgz#104a8e4aaca6d3d8cd157a8ef8bfab2d7a3ffdb6\"\n \n+irregular-plurals@^2.0.0:\n+  version \"2.0.0\"\n+  resolved \"https://registry.yarnpkg.com/irregular-plurals/-/irregular-plurals-2.0.0.tgz#39d40f05b00f656d0b7fa471230dd3b714af2872\"\n+  integrity sha512-Y75zBYLkh0lJ9qxeHlMjQ7bSbyiSqNW/UOPWDmzC7cXskL1hekSITh1Oc6JV0XCWWZ9DE8VYSB71xocLk3gmGw==\n+\n is-absolute@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/is-absolute/-/is-absolute-1.0.0.tgz#395e1ae84b11f26ad1795e73c17378e48a301576\"\n@@ -2080,6 +2118,11 @@ is-number@^4.0.0:\n   version \"4.0.0\"\n   resolved \"https://registry.yarnpkg.com/is-number/-/is-number-4.0.0.tgz#0026e37f5454d73e356dfe6564699867c6a7f0ff\"\n \n+is-obj@^1.0.1:\n+  version \"1.0.1\"\n+  resolved \"https://registry.yarnpkg.com/is-obj/-/is-obj-1.0.1.tgz#3e4729ac1f5fde025cd7d83a896dab9f4f67db0f\"\n+  integrity sha1-PkcprB9f3gJc19g6iW2rn09n2w8=\n+\n is-path-cwd@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/is-path-cwd/-/is-path-cwd-1.0.0.tgz#d225ec23132e89edd38fda767472e62e65f1106d\"\n@@ -2106,6 +2149,11 @@ is-promise@^2.1.0:\n   version \"2.1.0\"\n   resolved \"https://registry.yarnpkg.com/is-promise/-/is-promise-2.1.0.tgz#79a2a9ece7f096e80f36d2b2f3bc16c1ff4bf3fa\"\n \n+is-regexp@^1.0.0:\n+  version \"1.0.0\"\n+  resolved \"https://registry.yarnpkg.com/is-regexp/-/is-regexp-1.0.0.tgz#fd2d883545c46bac5a633e7b9a09e87fa2cb5069\"\n+  integrity sha1-/S2INUXEa6xaYz57mgnof6LLUGk=\n+\n is-relative@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/is-relative/-/is-relative-1.0.0.tgz#a1bb6935ce8c5dba1e8b9754b9b2dcc020e2260d\"\n@@ -3096,6 +3144,13 @@ plugin-error@^0.1.2:\n     arr-union \"^2.0.1\"\n     extend-shallow \"^1.1.2\"\n \n+plur@^3.0.0:\n+  version \"3.1.1\"\n+  resolved \"https://registry.yarnpkg.com/plur/-/plur-3.1.1.tgz#60267967866a8d811504fe58f2faaba237546a5b\"\n+  integrity sha512-t1Ax8KUvV3FFII8ltczPn2tJdjqbd1sIzu6t4JL7nQ3EyeL/lTrj5PWKb06ic5/6XYDr65rQ4uzQEGN70/6X5w==\n+  dependencies:\n+    irregular-plurals \"^2.0.0\"\n+\n portfinder@^1.0.13:\n   version \"1.0.13\"\n   resolved \"https://registry.yarnpkg.com/portfinder/-/portfinder-1.0.13.tgz#bb32ecd87c27104ae6ee44b5a3ccbf0ebb1aede9\"\n@@ -3930,6 +3985,15 @@ string_decoder@~1.1.1:\n   dependencies:\n     safe-buffer \"~5.1.0\"\n \n+stringify-object@^3.0.0:\n+  version \"3.3.0\"\n+  resolved \"https://registry.yarnpkg.com/stringify-object/-/stringify-object-3.3.0.tgz#703065aefca19300d3ce88af4f5b3956d7556629\"\n+  integrity sha512-rHqiFh1elqCQ9WPLIC8I0Q/g/wj5J1eMkyoiD6eoQApWHP0FtlK7rqnhmabL5VUY9JQCcqwwvlOaSuutekgyrw==\n+  dependencies:\n+    get-own-enumerable-property-symbols \"^3.0.0\"\n+    is-obj \"^1.0.1\"\n+    is-regexp \"^1.0.0\"\n+\n strip-ansi@^3.0.0, strip-ansi@^3.0.1:\n   version \"3.0.1\"\n   resolved \"https://registry.yarnpkg.com/strip-ansi/-/strip-ansi-3.0.1.tgz#6a385fb8853d952d5ff05d0e8aaf94278dc63dcf\"\n@@ -3982,6 +4046,13 @@ supports-color@^4.0.0:\n   dependencies:\n     has-flag \"^2.0.0\"\n \n+supports-color@^5.3.0:\n+  version \"5.5.0\"\n+  resolved \"https://registry.yarnpkg.com/supports-color/-/supports-color-5.5.0.tgz#e2e69a44ac8772f78a1ec0b35b689df6530efc8f\"\n+  integrity sha512-QjVjwdXIt408MIiAqCX4oUKsgU2EqAGzs2Ppkm4aQYbjm+ZEWEcW4SfFNTr4uMNZma0ey4f5lgLrkB0aX0QMow==\n+  dependencies:\n+    has-flag \"^3.0.0\"\n+\n supports-color@~5.0.0:\n   version \"5.0.1\"\n   resolved \"https://registry.yarnpkg.com/supports-color/-/supports-color-5.0.1.tgz#1c5331f22250c84202805b2f17adf16699f3a39a\"\n@@ -4099,6 +4170,13 @@ through@^2.3.6:\n   version \"2.3.8\"\n   resolved \"https://registry.yarnpkg.com/through/-/through-2.3.8.tgz#0dd4c9ffaabc357960b1b724115d7e0e86a2e1f5\"\n \n+tildify@^1.1.2:\n+  version \"1.2.0\"\n+  resolved \"https://registry.yarnpkg.com/tildify/-/tildify-1.2.0.tgz#dcec03f55dca9b7aa3e5b04f21817eb56e63588a\"\n+  integrity sha1-3OwD9V3Km3qj5bBPIYF+tW5jWIo=\n+  dependencies:\n+    os-homedir \"^1.0.0\"\n+\n time-stamp@^1.0.0:\n   version \"1.1.0\"\n   resolved \"https://registry.yarnpkg.com/time-stamp/-/time-stamp-1.1.0.tgz#764a5a11af50561921b133f3b44e618687e0f5c3\""
    }
  ]
}
