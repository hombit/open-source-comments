{
  "sha": "e19459185a55c237c361a9d4704005dc5351d94f",
  "node_id": "MDY6Q29tbWl0NzU2OTU3ODplMTk0NTkxODVhNTVjMjM3YzM2MWE5ZDQ3MDQwMDVkYzUzNTFkOTRm",
  "commit": {
    "author": {
      "name": "Joffrey JAFFEUX",
      "email": "j.jaffeux@gmail.com",
      "date": "2020-01-29T16:19:12Z"
    },
    "committer": {
      "name": "GitHub",
      "email": "noreply@github.com",
      "date": "2020-01-29T16:19:12Z"
    },
    "message": "DEV: new widget hooks mousemove/mouseup/mousedown/doubleclick (#8807)",
    "tree": {
      "sha": "8abe35f5b75f3221086e803b9f54196e268fb25d",
      "url": "https://api.github.com/repos/discourse/discourse/git/trees/8abe35f5b75f3221086e803b9f54196e268fb25d"
    },
    "url": "https://api.github.com/repos/discourse/discourse/git/commits/e19459185a55c237c361a9d4704005dc5351d94f",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJeMbCACRBK7hj4Ov3rIwAAdHIIAIQgUKmlxWxjdQIUGU4yf3Ro\nFRbvqKWSIcFvQGOPXuYo+3fAxO5oCjwYmKdSRqxVpMvskhq9eXipzmOaXpayweOr\nvYOtPJaSxIZhAHapaz/OQZaIshd8TWDECbuzpQ5ShuEQQhDIX4Oy0cUyKIfw5cgM\n8XYEjiBIa7mhTxR4QGyvY+rzcLqpKXjXk54Rv3fgN9wZhTeOnVzf4QzQFC9tI8Ne\nFs1Uhn+BU0RVB+9GnIAYXjonI5NE0XIdXSOrGmWG44hLu9L0lozoeZMF+RRIZTEX\nUIeP6g651HyoAIdBykclouiQXlyJSKjsD6TboPT7Zhm7Afjz0mmMnF9UkHiz1Gk=\n=AtJ3\n-----END PGP SIGNATURE-----\n",
      "payload": "tree 8abe35f5b75f3221086e803b9f54196e268fb25d\nparent e29fef9e99376c60275c3cf3041dd713c3eb0a00\nauthor Joffrey JAFFEUX <j.jaffeux@gmail.com> 1580314752 +0100\ncommitter GitHub <noreply@github.com> 1580314752 +0100\n\nDEV: new widget hooks mousemove/mouseup/mousedown/doubleclick (#8807)\n\n"
    }
  },
  "url": "https://api.github.com/repos/discourse/discourse/commits/e19459185a55c237c361a9d4704005dc5351d94f",
  "html_url": "https://github.com/discourse/discourse/commit/e19459185a55c237c361a9d4704005dc5351d94f",
  "comments_url": "https://api.github.com/repos/discourse/discourse/commits/e19459185a55c237c361a9d4704005dc5351d94f/comments",
  "author": {
    "login": "jjaffeux",
    "id": 339945,
    "node_id": "MDQ6VXNlcjMzOTk0NQ==",
    "avatar_url": "https://avatars3.githubusercontent.com/u/339945?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jjaffeux",
    "html_url": "https://github.com/jjaffeux",
    "followers_url": "https://api.github.com/users/jjaffeux/followers",
    "following_url": "https://api.github.com/users/jjaffeux/following{/other_user}",
    "gists_url": "https://api.github.com/users/jjaffeux/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jjaffeux/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jjaffeux/subscriptions",
    "organizations_url": "https://api.github.com/users/jjaffeux/orgs",
    "repos_url": "https://api.github.com/users/jjaffeux/repos",
    "events_url": "https://api.github.com/users/jjaffeux/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jjaffeux/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "web-flow",
    "id": 19864447,
    "node_id": "MDQ6VXNlcjE5ODY0NDQ3",
    "avatar_url": "https://avatars3.githubusercontent.com/u/19864447?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/web-flow",
    "html_url": "https://github.com/web-flow",
    "followers_url": "https://api.github.com/users/web-flow/followers",
    "following_url": "https://api.github.com/users/web-flow/following{/other_user}",
    "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions",
    "organizations_url": "https://api.github.com/users/web-flow/orgs",
    "repos_url": "https://api.github.com/users/web-flow/repos",
    "events_url": "https://api.github.com/users/web-flow/events{/privacy}",
    "received_events_url": "https://api.github.com/users/web-flow/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "e29fef9e99376c60275c3cf3041dd713c3eb0a00",
      "url": "https://api.github.com/repos/discourse/discourse/commits/e29fef9e99376c60275c3cf3041dd713c3eb0a00",
      "html_url": "https://github.com/discourse/discourse/commit/e29fef9e99376c60275c3cf3041dd713c3eb0a00"
    }
  ],
  "stats": {
    "total": 47,
    "additions": 46,
    "deletions": 1
  },
  "files": [
    {
      "sha": "0d1dcd4b9f22ce7b2e6474ab726e51c23bcbd8e2",
      "filename": "app/assets/javascripts/discourse/widgets/hooks.js.es6",
      "status": "modified",
      "additions": 26,
      "deletions": 0,
      "changes": 26,
      "blob_url": "https://github.com/discourse/discourse/blob/e19459185a55c237c361a9d4704005dc5351d94f/app/assets/javascripts/discourse/widgets/hooks.js.es6",
      "raw_url": "https://github.com/discourse/discourse/raw/e19459185a55c237c361a9d4704005dc5351d94f/app/assets/javascripts/discourse/widgets/hooks.js.es6",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/app/assets/javascripts/discourse/widgets/hooks.js.es6?ref=e19459185a55c237c361a9d4704005dc5351d94f",
      "patch": "@@ -1,6 +1,7 @@\n /*eslint no-loop-func:0*/\n \n const CLICK_ATTRIBUTE_NAME = \"_discourse_click_widget\";\n+const DOUBLE_CLICK_ATTRIBUTE_NAME = \"_discourse_double_click_widget\";\n const CLICK_OUTSIDE_ATTRIBUTE_NAME = \"_discourse_click_outside_widget\";\n const MOUSE_DOWN_OUTSIDE_ATTRIBUTE_NAME =\n   \"_discourse_mouse_down_outside_widget\";\n@@ -9,6 +10,9 @@ const KEY_DOWN_ATTRIBUTE_NAME = \"_discourse_key_down_widget\";\n const DRAG_ATTRIBUTE_NAME = \"_discourse_drag_widget\";\n const INPUT_ATTRIBUTE_NAME = \"_discourse_input_widget\";\n const CHANGE_ATTRIBUTE_NAME = \"_discourse_change_widget\";\n+const MOUSE_DOWN_ATTRIBUTE_NAME = \"_discourse_mouse_down_widget\";\n+const MOUSE_UP_ATTRIBUTE_NAME = \"_discourse_mouse_up_widget\";\n+const MOUSE_MOVE_ATTRIBUTE_NAME = \"_discourse_mouse_move_widget\";\n \n function buildHook(attributeName, setAttr) {\n   return class {\n@@ -33,6 +37,7 @@ function buildHook(attributeName, setAttr) {\n }\n \n export const WidgetClickHook = buildHook(CLICK_ATTRIBUTE_NAME);\n+export const WidgetDoubleClickHook = buildHook(DOUBLE_CLICK_ATTRIBUTE_NAME);\n export const WidgetClickOutsideHook = buildHook(\n   CLICK_OUTSIDE_ATTRIBUTE_NAME,\n   \"data-click-outside\"\n@@ -46,6 +51,9 @@ export const WidgetKeyDownHook = buildHook(KEY_DOWN_ATTRIBUTE_NAME);\n export const WidgetDragHook = buildHook(DRAG_ATTRIBUTE_NAME);\n export const WidgetInputHook = buildHook(INPUT_ATTRIBUTE_NAME);\n export const WidgetChangeHook = buildHook(CHANGE_ATTRIBUTE_NAME);\n+export const WidgetMouseUpHook = buildHook(MOUSE_UP_ATTRIBUTE_NAME);\n+export const WidgetMouseDownHook = buildHook(MOUSE_DOWN_ATTRIBUTE_NAME);\n+export const WidgetMouseMoveHook = buildHook(MOUSE_MOVE_ATTRIBUTE_NAME);\n \n function nodeCallback(node, attrName, cb, options = { rerender: true }) {\n   const { rerender } = options;\n@@ -136,6 +144,10 @@ WidgetClickHook.setupDocumentCallback = function() {\n     }\n   );\n \n+  $(document).on(\"dblclick.discourse-widget\", e => {\n+    nodeCallback(e.target, DOUBLE_CLICK_ATTRIBUTE_NAME, w => w.doubleClick(e));\n+  });\n+\n   $(document).on(\"click.discourse-widget\", e => {\n     nodeCallback(e.target, CLICK_ATTRIBUTE_NAME, w => w.click(e));\n \n@@ -190,5 +202,19 @@ WidgetClickHook.setupDocumentCallback = function() {\n     });\n   });\n \n+  $(document).on(\"mousedown.discourse-widget\", e => {\n+    nodeCallback(e.target, MOUSE_DOWN_ATTRIBUTE_NAME, w => {\n+      w.mouseDown(e);\n+    });\n+  });\n+\n+  $(document).on(\"mouseup.discourse-widget\", e => {\n+    nodeCallback(e.target, MOUSE_UP_ATTRIBUTE_NAME, w => w.mouseUp(e));\n+  });\n+\n+  $(document).on(\"mousemove.discourse-widget\", e => {\n+    nodeCallback(e.target, MOUSE_MOVE_ATTRIBUTE_NAME, w => w.mouseMove(e));\n+  });\n+\n   _watchingDocument = true;\n };"
    },
    {
      "sha": "dd30201007c294b933b5a5ab0174ff706b8b40af",
      "filename": "app/assets/javascripts/discourse/widgets/widget.js.es6",
      "status": "modified",
      "additions": 20,
      "deletions": 1,
      "changes": 21,
      "blob_url": "https://github.com/discourse/discourse/blob/e19459185a55c237c361a9d4704005dc5351d94f/app/assets/javascripts/discourse/widgets/widget.js.es6",
      "raw_url": "https://github.com/discourse/discourse/raw/e19459185a55c237c361a9d4704005dc5351d94f/app/assets/javascripts/discourse/widgets/widget.js.es6",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/app/assets/javascripts/discourse/widgets/widget.js.es6?ref=e19459185a55c237c361a9d4704005dc5351d94f",
      "patch": "@@ -1,12 +1,16 @@\n import {\n   WidgetClickHook,\n+  WidgetDoubleClickHook,\n   WidgetClickOutsideHook,\n   WidgetKeyUpHook,\n   WidgetKeyDownHook,\n   WidgetMouseDownOutsideHook,\n   WidgetDragHook,\n   WidgetInputHook,\n-  WidgetChangeHook\n+  WidgetChangeHook,\n+  WidgetMouseUpHook,\n+  WidgetMouseDownHook,\n+  WidgetMouseMoveHook\n } from \"discourse/widgets/hooks\";\n import { h } from \"virtual-dom\";\n import DecoratorHelper from \"discourse/widgets/decorator-helper\";\n@@ -371,6 +375,9 @@ export default class Widget {\n     if (this.click) {\n       properties[\"widget-click\"] = new WidgetClickHook(this);\n     }\n+    if (this.doubleClick) {\n+      properties[\"widget-double-click\"] = new WidgetDoubleClickHook(this);\n+    }\n \n     if (this.mouseDownOutside) {\n       properties[\"widget-mouse-down-outside\"] = new WidgetMouseDownOutsideHook(\n@@ -390,6 +397,18 @@ export default class Widget {\n       properties[\"widget-change\"] = new WidgetChangeHook(this);\n     }\n \n+    if (this.mouseDown) {\n+      properties[\"widget-mouse-down\"] = new WidgetMouseDownHook(this);\n+    }\n+\n+    if (this.mouseUp) {\n+      properties[\"widget-mouse-up\"] = new WidgetMouseUpHook(this);\n+    }\n+\n+    if (this.mouseMove) {\n+      properties[\"widget-mouse-move\"] = new WidgetMouseMoveHook(this);\n+    }\n+\n     const attributes = properties[\"attributes\"] || {};\n     properties.attributes = attributes;\n "
    }
  ]
}
