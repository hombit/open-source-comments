{
  "sha": "3014017976faf95454b12444b833df4d8691fa0c",
  "node_id": "MDY6Q29tbWl0NzI0NTQyNDI6MzAxNDAxNzk3NmZhZjk1NDU0YjEyNDQ0YjgzM2RmNGQ4NjkxZmEwYw==",
  "commit": {
    "author": {
      "name": "Hector Nieva",
      "email": "hectornmelo@gmail.com",
      "date": "2020-02-08T00:28:08Z"
    },
    "committer": {
      "name": "GitHub",
      "email": "noreply@github.com",
      "date": "2020-02-08T00:28:08Z"
    },
    "message": "Fix regexp mathing of banned word list by exchanging .test() with .match() (#2828)\n\n* [Fix] Use .match instead of .test to avoid false positives when matching regex returned groups\r\n\r\n* Add test to assure memoized regexp for banned words will match properly\r\n\r\n* fix: fixes bug with wordlist matching\r\n\r\nCo-authored-by: Wyatt Johnson <accounts+github@wyattjoh.ca>",
    "tree": {
      "sha": "f71a01f6165b6f87e614a7b501dc166cfef039a1",
      "url": "https://api.github.com/repos/coralproject/talk/git/trees/f71a01f6165b6f87e614a7b501dc166cfef039a1"
    },
    "url": "https://api.github.com/repos/coralproject/talk/git/commits/3014017976faf95454b12444b833df4d8691fa0c",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJePgCYCRBK7hj4Ov3rIwAAdHIIAEX4cwvZCNCuarQL0djzhk27\nyzltU3DCZcaCzcy3iW3bSi6GD1xhsFR43GkbskY9tWpL90IyDXsBj7d6E+cuKQfw\ngUEK5w2EuqPMJnvKBHwu40Yy2lpEW3uJoIdTi1EpwlwXDxiJSBz0y1I3nrnzUOAn\n2AynzpmOkWmQWwk0xL31i4YfUJ83q4rWSE7eizB6rjqxos3XxFK6VLbqIeH52Su9\njTu3QT/kMxjOoz5HB42qb1guefaK1xjLs7A/5Io/z2df3O3McctzDH0+m3H6BreC\nuqYt4OeE7NJ1VU/BVY09Z74voH3nZTbStBYbkc/ruCs6aHdMdGLFxpfhautVOHU=\n=eIyP\n-----END PGP SIGNATURE-----\n",
      "payload": "tree f71a01f6165b6f87e614a7b501dc166cfef039a1\nparent 1388e0bc5ede783b456f2bf3ed08fdf3a545521b\nauthor Hector Nieva <hectornmelo@gmail.com> 1581121688 -0300\ncommitter GitHub <noreply@github.com> 1581121688 +0000\n\nFix regexp mathing of banned word list by exchanging .test() with .match() (#2828)\n\n* [Fix] Use .match instead of .test to avoid false positives when matching regex returned groups\r\n\r\n* Add test to assure memoized regexp for banned words will match properly\r\n\r\n* fix: fixes bug with wordlist matching\r\n\r\nCo-authored-by: Wyatt Johnson <accounts+github@wyattjoh.ca>\r\n"
    }
  },
  "url": "https://api.github.com/repos/coralproject/talk/commits/3014017976faf95454b12444b833df4d8691fa0c",
  "html_url": "https://github.com/coralproject/talk/commit/3014017976faf95454b12444b833df4d8691fa0c",
  "comments_url": "https://api.github.com/repos/coralproject/talk/commits/3014017976faf95454b12444b833df4d8691fa0c/comments",
  "author": {
    "login": "HectorNM",
    "id": 5360796,
    "node_id": "MDQ6VXNlcjUzNjA3OTY=",
    "avatar_url": "https://avatars2.githubusercontent.com/u/5360796?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/HectorNM",
    "html_url": "https://github.com/HectorNM",
    "followers_url": "https://api.github.com/users/HectorNM/followers",
    "following_url": "https://api.github.com/users/HectorNM/following{/other_user}",
    "gists_url": "https://api.github.com/users/HectorNM/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/HectorNM/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/HectorNM/subscriptions",
    "organizations_url": "https://api.github.com/users/HectorNM/orgs",
    "repos_url": "https://api.github.com/users/HectorNM/repos",
    "events_url": "https://api.github.com/users/HectorNM/events{/privacy}",
    "received_events_url": "https://api.github.com/users/HectorNM/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "web-flow",
    "id": 19864447,
    "node_id": "MDQ6VXNlcjE5ODY0NDQ3",
    "avatar_url": "https://avatars3.githubusercontent.com/u/19864447?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/web-flow",
    "html_url": "https://github.com/web-flow",
    "followers_url": "https://api.github.com/users/web-flow/followers",
    "following_url": "https://api.github.com/users/web-flow/following{/other_user}",
    "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions",
    "organizations_url": "https://api.github.com/users/web-flow/orgs",
    "repos_url": "https://api.github.com/users/web-flow/repos",
    "events_url": "https://api.github.com/users/web-flow/events{/privacy}",
    "received_events_url": "https://api.github.com/users/web-flow/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "1388e0bc5ede783b456f2bf3ed08fdf3a545521b",
      "url": "https://api.github.com/repos/coralproject/talk/commits/1388e0bc5ede783b456f2bf3ed08fdf3a545521b",
      "html_url": "https://github.com/coralproject/talk/commit/1388e0bc5ede783b456f2bf3ed08fdf3a545521b"
    }
  ],
  "stats": {
    "total": 24,
    "additions": 22,
    "deletions": 2
  },
  "files": [
    {
      "sha": "967e6d1eed72691f6714457c332d5b9fd66454f6",
      "filename": "src/core/server/services/comments/pipeline/wordList.spec.ts",
      "status": "modified",
      "additions": 21,
      "deletions": 1,
      "changes": 22,
      "blob_url": "https://github.com/coralproject/talk/blob/3014017976faf95454b12444b833df4d8691fa0c/src/core/server/services/comments/pipeline/wordList.spec.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/3014017976faf95454b12444b833df4d8691fa0c/src/core/server/services/comments/pipeline/wordList.spec.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/server/services/comments/pipeline/wordList.spec.ts?ref=3014017976faf95454b12444b833df4d8691fa0c",
      "patch": "@@ -1,4 +1,7 @@\n-import { containsMatchingPhrase } from \"coral-server/services/comments/pipeline/wordList\";\n+import {\n+  containsMatchingPhrase,\n+  containsMatchingPhraseMemoized,\n+} from \"coral-server/services/comments/pipeline/wordList\";\n \n const phrases = [\n   \"cookies\",\n@@ -44,3 +47,20 @@ describe(\"containsMatchingPhrase\", () => {\n     expect(containsMatchingPhrase([], \"test\")).toEqual(false);\n   });\n });\n+\n+describe(\"containsMatchingPhraseMemoized\", () => {\n+  it(\"return true for all cases after memoizing the first result\", () => {\n+    [\n+      \"cookies 1\",\n+      \"cookies 2\",\n+      \"cookies 4\",\n+      \"cookies 5\",\n+      \"this is for cookies 6\",\n+      \"this is for cookies 7\",\n+      \"this is for cookies 8\",\n+      \"this is for cookies 9\",\n+    ].forEach(word => {\n+      expect(containsMatchingPhraseMemoized(phrases, word)).toEqual(true);\n+    });\n+  });\n+});"
    },
    {
      "sha": "2ad61869b4fb22bd3fa664a822945eab3393343d",
      "filename": "src/core/server/services/comments/pipeline/wordList.ts",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/coralproject/talk/blob/3014017976faf95454b12444b833df4d8691fa0c/src/core/server/services/comments/pipeline/wordList.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/3014017976faf95454b12444b833df4d8691fa0c/src/core/server/services/comments/pipeline/wordList.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/server/services/comments/pipeline/wordList.ts?ref=3014017976faf95454b12444b833df4d8691fa0c",
      "patch": "@@ -22,7 +22,7 @@ export function generateRegExp(phrases: string[]) {\n         .join('[\\\\s\"?!.]+')\n     )\n     .join(\"|\");\n-  return new RegExp(`(^|[^\\\\w])(${inner})(?=[^\\\\w]|$)`, \"gmiu\");\n+  return new RegExp(`(^|[^\\\\w])(${inner})(?=[^\\\\w]|$)`, \"miu\");\n }\n \n export const generateRegExpMemoized = memoize(generateRegExp);"
    }
  ]
}
