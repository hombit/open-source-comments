{
  "sha": "2db8ada22233419fd57a1f7a1cab076fa9762227",
  "node_id": "MDY6Q29tbWl0NzU2OTU3ODoyZGI4YWRhMjIyMzM0MTlmZDU3YTFmN2ExY2FiMDc2ZmE5NzYyMjI3",
  "commit": {
    "author": {
      "name": "Joffrey JAFFEUX",
      "email": "j.jaffeux@gmail.com",
      "date": "2020-02-28T16:58:22Z"
    },
    "committer": {
      "name": "GitHub",
      "email": "noreply@github.com",
      "date": "2020-02-28T16:58:22Z"
    },
    "message": "FIX: ensures category url of category drop is built using slug and id (#9069)",
    "tree": {
      "sha": "4a9bddfb5ee97f5a66b5edc411682b8266ce344b",
      "url": "https://api.github.com/repos/discourse/discourse/git/trees/4a9bddfb5ee97f5a66b5edc411682b8266ce344b"
    },
    "url": "https://api.github.com/repos/discourse/discourse/git/commits/2db8ada22233419fd57a1f7a1cab076fa9762227",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJeWUauCRBK7hj4Ov3rIwAAdHIIABLexJLYDw5Dh4NRZk/O8Sbv\nd745LbNK83NV5SRXM3TrDFzHapYL8fIEGJc7rIUNpLd4gijpP0YQXWc/DodVA7uS\nNHWvrknCLv3JaoGZiX+stk19IkKCjFnkKOA6QLWPi41s728hm5wF3deuRINTMxgs\nXvK54UGZbplvapEw4n4mJ1zL83qQqb70zY3KQAsGkdCK/WciOPjEa7/PAU7ZJKTX\noOdYMlxg5gohd0BPDb2JhpWKJaPRR74K+IcGURLw8d6qjkR0hpwbqIdcyFMnGS39\nrWLHdhrhkgVLIHhzNBhPhuUekRoSqKlDbhHYy/vpCwGafJNzcD1CWnmO3eE7BrI=\n=0cMG\n-----END PGP SIGNATURE-----\n",
      "payload": "tree 4a9bddfb5ee97f5a66b5edc411682b8266ce344b\nparent ff5ff8d0d27bd8482171399ece41182a8072fc33\nauthor Joffrey JAFFEUX <j.jaffeux@gmail.com> 1582909102 +0100\ncommitter GitHub <noreply@github.com> 1582909102 +0100\n\nFIX: ensures category url of category drop is built using slug and id (#9069)\n\n"
    }
  },
  "url": "https://api.github.com/repos/discourse/discourse/commits/2db8ada22233419fd57a1f7a1cab076fa9762227",
  "html_url": "https://github.com/discourse/discourse/commit/2db8ada22233419fd57a1f7a1cab076fa9762227",
  "comments_url": "https://api.github.com/repos/discourse/discourse/commits/2db8ada22233419fd57a1f7a1cab076fa9762227/comments",
  "author": {
    "login": "jjaffeux",
    "id": 339945,
    "node_id": "MDQ6VXNlcjMzOTk0NQ==",
    "avatar_url": "https://avatars3.githubusercontent.com/u/339945?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jjaffeux",
    "html_url": "https://github.com/jjaffeux",
    "followers_url": "https://api.github.com/users/jjaffeux/followers",
    "following_url": "https://api.github.com/users/jjaffeux/following{/other_user}",
    "gists_url": "https://api.github.com/users/jjaffeux/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jjaffeux/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jjaffeux/subscriptions",
    "organizations_url": "https://api.github.com/users/jjaffeux/orgs",
    "repos_url": "https://api.github.com/users/jjaffeux/repos",
    "events_url": "https://api.github.com/users/jjaffeux/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jjaffeux/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "web-flow",
    "id": 19864447,
    "node_id": "MDQ6VXNlcjE5ODY0NDQ3",
    "avatar_url": "https://avatars3.githubusercontent.com/u/19864447?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/web-flow",
    "html_url": "https://github.com/web-flow",
    "followers_url": "https://api.github.com/users/web-flow/followers",
    "following_url": "https://api.github.com/users/web-flow/following{/other_user}",
    "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions",
    "organizations_url": "https://api.github.com/users/web-flow/orgs",
    "repos_url": "https://api.github.com/users/web-flow/repos",
    "events_url": "https://api.github.com/users/web-flow/events{/privacy}",
    "received_events_url": "https://api.github.com/users/web-flow/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "ff5ff8d0d27bd8482171399ece41182a8072fc33",
      "url": "https://api.github.com/repos/discourse/discourse/commits/ff5ff8d0d27bd8482171399ece41182a8072fc33",
      "html_url": "https://github.com/discourse/discourse/commit/ff5ff8d0d27bd8482171399ece41182a8072fc33"
    }
  ],
  "stats": {
    "total": 32,
    "additions": 25,
    "deletions": 7
  },
  "files": [
    {
      "sha": "5ee9a6d12b9e6c6e4824d796a8781b3d5291a5b2",
      "filename": "app/assets/javascripts/select-kit/components/category-drop.js.es6",
      "status": "modified",
      "additions": 5,
      "deletions": 7,
      "changes": 12,
      "blob_url": "https://github.com/discourse/discourse/blob/2db8ada22233419fd57a1f7a1cab076fa9762227/app/assets/javascripts/select-kit/components/category-drop.js.es6",
      "raw_url": "https://github.com/discourse/discourse/raw/2db8ada22233419fd57a1f7a1cab076fa9762227/app/assets/javascripts/select-kit/components/category-drop.js.es6",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/app/assets/javascripts/select-kit/components/category-drop.js.es6?ref=2db8ada22233419fd57a1f7a1cab076fa9762227",
      "patch": "@@ -155,18 +155,16 @@ export default ComboBoxComponent.extend({\n   },\n \n   actions: {\n-    onChange(value) {\n+    onChange(categoryId) {\n       let categoryURL;\n \n-      if (value === ALL_CATEGORIES_ID) {\n+      if (categoryId === ALL_CATEGORIES_ID) {\n         categoryURL = this.allCategoriesUrl;\n-      } else if (value === NO_CATEGORIES_ID) {\n+      } else if (categoryId === NO_CATEGORIES_ID) {\n         categoryURL = this.noCategoriesUrl;\n       } else {\n-        const categoryId = parseInt(value, 10);\n-        const category = Category.findById(categoryId);\n-        const slug = Discourse.Category.slugFor(category);\n-        categoryURL = `/c/${slug}`;\n+        const category = Category.findById(parseInt(categoryId, 10));\n+        categoryURL = category.url;\n       }\n \n       DiscourseURL.routeToUrl(categoryURL);"
    },
    {
      "sha": "2a3b7b6e5626f5bb62873b7490377f7a46201ad2",
      "filename": "test/javascripts/components/select-kit/category-drop-test.js.es6",
      "status": "modified",
      "additions": 20,
      "deletions": 0,
      "changes": 20,
      "blob_url": "https://github.com/discourse/discourse/blob/2db8ada22233419fd57a1f7a1cab076fa9762227/test/javascripts/components/select-kit/category-drop-test.js.es6",
      "raw_url": "https://github.com/discourse/discourse/raw/2db8ada22233419fd57a1f7a1cab076fa9762227/test/javascripts/components/select-kit/category-drop-test.js.es6",
      "contents_url": "https://api.github.com/repos/discourse/discourse/contents/test/javascripts/components/select-kit/category-drop-test.js.es6?ref=2db8ada22233419fd57a1f7a1cab076fa9762227",
      "patch": "@@ -1,3 +1,4 @@\n+import DiscourseURL from \"discourse/lib/url\";\n import Category from \"discourse/models/category\";\n import componentTest from \"helpers/component-test\";\n import { testSelectKitModule } from \"./select-kit-test-helper\";\n@@ -335,3 +336,22 @@ componentTest(\n     }\n   }\n );\n+\n+componentTest(\"category url\", {\n+  template: template(),\n+\n+  beforeEach() {\n+    initCategoriesWithParentCategory(this);\n+    sandbox.stub(DiscourseURL, \"routeTo\");\n+  },\n+\n+  async test(assert) {\n+    await this.subject.expand();\n+    await this.subject.selectRowByValue(26);\n+\n+    assert.ok(\n+      DiscourseURL.routeTo.calledWith(\"/c/feature/spec/26\"),\n+      \"it builds a correct URL\"\n+    );\n+  }\n+});"
    }
  ]
}
