{
  "sha": "9a58673545e0d720b1719c273746f2a65b38e45c",
  "node_id": "MDY6Q29tbWl0NzI0NTQyNDI6OWE1ODY3MzU0NWUwZDcyMGIxNzE5YzI3Mzc0NmYyYTY1YjM4ZTQ1Yw==",
  "commit": {
    "author": {
      "name": "Nick Funk",
      "email": "nick.funk@outlook.com",
      "date": "2020-03-20T20:59:59Z"
    },
    "committer": {
      "name": "GitHub",
      "email": "noreply@github.com",
      "date": "2020-03-20T20:59:59Z"
    },
    "message": "[CORL-929] SSO Key Rotation (Front-end) (#2877)\n\n* feat: initial impl\r\n\r\n* Create preliminary SSO rotation components\r\n\r\nCORL-929\r\n\r\n* Create rotateSSOKey mutation\r\n\r\nCORL-929\r\n\r\n* Fix sorting by date for SSO keys\r\n\r\nCORL-929\r\n\r\n* Show tool tips beside expiring/expired statuses\r\n\r\nCORL-929\r\n\r\n* Hook up Deactivate and Delete SSO key mutations\r\n\r\nCORL-929\r\n\r\n* Tweak expired tooltip on SSO keys\r\n\r\nCORL-929\r\n\r\n* Replace old SSO key config with key rotation\r\n\r\nCORL-929\r\n\r\n* Fix copy button for SSO key's secret\r\n\r\nCORL-929\r\n\r\n* Refactor SSOKeyCard func's into components\r\n\r\nAll the func's building the sub-components\r\nwere prime targets for component's with props.\r\n\r\nCORL-929\r\n\r\n* Update tests to match SSO Key rotation\r\n\r\nCORL-929\r\n\r\n* Fix typo in translation id\r\n\r\nCORL-929\r\n\r\n* Test key rotation\r\n\r\nCORL-929\r\n\r\n* Plumb disabled through SSO key rotation\r\n\r\nCORL-929\r\n\r\n* Remove duplicate input/payload pairs from schema\r\n\r\nFor some reason it perfectly duplicated the\r\ninput/payload pairs for SSO key rotation on\r\nrebase.\r\n\r\nCORL-929\r\n\r\n* Remove debug logging\r\n\r\nCORL-929\r\n\r\n* Use switch instead of if's to compute SSO date field\r\n\r\nCORL-929\r\n\r\n* Use switch to compute SSO action button state\r\n\r\nCORL-929\r\n\r\n* Use switch to compute SSO StatusField state\r\n\r\nCORL-929\r\n\r\n* Remove 10 second key rotation option\r\n\r\nCORL-929\r\n\r\n* Use memo in sorting SSO keys\r\n\r\nCORL-929\r\n\r\nCo-authored-by: Wyatt Johnson <wyattjoh@gmail.com>",
    "tree": {
      "sha": "df8cd7c575b72c7073131ec4b00bbcb924609942",
      "url": "https://api.github.com/repos/coralproject/talk/git/trees/df8cd7c575b72c7073131ec4b00bbcb924609942"
    },
    "url": "https://api.github.com/repos/coralproject/talk/git/commits/9a58673545e0d720b1719c273746f2a65b38e45c",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJedS7PCRBK7hj4Ov3rIwAAdHIIAFI8cOnSX7OmIWn53Yz6FmPF\ne+l+P5Q6+9th6XTCpNpfRgs7bbYhNuLZHr6P0uPSUBo1QtHz0h4o4UgoKMAcIp4B\nINPVdCEhgRDujWMQ+oRXoiXBI5cPLxwlCFE350Z+inUqve8Ioi2JlH9LEzDjFVhQ\n3FbDjYHS4Cx9fS1gFdmJL3d/OCKrP/GOmI238jujvmqdaGsHkRHopV/+Igt5EYxO\nQJ2NecVQqS8PT0XgpdxVScV1AMx+yR5Z4N/LHHPlUOm2M/D5IoBm8wxz9iyW3Mbw\ngDCiXr13Zz+1Hq3usm6TOUR2CdB0TrWxedkE9DjgVrmWbnJ7zCQEBSvOKAbBMek=\n=mXjl\n-----END PGP SIGNATURE-----\n",
      "payload": "tree df8cd7c575b72c7073131ec4b00bbcb924609942\nparent 2dc63d3a27e6fe46d358aad347adbdf668fa076b\nauthor Nick Funk <nick.funk@outlook.com> 1584737999 -0600\ncommitter GitHub <noreply@github.com> 1584737999 +0000\n\n[CORL-929] SSO Key Rotation (Front-end) (#2877)\n\n* feat: initial impl\r\n\r\n* Create preliminary SSO rotation components\r\n\r\nCORL-929\r\n\r\n* Create rotateSSOKey mutation\r\n\r\nCORL-929\r\n\r\n* Fix sorting by date for SSO keys\r\n\r\nCORL-929\r\n\r\n* Show tool tips beside expiring/expired statuses\r\n\r\nCORL-929\r\n\r\n* Hook up Deactivate and Delete SSO key mutations\r\n\r\nCORL-929\r\n\r\n* Tweak expired tooltip on SSO keys\r\n\r\nCORL-929\r\n\r\n* Replace old SSO key config with key rotation\r\n\r\nCORL-929\r\n\r\n* Fix copy button for SSO key's secret\r\n\r\nCORL-929\r\n\r\n* Refactor SSOKeyCard func's into components\r\n\r\nAll the func's building the sub-components\r\nwere prime targets for component's with props.\r\n\r\nCORL-929\r\n\r\n* Update tests to match SSO Key rotation\r\n\r\nCORL-929\r\n\r\n* Fix typo in translation id\r\n\r\nCORL-929\r\n\r\n* Test key rotation\r\n\r\nCORL-929\r\n\r\n* Plumb disabled through SSO key rotation\r\n\r\nCORL-929\r\n\r\n* Remove duplicate input/payload pairs from schema\r\n\r\nFor some reason it perfectly duplicated the\r\ninput/payload pairs for SSO key rotation on\r\nrebase.\r\n\r\nCORL-929\r\n\r\n* Remove debug logging\r\n\r\nCORL-929\r\n\r\n* Use switch instead of if's to compute SSO date field\r\n\r\nCORL-929\r\n\r\n* Use switch to compute SSO action button state\r\n\r\nCORL-929\r\n\r\n* Use switch to compute SSO StatusField state\r\n\r\nCORL-929\r\n\r\n* Remove 10 second key rotation option\r\n\r\nCORL-929\r\n\r\n* Use memo in sorting SSO keys\r\n\r\nCORL-929\r\n\r\nCo-authored-by: Wyatt Johnson <wyattjoh@gmail.com>"
    }
  },
  "url": "https://api.github.com/repos/coralproject/talk/commits/9a58673545e0d720b1719c273746f2a65b38e45c",
  "html_url": "https://github.com/coralproject/talk/commit/9a58673545e0d720b1719c273746f2a65b38e45c",
  "comments_url": "https://api.github.com/repos/coralproject/talk/commits/9a58673545e0d720b1719c273746f2a65b38e45c/comments",
  "author": {
    "login": "nick-funk",
    "id": 5751504,
    "node_id": "MDQ6VXNlcjU3NTE1MDQ=",
    "avatar_url": "https://avatars2.githubusercontent.com/u/5751504?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nick-funk",
    "html_url": "https://github.com/nick-funk",
    "followers_url": "https://api.github.com/users/nick-funk/followers",
    "following_url": "https://api.github.com/users/nick-funk/following{/other_user}",
    "gists_url": "https://api.github.com/users/nick-funk/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nick-funk/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nick-funk/subscriptions",
    "organizations_url": "https://api.github.com/users/nick-funk/orgs",
    "repos_url": "https://api.github.com/users/nick-funk/repos",
    "events_url": "https://api.github.com/users/nick-funk/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nick-funk/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "web-flow",
    "id": 19864447,
    "node_id": "MDQ6VXNlcjE5ODY0NDQ3",
    "avatar_url": "https://avatars3.githubusercontent.com/u/19864447?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/web-flow",
    "html_url": "https://github.com/web-flow",
    "followers_url": "https://api.github.com/users/web-flow/followers",
    "following_url": "https://api.github.com/users/web-flow/following{/other_user}",
    "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions",
    "organizations_url": "https://api.github.com/users/web-flow/orgs",
    "repos_url": "https://api.github.com/users/web-flow/repos",
    "events_url": "https://api.github.com/users/web-flow/events{/privacy}",
    "received_events_url": "https://api.github.com/users/web-flow/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "2dc63d3a27e6fe46d358aad347adbdf668fa076b",
      "url": "https://api.github.com/repos/coralproject/talk/commits/2dc63d3a27e6fe46d358aad347adbdf668fa076b",
      "html_url": "https://github.com/coralproject/talk/commit/2dc63d3a27e6fe46d358aad347adbdf668fa076b"
    }
  ],
  "stats": {
    "total": 1586,
    "additions": 1306,
    "deletions": 280
  },
  "files": [
    {
      "sha": "5802278e16942b4ef448dddbf2fe1f1a7c264a82",
      "filename": "src/core/client/admin/routes/Configure/sections/Auth/SSOConfig.tsx",
      "status": "modified",
      "additions": 21,
      "deletions": 5,
      "changes": 26,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOConfig.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOConfig.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Auth/SSOConfig.tsx?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -2,12 +2,13 @@ import { Localized } from \"@fluent/react/compat\";\n import React, { FunctionComponent } from \"react\";\n import { graphql } from \"react-relay\";\n \n-import { PropTypesOf } from \"coral-framework/types\";\n+import { ExternalLink } from \"coral-framework/lib/i18n/components\";\n+import { FormFieldDescription } from \"coral-ui/components/v2\";\n \n import Header from \"../../Header\";\n import ConfigBoxWithToggleField from \"./ConfigBoxWithToggleField\";\n import RegistrationField from \"./RegistrationField\";\n-import SSOKeyFieldContainer from \"./SSOKeyFieldContainer\";\n+import SSOKeyRotationQuery from \"./SSOKeyRotation/SSOKeyRotationQuery\";\n import TargetFilterField from \"./TargetFilterField\";\n \n // eslint-disable-next-line no-unused-expressions\n@@ -28,10 +29,9 @@ graphql`\n \n interface Props {\n   disabled?: boolean;\n-  sso: PropTypesOf<typeof SSOKeyFieldContainer>[\"sso\"];\n }\n \n-const SSOConfig: FunctionComponent<Props> = ({ disabled, sso }) => (\n+const SSOConfig: FunctionComponent<Props> = ({ disabled }) => (\n   <ConfigBoxWithToggleField\n     title={\n       <Localized id=\"configure-auth-sso-loginWith\">\n@@ -44,7 +44,23 @@ const SSOConfig: FunctionComponent<Props> = ({ disabled, sso }) => (\n   >\n     {disabledInside => (\n       <>\n-        <SSOKeyFieldContainer sso={sso} disabled={disabledInside} />\n+        <Localized\n+          id=\"configure-auth-sso-description\"\n+          IntroLink={\n+            <ExternalLink href=\"https://jwt.io/introduction/\"></ExternalLink>\n+          }\n+          DocLink={\n+            <ExternalLink href=\"https://docs.coralproject.net/coral/v5/integrating/sso/\"></ExternalLink>\n+          }\n+        >\n+          <FormFieldDescription>\n+            To enable integration with your existing authentication system, you\n+            will need to create a JWT Token to connect. You can learn more about\n+            creating a JWT Token with this introduction. See our documentation\n+            for additional information on single sign on.\n+          </FormFieldDescription>\n+        </Localized>\n+        <SSOKeyRotationQuery disabled={disabledInside}></SSOKeyRotationQuery>\n         <TargetFilterField\n           label={\n             <Localized id=\"configure-auth-sso-useLoginOn\">"
    },
    {
      "sha": "775eb044136428af59eda88c2fcf28545e8498fc",
      "filename": "src/core/client/admin/routes/Configure/sections/Auth/SSOConfigContainer.tsx",
      "status": "modified",
      "additions": 2,
      "deletions": 6,
      "changes": 8,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOConfigContainer.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOConfigContainer.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Auth/SSOConfigContainer.tsx?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -16,17 +16,13 @@ const SSOConfigContainer: React.FunctionComponent<Props> = ({\n   disabled,\n   auth,\n }) => {\n-  return <SSOConfig disabled={disabled} sso={auth.integrations.sso} />;\n+  return <SSOConfig disabled={disabled} />;\n };\n \n const enhanced = withFragmentContainer<Props>({\n   auth: graphql`\n     fragment SSOConfigContainer_auth on Auth {\n-      integrations {\n-        sso {\n-          ...SSOKeyFieldContainer_sso\n-        }\n-      }\n+      ...SSOConfig_formValues\n     }\n   `,\n })(SSOConfigContainer);"
    },
    {
      "sha": "1b2f8e3c559ccb127912f068bf2ace408d2f81eb",
      "filename": "src/core/client/admin/routes/Configure/sections/Auth/SSOKeyField.css",
      "status": "removed",
      "additions": 0,
      "deletions": 29,
      "changes": 29,
      "blob_url": "https://github.com/coralproject/talk/blob/2dc63d3a27e6fe46d358aad347adbdf668fa076b/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyField.css",
      "raw_url": "https://github.com/coralproject/talk/raw/2dc63d3a27e6fe46d358aad347adbdf668fa076b/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyField.css",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyField.css?ref=2dc63d3a27e6fe46d358aad347adbdf668fa076b",
      "patch": "@@ -1,29 +0,0 @@\n-.root {\n-  padding-bottom: var(--spacing-4);\n-}\n-\n-.keyGenerated {\n-  composes: button from \"coral-ui/shared/typography.css\";\n-  color: var(--palette-text-secondary);\n-  flex-shrink: 0;\n-}\n-\n-.warnIcon {\n-  color: var(--palette-text-secondary);\n-  flex-shrink: 0;\n-  padding-top: 3px;\n-  padding-right: var(--spacing-1);\n-}\n-\n-.warn {\n-  color: var(--palette-text-secondary);\n-}\n-\n-.warningSection {\n-  padding-top: var(--spacing-1);\n-  padding-bottom: var(--spacing-1);\n-}\n-\n-.regenerateButton {\n-  float: right;\n-}"
    },
    {
      "sha": "83d47b43cfad925c148a8295fde39500eb640dd0",
      "filename": "src/core/client/admin/routes/Configure/sections/Auth/SSOKeyField.tsx",
      "status": "removed",
      "additions": 0,
      "deletions": 79,
      "changes": 79,
      "blob_url": "https://github.com/coralproject/talk/blob/2dc63d3a27e6fe46d358aad347adbdf668fa076b/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyField.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/2dc63d3a27e6fe46d358aad347adbdf668fa076b/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyField.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyField.tsx?ref=2dc63d3a27e6fe46d358aad347adbdf668fa076b",
      "patch": "@@ -1,79 +0,0 @@\n-import { Localized } from \"@fluent/react/compat\";\n-import React, { FunctionComponent } from \"react\";\n-\n-import {\n-  Button,\n-  Flex,\n-  FormField,\n-  Icon,\n-  Label,\n-  PasswordField,\n-} from \"coral-ui/components/v2\";\n-\n-import HelperText from \"../../HelperText\";\n-\n-import styles from \"./SSOKeyField.css\";\n-\n-interface Props {\n-  disabled?: boolean;\n-  generatedKey?: string;\n-  keyGeneratedAt?: any;\n-  onRegenerate?: () => void;\n-}\n-\n-const SSOKeyField: FunctionComponent<Props> = ({\n-  generatedKey,\n-  keyGeneratedAt,\n-  disabled,\n-  onRegenerate,\n-}) => (\n-  <FormField className={styles.root}>\n-    <Localized id=\"configure-auth-sso-key\">\n-      <Label htmlFor=\"configure-auth-sso-key\">Key</Label>\n-    </Localized>\n-    <PasswordField\n-      id=\"configure-auth-sso-key\"\n-      name=\"key\"\n-      value={generatedKey}\n-      readOnly\n-      // TODO: (wyattjoh) figure out how to add translations to these props\n-      hidePasswordTitle=\"Show SSO Key\"\n-      showPasswordTitle=\"Hide SSO Key\"\n-      fullWidth\n-    />\n-    {keyGeneratedAt && (\n-      <Localized\n-        id=\"configure-auth-sso-regenerateAt\"\n-        $date={new Date(keyGeneratedAt)}\n-      >\n-        <HelperText className={styles.keyGenerated}>\n-          KEY GENERATED AT: {keyGeneratedAt}\n-        </HelperText>\n-      </Localized>\n-    )}\n-    <div className={styles.warningSection}>\n-      <Flex direction=\"row\" itemGutter=\"half\">\n-        <Icon className={styles.warnIcon}>warning</Icon>\n-        <Localized id=\"configure-auth-sso-regenerateHonoredWarning\">\n-          <HelperText>\n-            When regenerating a key, tokens signed with the previous key will be\n-            honored for 30 days.\n-          </HelperText>\n-        </Localized>\n-      </Flex>\n-    </div>\n-\n-    <Localized id=\"configure-auth-sso-regenerate\">\n-      <Button\n-        id=\"configure-auth-sso-regenerate\"\n-        disabled={disabled}\n-        onClick={onRegenerate}\n-        className={styles.regenerateButton}\n-      >\n-        Regenerate\n-      </Button>\n-    </Localized>\n-  </FormField>\n-);\n-\n-export default SSOKeyField;"
    },
    {
      "sha": "4c1fa0eff11e2968c99c81c3a57e9bc5621e87bf",
      "filename": "src/core/client/admin/routes/Configure/sections/Auth/SSOKeyFieldContainer.tsx",
      "status": "removed",
      "additions": 0,
      "deletions": 60,
      "changes": 60,
      "blob_url": "https://github.com/coralproject/talk/blob/2dc63d3a27e6fe46d358aad347adbdf668fa076b/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyFieldContainer.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/2dc63d3a27e6fe46d358aad347adbdf668fa076b/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyFieldContainer.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyFieldContainer.tsx?ref=2dc63d3a27e6fe46d358aad347adbdf668fa076b",
      "patch": "@@ -1,60 +0,0 @@\n-import React from \"react\";\n-import { graphql } from \"react-relay\";\n-\n-import {\n-  MutationProp,\n-  withFragmentContainer,\n-  withMutation,\n-} from \"coral-framework/lib/relay\";\n-\n-import { SSOKeyFieldContainer_sso as SSOData } from \"coral-admin/__generated__/SSOKeyFieldContainer_sso.graphql\";\n-\n-import RegenerateSSOKeyMutation from \"./RegenerateSSOKeyMutation\";\n-import SSOKeyField from \"./SSOKeyField\";\n-\n-interface Props {\n-  sso: SSOData;\n-  disabled?: boolean;\n-  regenerateSSOKey: MutationProp<typeof RegenerateSSOKeyMutation>;\n-}\n-\n-interface State {\n-  awaitingResponse: boolean;\n-}\n-\n-class SSOKeyFieldContainer extends React.Component<Props, State> {\n-  public state = {\n-    awaitingResponse: false,\n-  };\n-\n-  private handleRegenerate = async () => {\n-    this.setState({ awaitingResponse: true });\n-    await this.props.regenerateSSOKey();\n-    this.setState({ awaitingResponse: false });\n-  };\n-\n-  public render() {\n-    const { disabled } = this.props;\n-    return (\n-      <SSOKeyField\n-        disabled={disabled || this.state.awaitingResponse}\n-        generatedKey={this.props.sso.key || undefined}\n-        keyGeneratedAt={this.props.sso.keyGeneratedAt || undefined}\n-        onRegenerate={this.handleRegenerate}\n-      />\n-    );\n-  }\n-}\n-\n-const enhanced = withMutation(RegenerateSSOKeyMutation)(\n-  withFragmentContainer<Props>({\n-    sso: graphql`\n-      fragment SSOKeyFieldContainer_sso on SSOAuthIntegration {\n-        key\n-        keyGeneratedAt\n-      }\n-    `,\n-  })(SSOKeyFieldContainer)\n-);\n-\n-export default enhanced;"
    },
    {
      "sha": "dee544d71c37e9ccb781dc285c79f787da2aff71",
      "filename": "src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/DateField.css",
      "status": "added",
      "additions": 10,
      "deletions": 0,
      "changes": 10,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/DateField.css",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/DateField.css",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/DateField.css?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -0,0 +1,10 @@\n+.label {\n+  padding-bottom: var(--v2-spacing-2);\n+}\n+\n+.date {\n+  font-family: var(--v2-font-family-primary);\n+  font-weight: var(--v2-font-weight-primary-regular);\n+  font-size: var(--v2-font-size-2);\n+  line-height: var(--v2-line-height-reset);\n+}"
    },
    {
      "sha": "5288759808a13dbb2dbcb97e34eaa459b5ce9367",
      "filename": "src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/DateField.tsx",
      "status": "added",
      "additions": 97,
      "deletions": 0,
      "changes": 97,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/DateField.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/DateField.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/DateField.tsx?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -0,0 +1,97 @@\n+import { Localized } from \"@fluent/react/compat\";\n+import React, { FunctionComponent } from \"react\";\n+\n+import { Flex, Label } from \"coral-ui/components/v2\";\n+\n+import { SSOKeyStatus } from \"./StatusField\";\n+\n+import styles from \"./DateField.css\";\n+\n+export interface SSOKeyDates {\n+  readonly createdAt: string;\n+  readonly lastUsedAt: string | null;\n+  readonly rotatedAt: string | null;\n+  readonly inactiveAt: string | null;\n+}\n+\n+interface Props {\n+  status: SSOKeyStatus;\n+  dates: SSOKeyDates;\n+}\n+\n+const DateField: FunctionComponent<Props> = ({ status, dates }) => {\n+  switch (status) {\n+    case SSOKeyStatus.ACTIVE:\n+      return (\n+        <>\n+          <div className={styles.label}>\n+            <Localized id=\"configure-auth-sso-rotate-activeSince\">\n+              <Label>Active Since</Label>\n+            </Localized>\n+          </div>\n+          <Localized\n+            id=\"configure-auth-sso-rotate-date\"\n+            $date={new Date(dates.createdAt)}\n+          >\n+            <span className={styles.date}>{dates.createdAt}</span>\n+          </Localized>\n+        </>\n+      );\n+    case SSOKeyStatus.EXPIRING:\n+      return (\n+        <>\n+          <div className={styles.label}>\n+            <Localized id=\"configure-auth-sso-rotate-inactiveAt\">\n+              <Label>Inactive At</Label>\n+            </Localized>\n+          </div>\n+          <Flex\n+            alignItems=\"center\"\n+            justifyContent=\"center\"\n+            className={styles.date}\n+          >\n+            <Localized\n+              id=\"configure-auth-sso-rotate-date\"\n+              $date={\n+                dates.inactiveAt\n+                  ? new Date(dates.inactiveAt)\n+                  : new Date(dates.createdAt)\n+              }\n+            >\n+              {dates.inactiveAt}\n+            </Localized>\n+          </Flex>\n+        </>\n+      );\n+    case SSOKeyStatus.EXPIRED:\n+      return (\n+        <>\n+          <div className={styles.label}>\n+            <Localized id=\"configure-auth-sso-rotate-inactiveSince\">\n+              <Label>Inactive Since</Label>\n+            </Localized>\n+          </div>\n+          <Flex\n+            alignItems=\"center\"\n+            justifyContent=\"center\"\n+            className={styles.date}\n+          >\n+            <Localized\n+              id=\"configure-auth-sso-rotate-date\"\n+              $date={\n+                dates.inactiveAt\n+                  ? new Date(dates.inactiveAt)\n+                  : new Date(dates.createdAt)\n+              }\n+            >\n+              {dates.inactiveAt}\n+            </Localized>\n+          </Flex>\n+        </>\n+      );\n+    default:\n+      return null;\n+  }\n+};\n+\n+export default DateField;"
    },
    {
      "sha": "16bab846dcec348c806c80017b6a975487555b5d",
      "filename": "src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/DeactivateSSOKeyMutation.ts",
      "status": "added",
      "additions": 52,
      "deletions": 0,
      "changes": 52,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/DeactivateSSOKeyMutation.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/DeactivateSSOKeyMutation.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/DeactivateSSOKeyMutation.ts?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -0,0 +1,52 @@\n+import { graphql } from \"react-relay\";\n+import { Environment } from \"relay-runtime\";\n+\n+import {\n+  commitMutationPromiseNormalized,\n+  createMutation,\n+  MutationInput,\n+} from \"coral-framework/lib/relay\";\n+\n+import { DeactivateSSOKeyMutation as MutationTypes } from \"coral-admin/__generated__/DeactivateSSOKeyMutation.graphql\";\n+\n+const clientMutationId = 0;\n+\n+const DeactivateSSOKeyMutation = createMutation(\n+  \"deactivateSSOKey\",\n+  (environment: Environment, input: MutationInput<MutationTypes>) => {\n+    return commitMutationPromiseNormalized<MutationTypes>(environment, {\n+      mutation: graphql`\n+        mutation DeactivateSSOKeyMutation($input: DeactivateSSOKeyInput!) {\n+          deactivateSSOKey(input: $input) {\n+            settings {\n+              auth {\n+                integrations {\n+                  sso {\n+                    enabled\n+                    keys {\n+                      kid\n+                      secret\n+                      createdAt\n+                      lastUsedAt\n+                      rotatedAt\n+                      inactiveAt\n+                    }\n+                  }\n+                }\n+              }\n+            }\n+            clientMutationId\n+          }\n+        }\n+      `,\n+      variables: {\n+        input: {\n+          ...input,\n+          clientMutationId: clientMutationId.toString(),\n+        },\n+      },\n+    });\n+  }\n+);\n+\n+export default DeactivateSSOKeyMutation;"
    },
    {
      "sha": "b459854c1457c9780321a1ffe4eb8af4ad80fd34",
      "filename": "src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/DeleteSSOKeyMutation.ts",
      "status": "added",
      "additions": 52,
      "deletions": 0,
      "changes": 52,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/DeleteSSOKeyMutation.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/DeleteSSOKeyMutation.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/DeleteSSOKeyMutation.ts?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -0,0 +1,52 @@\n+import { graphql } from \"react-relay\";\n+import { Environment } from \"relay-runtime\";\n+\n+import {\n+  commitMutationPromiseNormalized,\n+  createMutation,\n+  MutationInput,\n+} from \"coral-framework/lib/relay\";\n+\n+import { DeleteSSOKeyMutation as MutationTypes } from \"coral-admin/__generated__/DeleteSSOKeyMutation.graphql\";\n+\n+const clientMutationId = 0;\n+\n+const DeleteSSOKeyMutation = createMutation(\n+  \"deleteSSOKey\",\n+  (environment: Environment, input: MutationInput<MutationTypes>) => {\n+    return commitMutationPromiseNormalized<MutationTypes>(environment, {\n+      mutation: graphql`\n+        mutation DeleteSSOKeyMutation($input: DeleteSSOKeyInput!) {\n+          deleteSSOKey(input: $input) {\n+            settings {\n+              auth {\n+                integrations {\n+                  sso {\n+                    enabled\n+                    keys {\n+                      kid\n+                      secret\n+                      createdAt\n+                      lastUsedAt\n+                      rotatedAt\n+                      inactiveAt\n+                    }\n+                  }\n+                }\n+              }\n+            }\n+            clientMutationId\n+          }\n+        }\n+      `,\n+      variables: {\n+        input: {\n+          ...input,\n+          clientMutationId: clientMutationId.toString(),\n+        },\n+      },\n+    });\n+  }\n+);\n+\n+export default DeleteSSOKeyMutation;"
    },
    {
      "sha": "8010a0aa8811c275aee626220283c3af3b8ec1c8",
      "filename": "src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/RotateSSOKeyMutation.ts",
      "status": "added",
      "additions": 52,
      "deletions": 0,
      "changes": 52,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/RotateSSOKeyMutation.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/RotateSSOKeyMutation.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/RotateSSOKeyMutation.ts?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -0,0 +1,52 @@\n+import { graphql } from \"react-relay\";\n+import { Environment } from \"relay-runtime\";\n+\n+import {\n+  commitMutationPromiseNormalized,\n+  createMutation,\n+  MutationInput,\n+} from \"coral-framework/lib/relay\";\n+\n+import { RotateSSOKeyMutation as MutationTypes } from \"coral-admin/__generated__/RotateSSOKeyMutation.graphql\";\n+\n+const clientMutationId = 0;\n+\n+const RotateSSOKeyMutation = createMutation(\n+  \"rotateSSOKey\",\n+  (environment: Environment, input: MutationInput<MutationTypes>) => {\n+    return commitMutationPromiseNormalized<MutationTypes>(environment, {\n+      mutation: graphql`\n+        mutation RotateSSOKeyMutation($input: RotateSSOKeyInput!) {\n+          rotateSSOKey(input: $input) {\n+            settings {\n+              auth {\n+                integrations {\n+                  sso {\n+                    enabled\n+                    keys {\n+                      kid\n+                      secret\n+                      createdAt\n+                      lastUsedAt\n+                      rotatedAt\n+                      inactiveAt\n+                    }\n+                  }\n+                }\n+              }\n+            }\n+            clientMutationId\n+          }\n+        }\n+      `,\n+      variables: {\n+        input: {\n+          ...input,\n+          clientMutationId: clientMutationId.toString(),\n+        },\n+      },\n+    });\n+  }\n+);\n+\n+export default RotateSSOKeyMutation;"
    },
    {
      "sha": "5f3824668ee6b594684ac7c003b6c880c0664db1",
      "filename": "src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/RotationDropdown.css",
      "status": "added",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/RotationDropdown.css",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/RotationDropdown.css",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/RotationDropdown.css?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -0,0 +1,3 @@\n+.rotate {\n+  margin-right: var(--v2-spacing-1)\n+}"
    },
    {
      "sha": "f3eea1458d06f4e360cd9bae460b921d2e587217",
      "filename": "src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/RotationDropdown.tsx",
      "status": "added",
      "additions": 72,
      "deletions": 0,
      "changes": 72,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/RotationDropdown.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/RotationDropdown.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/RotationDropdown.tsx?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -0,0 +1,72 @@\n+import { Localized } from \"@fluent/react/compat\";\n+import React, { FunctionComponent } from \"react\";\n+\n+import {\n+  Button,\n+  ClickOutside,\n+  Dropdown,\n+  DropdownButton,\n+  Icon,\n+  Popover,\n+} from \"coral-ui/components/v2\";\n+\n+import RotateOption, { RotateOptions } from \"./RotationOption\";\n+\n+import styles from \"./RotationDropdown.css\";\n+\n+interface Props {\n+  onRotateKey: (rotation: string) => void;\n+  disabled?: boolean;\n+}\n+\n+const RotationDropDown: FunctionComponent<Props> = ({\n+  onRotateKey,\n+  disabled,\n+}) => {\n+  return (\n+    <Localized\n+      id=\"configure-auth-sso-rotate-dropdown-description\"\n+      attrs={{ description: true }}\n+    >\n+      <Popover\n+        id=\"sso-key-rotate\"\n+        placement=\"bottom-start\"\n+        description=\"A dropdown to rotate the SSO key\"\n+        body={({ toggleVisibility }) => (\n+          <ClickOutside onClickOutside={toggleVisibility}>\n+            <Dropdown>\n+              {Object.keys(RotateOptions).map((opt: string) => (\n+                <DropdownButton\n+                  key={opt}\n+                  onClick={() => {\n+                    onRotateKey(opt);\n+                    toggleVisibility();\n+                  }}\n+                  disabled={disabled}\n+                >\n+                  <RotateOption value={opt}></RotateOption>\n+                </DropdownButton>\n+              ))}\n+            </Dropdown>\n+          </ClickOutside>\n+        )}\n+      >\n+        {({ toggleVisibility, ref, visible }) => (\n+          <Button\n+            onClick={toggleVisibility}\n+            ref={ref}\n+            color=\"regular\"\n+            disabled={disabled}\n+          >\n+            <Localized id=\"configure-auth-sso-rotate-rotate\">\n+              <span className={styles.rotate}>Rotate</span>\n+            </Localized>\n+            <Icon>arrow_drop_down</Icon>\n+          </Button>\n+        )}\n+      </Popover>\n+    </Localized>\n+  );\n+};\n+\n+export default RotationDropDown;"
    },
    {
      "sha": "e0a02cbb59471fbf4069fd37c92a628f441b8120",
      "filename": "src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/RotationOption.tsx",
      "status": "added",
      "additions": 46,
      "deletions": 0,
      "changes": 46,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/RotationOption.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/RotationOption.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/RotationOption.tsx?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -0,0 +1,46 @@\n+import { Localized } from \"@fluent/react/compat\";\n+import React, { FunctionComponent } from \"react\";\n+\n+export enum RotateOptions {\n+  NOW = \"NOW\",\n+  IN1DAY = \"IN1DAY\",\n+  IN1WEEK = \"IN1WEEK\",\n+  IN30DAYS = \"IN30DAYS\",\n+}\n+\n+interface Props {\n+  value: string;\n+}\n+\n+const RotationOption: FunctionComponent<Props> = ({ value }) => {\n+  switch (value) {\n+    case RotateOptions.NOW: {\n+      return <Localized id=\"configure-auth-sso-rotate-now\">Now</Localized>;\n+    }\n+    case RotateOptions.IN1DAY: {\n+      return (\n+        <Localized id=\"configure-auth-sso-rotate-1day\">\n+          1 day from now\n+        </Localized>\n+      );\n+    }\n+    case RotateOptions.IN1WEEK: {\n+      return (\n+        <Localized id=\"configure-auth-sso-rotate-1week\">\n+          1 week from now\n+        </Localized>\n+      );\n+    }\n+    case RotateOptions.IN30DAYS: {\n+      return (\n+        <Localized id=\"configure-auth-sso-rotate-30days\">\n+          30 days from now\n+        </Localized>\n+      );\n+    }\n+    default:\n+      return <Localized id=\"configure-auth-sso-rotate-now\">Now</Localized>;\n+  }\n+};\n+\n+export default RotationOption;"
    },
    {
      "sha": "2b4e295fe0276ecae3e2bb11c675193fa5216745",
      "filename": "src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/SSOKeyCard.css",
      "status": "added",
      "additions": 23,
      "deletions": 0,
      "changes": 23,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/SSOKeyCard.css",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/SSOKeyCard.css",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/SSOKeyCard.css?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -0,0 +1,23 @@\n+.label {\n+  padding-bottom: var(--v2-spacing-2);\n+}\n+\n+.keySection {\n+  flex-grow: 1;\n+  min-width: 50px;\n+\n+  padding-right: var(--v2-spacing-3);\n+}\n+\n+.statusSection {\n+  margin-right: var(--v2-spacing-3);\n+}\n+\n+.secretSection {\n+  flex-grow: 1;\n+  min-width: 50px;\n+}\n+\n+.action {\n+  margin-right: var(--v2-spacing-1)\n+}"
    },
    {
      "sha": "39df183405090e8d14515169bf1f8601e980bd35",
      "filename": "src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/SSOKeyCard.tsx",
      "status": "added",
      "additions": 187,
      "deletions": 0,
      "changes": 187,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/SSOKeyCard.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/SSOKeyCard.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/SSOKeyCard.tsx?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -0,0 +1,187 @@\n+import { Localized } from \"@fluent/react/compat\";\n+import React, { FunctionComponent, useCallback } from \"react\";\n+import CopyToClipboard from \"react-copy-to-clipboard\";\n+\n+import { useMutation } from \"coral-framework/lib/relay\";\n+import {\n+  Button,\n+  Card,\n+  Flex,\n+  HorizontalGutter,\n+  Icon,\n+  Label,\n+  PasswordField,\n+  TextField,\n+} from \"coral-ui/components/v2\";\n+\n+import DateField from \"./DateField\";\n+import DeactivateSSOKeyMutation from \"./DeactivateSSOKeyMutation\";\n+import DeleteSSOKeyMutation from \"./DeleteSSOKeyMutation\";\n+import RotateSSOKeyMutation from \"./RotateSSOKeyMutation\";\n+import RotationDropDown from \"./RotationDropdown\";\n+import { RotateOptions } from \"./RotationOption\";\n+import StatusField, { SSOKeyStatus } from \"./StatusField\";\n+\n+import styles from \"./SSOKeyCard.css\";\n+\n+export interface SSOKeyDates {\n+  readonly createdAt: string;\n+  readonly lastUsedAt: string | null;\n+  readonly rotatedAt: string | null;\n+  readonly inactiveAt: string | null;\n+}\n+\n+interface Props {\n+  id: string;\n+  secret: string;\n+  status: SSOKeyStatus;\n+  dates: SSOKeyDates;\n+  disabled?: boolean;\n+}\n+\n+function createActionButton(\n+  status: SSOKeyStatus,\n+  onRotateKey: (rotation: string) => void,\n+  onDeactivateKey: () => void,\n+  onDelete: () => void,\n+  disabled?: boolean\n+) {\n+  switch (status) {\n+    case SSOKeyStatus.ACTIVE:\n+      return <RotationDropDown onRotateKey={onRotateKey} disabled={disabled} />;\n+    case SSOKeyStatus.EXPIRING:\n+      return (\n+        <Localized id=\"configure-auth-sso-rotate-deactivateNow\">\n+          <Button color=\"alert\" onClick={onDeactivateKey} disabled={disabled}>\n+            Deactivate Now\n+          </Button>\n+        </Localized>\n+      );\n+    case SSOKeyStatus.EXPIRED:\n+      return (\n+        <Localized id=\"configure-auth-sso-rotate-delete\">\n+          <Button color=\"alert\" onClick={onDelete} disabled={disabled}>\n+            Delete\n+          </Button>\n+        </Localized>\n+      );\n+    default:\n+      return null;\n+  }\n+}\n+\n+const SSOKeyCard: FunctionComponent<Props> = ({\n+  id,\n+  secret,\n+  status,\n+  dates,\n+  disabled,\n+}) => {\n+  const rotateSSOKey = useMutation(RotateSSOKeyMutation);\n+  const deactivateSSOKey = useMutation(DeactivateSSOKeyMutation);\n+  const deleteSSOKey = useMutation(DeleteSSOKeyMutation);\n+\n+  const onRotate = useCallback(\n+    (rotation: string) => {\n+      switch (rotation) {\n+        case RotateOptions.NOW:\n+          rotateSSOKey({ inactiveIn: 0 });\n+          break;\n+        case RotateOptions.IN1DAY:\n+          rotateSSOKey({ inactiveIn: 24 * 60 * 60 });\n+          break;\n+        case RotateOptions.IN1WEEK:\n+          rotateSSOKey({ inactiveIn: 7 * 24 * 60 * 60 });\n+          break;\n+        case RotateOptions.IN30DAYS:\n+          rotateSSOKey({ inactiveIn: 30 * 24 * 60 * 60 });\n+          break;\n+        default:\n+          rotateSSOKey({ inactiveIn: 0 });\n+      }\n+    },\n+    [rotateSSOKey]\n+  );\n+  const onDeactivate = useCallback(() => {\n+    deactivateSSOKey({\n+      kid: id,\n+    });\n+  }, [deactivateSSOKey, id]);\n+  const onDelete = useCallback(() => {\n+    deleteSSOKey({\n+      kid: id,\n+    });\n+  }, [deleteSSOKey, id]);\n+\n+  return (\n+    <Card>\n+      <HorizontalGutter>\n+        <Flex alignItems=\"center\" justifyContent=\"space-between\">\n+          <div className={styles.keySection}>\n+            <div className={styles.label}>\n+              <Localized id=\"configure-auth-sso-rotate-keyID\">\n+                <Label>Key ID</Label>\n+              </Localized>\n+            </div>\n+            <TextField value={id} readOnly fullWidth data-testid=\"SSO-Key-ID\" />\n+          </div>\n+          <div className={styles.secretSection}>\n+            <div className={styles.label}>\n+              <Localized id=\"configure-auth-sso-rotate-secret\">\n+                <Label>Secret</Label>\n+              </Localized>\n+            </div>\n+            <Flex alignItems=\"center\" justifyContent=\"flex-start\">\n+              <PasswordField\n+                id=\"configure-auth-sso-rotate-secretField\"\n+                name=\"key\"\n+                value={secret}\n+                readOnly\n+                // TODO: (nick-funk) figure out how to add translations to these props\n+                hidePasswordTitle=\"Show Secret\"\n+                showPasswordTitle=\"Hide Secret\"\n+                fullWidth\n+              />\n+              <CopyToClipboard text={secret}>\n+                <Button color=\"mono\" variant=\"flat\">\n+                  <Localized\n+                    id=\"configure-auth-sso-rotate-copySecret\"\n+                    attrs={{ \"aria-label\": true }}\n+                  >\n+                    <Icon size=\"md\" aria-label=\"Copy Secret\">\n+                      content_copy\n+                    </Icon>\n+                  </Localized>\n+                </Button>\n+              </CopyToClipboard>\n+            </Flex>\n+          </div>\n+        </Flex>\n+        <Flex alignItems=\"flex-end\" justifyContent=\"space-between\">\n+          <Flex alignItems=\"center\" justifyContent=\"flex-start\">\n+            <div className={styles.statusSection}>\n+              <div className={styles.label}>\n+                <Localized id=\"configure-auth-sso-rotate-status\">\n+                  <Label>Status</Label>\n+                </Localized>\n+              </div>\n+              <StatusField status={status}></StatusField>\n+            </div>\n+            <div>\n+              <DateField status={status} dates={dates} />\n+            </div>\n+          </Flex>\n+          {createActionButton(\n+            status,\n+            onRotate,\n+            onDeactivate,\n+            onDelete,\n+            disabled\n+          )}\n+        </Flex>\n+      </HorizontalGutter>\n+    </Card>\n+  );\n+};\n+\n+export default SSOKeyCard;"
    },
    {
      "sha": "34f828982931a181e33cefc234f77b3879bf6b23",
      "filename": "src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/SSOKeyRotationContainer.tsx",
      "status": "added",
      "additions": 130,
      "deletions": 0,
      "changes": 130,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/SSOKeyRotationContainer.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/SSOKeyRotationContainer.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/SSOKeyRotationContainer.tsx?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -0,0 +1,130 @@\n+import { Localized } from \"@fluent/react/compat\";\n+import React, { FunctionComponent, useMemo } from \"react\";\n+\n+import { graphql, withFragmentContainer } from \"coral-framework/lib/relay\";\n+import { Label } from \"coral-ui/components/v2\";\n+\n+import { SSOKeyRotationContainer_settings } from \"coral-admin/__generated__/SSOKeyRotationContainer_settings.graphql\";\n+\n+import SSOKeyCard, { SSOKeyDates } from \"./SSOKeyCard\";\n+import { SSOKeyStatus } from \"./StatusField\";\n+\n+interface Props {\n+  settings: SSOKeyRotationContainer_settings;\n+  disabled?: boolean;\n+}\n+\n+interface Key {\n+  readonly kid: string;\n+  readonly secret: string;\n+  readonly createdAt: string;\n+  readonly lastUsedAt: string | null;\n+  readonly rotatedAt: string | null;\n+  readonly inactiveAt: string | null;\n+}\n+\n+function getStatus(dates: SSOKeyDates) {\n+  if (\n+    dates.inactiveAt &&\n+    dates.rotatedAt &&\n+    new Date(dates.inactiveAt) > new Date()\n+  ) {\n+    return SSOKeyStatus.EXPIRING;\n+  }\n+\n+  if (dates.inactiveAt && new Date(dates.inactiveAt) <= new Date()) {\n+    return SSOKeyStatus.EXPIRED;\n+  }\n+\n+  return SSOKeyStatus.ACTIVE;\n+}\n+\n+const SSOKeyRotationContainer: FunctionComponent<Props> = ({\n+  disabled,\n+  settings,\n+}) => {\n+  const {\n+    auth: {\n+      integrations: {\n+        sso: { keys },\n+      },\n+    },\n+  } = settings;\n+\n+  const sortedKeys = useMemo(\n+    () =>\n+      keys\n+        // Copy this map because we don't want to modify the underlying copy.\n+        .map(key => key)\n+        .sort((a: Key, b: Key) => {\n+          // Both active, sort on createdAt date.\n+          if (!a.inactiveAt && !b.inactiveAt) {\n+            return (\n+              new Date(a.createdAt).getTime() - new Date(b.createdAt).getTime()\n+            );\n+          }\n+          // A is active, B is not, A comes before B.\n+          if (!a.inactiveAt && b.inactiveAt) {\n+            return -1;\n+          }\n+          // B is active, A is not, B comes before A.\n+          if (a.inactiveAt && !b.inactiveAt) {\n+            return 1;\n+          }\n+\n+          // Sort primarily on inactiveAt, fall back to createdAt if\n+          // for some reason it's not available.\n+          const aDate = a.inactiveAt\n+            ? new Date(a.inactiveAt)\n+            : new Date(a.createdAt);\n+          const bDate = b.inactiveAt\n+            ? new Date(b.inactiveAt)\n+            : new Date(b.createdAt);\n+\n+          return bDate.getTime() - aDate.getTime();\n+        }),\n+    [keys]\n+  );\n+\n+  return (\n+    <>\n+      <Localized id=\"configure-auth-sso-rotate-keys\">\n+        <Label htmlFor=\"configure-auth-sso-rotate-keys\">Keys</Label>\n+      </Localized>\n+      {sortedKeys.map(key => (\n+        <SSOKeyCard\n+          key={key.kid}\n+          id={key.kid}\n+          secret={key.secret}\n+          status={getStatus(key)}\n+          dates={key}\n+          disabled={disabled}\n+        />\n+      ))}\n+    </>\n+  );\n+};\n+\n+const enhanced = withFragmentContainer<Props>({\n+  settings: graphql`\n+    fragment SSOKeyRotationContainer_settings on Settings {\n+      auth {\n+        integrations {\n+          sso {\n+            enabled\n+            keys {\n+              kid\n+              secret\n+              createdAt\n+              lastUsedAt\n+              rotatedAt\n+              inactiveAt\n+            }\n+          }\n+        }\n+      }\n+    }\n+  `,\n+})(SSOKeyRotationContainer);\n+\n+export default enhanced;"
    },
    {
      "sha": "dcf7c62b27fd0e44ed999adf9761d827a9b7cf60",
      "filename": "src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/SSOKeyRotationQuery.tsx",
      "status": "added",
      "additions": 54,
      "deletions": 0,
      "changes": 54,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/SSOKeyRotationQuery.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/SSOKeyRotationQuery.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/SSOKeyRotationQuery.tsx?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -0,0 +1,54 @@\n+import React, { FunctionComponent } from \"react\";\n+\n+import {\n+  graphql,\n+  QueryRenderData,\n+  QueryRenderer,\n+} from \"coral-framework/lib/relay\";\n+import { CallOut, Spinner } from \"coral-ui/components/v2\";\n+\n+import { SSOKeyRotationQuery as QueryTypes } from \"coral-admin/__generated__/SSOKeyRotationQuery.graphql\";\n+\n+import SSOKeyRotationContainer from \"./SSOKeyRotationContainer\";\n+\n+interface Props {\n+  disabled?: boolean;\n+}\n+\n+const SSOKeyRotationQuery: FunctionComponent<Props> = ({ disabled }) => {\n+  return (\n+    <QueryRenderer<QueryTypes>\n+      query={graphql`\n+        query SSOKeyRotationQuery {\n+          settings {\n+            ...SSOKeyRotationContainer_settings\n+          }\n+        }\n+      `}\n+      variables={{}}\n+      cacheConfig={{ force: true }}\n+      render={({ error, props }: QueryRenderData<QueryTypes>) => {\n+        if (error) {\n+          return <CallOut>{error.message}</CallOut>;\n+        }\n+\n+        if (!props) {\n+          return <Spinner />;\n+        }\n+\n+        if (!props.settings) {\n+          return <Spinner />;\n+        }\n+\n+        return (\n+          <SSOKeyRotationContainer\n+            settings={props.settings}\n+            disabled={disabled}\n+          />\n+        );\n+      }}\n+    />\n+  );\n+};\n+\n+export default SSOKeyRotationQuery;"
    },
    {
      "sha": "9c8630cd480aa705913d8d7546212ab21d6a83f0",
      "filename": "src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/StatusField.css",
      "status": "added",
      "additions": 35,
      "deletions": 0,
      "changes": 35,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/StatusField.css",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/StatusField.css",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/StatusField.css?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -0,0 +1,35 @@\n+.status {\n+  font-family: var(--v2-font-family-primary);\n+  font-weight: var(--v2-font-weight-primary-regular);\n+  font-size: var(--v2-font-size-2);\n+  line-height: var(--v2-line-height-reset);\n+\n+  border-radius: 2px;\n+  padding-left: var(--v2-spacing-1);\n+  padding-right: var(--v2-spacing-1);\n+}\n+\n+.active {\n+  background-color: var(--v2-colors-green-500);\n+  color: var(--v2-colors-pure-white);\n+}\n+\n+.expiring {\n+  background-color: var(--v2-colors-yellow-500);\n+  color: var(--v2-colors-mono-500);\n+\n+  padding-top: var(--v2-spacing-1);\n+  padding-bottom: var(--v2-spacing-1);\n+}\n+\n+.expired {\n+  background-color: var(--v2-colors-red-500);\n+  color: var(--v2-colors-pure-white);\n+\n+  padding-top: var(--v2-spacing-1);\n+  padding-bottom: var(--v2-spacing-1);\n+}\n+\n+.icon {\n+  padding-right: var(--v2-spacing-1);\n+}"
    },
    {
      "sha": "c6f8355543ff6438b1685449c9924beca83ed917",
      "filename": "src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/StatusField.tsx",
      "status": "added",
      "additions": 117,
      "deletions": 0,
      "changes": 117,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/StatusField.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/StatusField.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/routes/Configure/sections/Auth/SSOKeyRotation/StatusField.tsx?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -0,0 +1,117 @@\n+import { Localized } from \"@fluent/react/compat\";\n+import cn from \"classnames\";\n+import React, { FunctionComponent } from \"react\";\n+\n+import { Flex, Icon, Tooltip, TooltipButton } from \"coral-ui/components/v2\";\n+\n+import styles from \"./StatusField.css\";\n+\n+export enum SSOKeyStatus {\n+  EXPIRED,\n+  EXPIRING,\n+  ACTIVE,\n+}\n+\n+interface Props {\n+  status: SSOKeyStatus;\n+}\n+\n+const StatusField: FunctionComponent<Props> = ({ status }) => {\n+  switch (status) {\n+    case SSOKeyStatus.ACTIVE:\n+      return (\n+        <Localized id=\"configure-auth-sso-rotate-statusActive\">\n+          <span\n+            className={cn(styles.status, styles.active)}\n+            data-testid=\"SSO-Key-Status\"\n+          >\n+            Active\n+          </span>\n+        </Localized>\n+      );\n+    case SSOKeyStatus.EXPIRING:\n+      return (\n+        <Flex alignItems=\"center\" justifyContent=\"center\">\n+          <Flex\n+            alignItems=\"center\"\n+            justifyContent=\"center\"\n+            className={cn(styles.status, styles.expiring)}\n+          >\n+            <Icon className={styles.icon}>alarm</Icon>\n+            <Localized id=\"configure-auth-sso-rotate-statusExpiring\">\n+              <span data-testid=\"SSO-Key-Status\">Expiring</span>\n+            </Localized>\n+          </Flex>\n+          <Tooltip\n+            id=\"configure-auth-sso-rotate-expiringTooltip\"\n+            title=\"\"\n+            body={\n+              <Localized id=\"configure-auth-sso-rotate-expiringTooltip\">\n+                <span>\n+                  An SSO key is expiring when it is scheduled for rotation.\n+                </span>\n+              </Localized>\n+            }\n+            button={({ toggleVisibility, ref, visible }) => (\n+              <Localized\n+                id=\"configure-auth-sso-rotate-expiringTooltip-toggleButton\"\n+                attrs={{ \"aria-label\": true }}\n+              >\n+                <TooltipButton\n+                  active\n+                  aria-label=\"Toggle expiring tooltip visibility\"\n+                  toggleVisibility={toggleVisibility}\n+                  ref={ref}\n+                />\n+              </Localized>\n+            )}\n+          />\n+        </Flex>\n+      );\n+    case SSOKeyStatus.EXPIRED:\n+      return (\n+        <Flex alignItems=\"center\" justifyContent=\"center\">\n+          <Localized id=\"configure-auth-sso-rotate-statusExpired\">\n+            <span\n+              className={cn(styles.status, styles.expired)}\n+              data-testid=\"SSO-Key-Status\"\n+            >\n+              Expired\n+            </span>\n+          </Localized>\n+          <Tooltip\n+            id=\"configure-auth-sso-rotate-expiredTooltip\"\n+            title=\"\"\n+            body={\n+              <Localized id=\"configure-auth-sso-rotate-expiredTooltip\">\n+                <span>\n+                  An SSO key is expired when it has been rotated out of use.\n+                </span>\n+              </Localized>\n+            }\n+            button={({ toggleVisibility, ref, visible }) => (\n+              <Localized\n+                id=\"configure-auth-sso-rotate-expiredTooltip-toggleButton\"\n+                attrs={{ \"aria-label\": true }}\n+              >\n+                <TooltipButton\n+                  active\n+                  aria-label=\"Toggle expired tooltip visibility\"\n+                  toggleVisibility={toggleVisibility}\n+                  ref={ref}\n+                />\n+              </Localized>\n+            )}\n+          />\n+        </Flex>\n+      );\n+    default:\n+      return (\n+        <Localized id=\"configure-auth-sso-rotate-statusUnknown\">\n+          <span data-testid=\"SSO-Key-Status\">Unknown</span>\n+        </Localized>\n+      );\n+  }\n+};\n+\n+export default StatusField;"
    },
    {
      "sha": "c261b3c9a21015715d2c646007ac79f825f8206d",
      "filename": "src/core/client/admin/test/configure/__snapshots__/auth.spec.tsx.snap",
      "status": "modified",
      "additions": 210,
      "deletions": 63,
      "changes": 273,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/test/configure/__snapshots__/auth.spec.tsx.snap",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/test/configure/__snapshots__/auth.spec.tsx.snap",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/test/configure/__snapshots__/auth.spec.tsx.snap?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -1242,86 +1242,233 @@ integration to register for a new account.\n                 <div\n                   className=\"Box-root HorizontalGutter-root HorizontalGutter-spacing-4\"\n                 >\n-                  <div\n-                    className=\"Box-root HorizontalGutter-root FormField-root SSOKeyField-root HorizontalGutter-spacing-2\"\n+                  <p\n+                    className=\"FormFieldDescription-root\"\n                   >\n-                    <label\n-                      className=\"Label-root\"\n-                      htmlFor=\"configure-auth-sso-key\"\n+                    To enable integration with your existing authentication system,\n+you will need to create a JWT Token to connect. You can learn\n+more about creating a JWT Token with \n+                    <a\n+                      className=\"ExternalLink-root\"\n+                      href=\"https://jwt.io/introduction/\"\n+                      rel=\"noopener noreferrer\"\n+                      target=\"_blank\"\n                     >\n-                      Key\n-                    </label>\n+                      this introduction\n+                    </a>\n+                    . See our\n+\n+                    <a\n+                      className=\"ExternalLink-root\"\n+                      href=\"https://docs.coralproject.net/coral/v5/integrating/sso/\"\n+                      rel=\"noopener noreferrer\"\n+                      target=\"_blank\"\n+                    >\n+                      documentation\n+                    </a>\n+                     for additional information on single sign on.\n+                  </p>\n+                  <label\n+                    className=\"Label-root\"\n+                    htmlFor=\"configure-auth-sso-rotate-keys\"\n+                  >\n+                    Keys\n+                  </label>\n+                  <div\n+                    className=\"Card-root\"\n+                  >\n                     <div\n-                      className=\"PasswordField-fullWidth PasswordField-root\"\n+                      className=\"Box-root HorizontalGutter-root HorizontalGutter-full\"\n                     >\n                       <div\n-                        className=\"PasswordField-wrapper\"\n+                        className=\"Box-root Flex-root Flex-flex Flex-justifySpaceBetween Flex-alignCenter\"\n                       >\n-                        <input\n-                          autoCapitalize=\"off\"\n-                          autoComplete=\"off\"\n-                          autoCorrect=\"off\"\n-                          className=\"PasswordField-colorRegular PasswordField-fullWidth PasswordField-input\"\n-                          data-testid=\"password-field\"\n-                          id=\"configure-auth-sso-key\"\n-                          name=\"key\"\n-                          placeholder=\"\"\n-                          readOnly={true}\n-                          spellCheck={false}\n-                          type=\"password\"\n-                        />\n                         <div\n-                          className=\"PasswordField-icon\"\n-                          onClick={[Function]}\n-                          onKeyUp={[Function]}\n-                          role=\"button\"\n-                          tabIndex={0}\n-                          title=\"Hide SSO Key\"\n+                          className=\"SSOKeyCard-keySection\"\n                         >\n-                          <i\n-                            aria-hidden=\"true\"\n-                            className=\"Icon-root Icon-sm\"\n+                          <div\n+                            className=\"SSOKeyCard-label\"\n                           >\n-                            visibility\n-                          </i>\n+                            <label\n+                              className=\"Label-root\"\n+                            >\n+                              Key ID\n+                            </label>\n+                          </div>\n+                          <div\n+                            className=\"TextField-root TextField-fullWidth\"\n+                          >\n+                            <input\n+                              className=\"TextField-input TextField-colorRegular\"\n+                              data-testid=\"SSO-Key-ID\"\n+                              placeholder=\"\"\n+                              readOnly={true}\n+                              type=\"text\"\n+                              value=\"kid-01\"\n+                            />\n+                          </div>\n+                        </div>\n+                        <div\n+                          className=\"SSOKeyCard-secretSection\"\n+                        >\n+                          <div\n+                            className=\"SSOKeyCard-label\"\n+                          >\n+                            <label\n+                              className=\"Label-root\"\n+                            >\n+                              Secret\n+                            </label>\n+                          </div>\n+                          <div\n+                            className=\"Box-root Flex-root Flex-flex Flex-justifyFlexStart Flex-alignCenter\"\n+                          >\n+                            <div\n+                              className=\"PasswordField-fullWidth PasswordField-root\"\n+                            >\n+                              <div\n+                                className=\"PasswordField-wrapper\"\n+                              >\n+                                <input\n+                                  autoCapitalize=\"off\"\n+                                  autoComplete=\"off\"\n+                                  autoCorrect=\"off\"\n+                                  className=\"PasswordField-colorRegular PasswordField-fullWidth PasswordField-input\"\n+                                  data-testid=\"password-field\"\n+                                  id=\"configure-auth-sso-rotate-secretField\"\n+                                  name=\"key\"\n+                                  placeholder=\"\"\n+                                  readOnly={true}\n+                                  spellCheck={false}\n+                                  type=\"password\"\n+                                  value=\"secret\"\n+                                />\n+                                <div\n+                                  className=\"PasswordField-icon\"\n+                                  onClick={[Function]}\n+                                  onKeyUp={[Function]}\n+                                  role=\"button\"\n+                                  tabIndex={0}\n+                                  title=\"Hide Secret\"\n+                                >\n+                                  <i\n+                                    aria-hidden=\"true\"\n+                                    className=\"Icon-root Icon-sm\"\n+                                  >\n+                                    visibility\n+                                  </i>\n+                                </div>\n+                              </div>\n+                            </div>\n+                            <button\n+                              className=\"BaseButton-root Button-root Button-sizeRegular Button-colorMono Button-variantFlat Button-uppercase\"\n+                              data-color=\"mono\"\n+                              data-variant=\"flat\"\n+                              onBlur={[Function]}\n+                              onClick={[Function]}\n+                              onFocus={[Function]}\n+                              onMouseOut={[Function]}\n+                              onMouseOver={[Function]}\n+                              onTouchEnd={[Function]}\n+                              type=\"button\"\n+                            >\n+                              <i\n+                                aria-hidden=\"true\"\n+                                aria-label=\"Copy Secret\"\n+                                className=\"Icon-root Icon-md\"\n+                              >\n+                                content_copy\n+                              </i>\n+                            </button>\n+                          </div>\n                         </div>\n                       </div>\n-                    </div>\n-                    <div\n-                      className=\"SSOKeyField-warningSection\"\n-                    >\n                       <div\n-                        className=\"Box-root Flex-root Flex-flex Flex-halfItemGutter Flex-directionRow gutter\"\n+                        className=\"Box-root Flex-root Flex-flex Flex-justifySpaceBetween Flex-alignFlexEnd\"\n                       >\n-                        <i\n-                          aria-hidden=\"true\"\n-                          className=\"Icon-root Icon-sm SSOKeyField-warnIcon\"\n+                        <div\n+                          className=\"Box-root Flex-root Flex-flex Flex-justifyFlexStart Flex-alignCenter\"\n                         >\n-                          warning\n-                        </i>\n-                        <p\n-                          className=\"HelperText-root\"\n+                          <div\n+                            className=\"SSOKeyCard-statusSection\"\n+                          >\n+                            <div\n+                              className=\"SSOKeyCard-label\"\n+                            >\n+                              <label\n+                                className=\"Label-root\"\n+                              >\n+                                Status\n+                              </label>\n+                            </div>\n+                            <span\n+                              className=\"StatusField-status StatusField-active\"\n+                              data-testid=\"SSO-Key-Status\"\n+                            >\n+                              Active\n+                            </span>\n+                          </div>\n+                          <div>\n+                            <div\n+                              className=\"DateField-label\"\n+                            >\n+                              <label\n+                                className=\"Label-root\"\n+                              >\n+                                Active Since\n+                              </label>\n+                            </div>\n+                            <span\n+                              className=\"DateField-date\"\n+                            >\n+                              1/1/2020, 1:00 AM\n+                            </span>\n+                          </div>\n+                        </div>\n+                        <div\n+                          className=\"Popover-root\"\n                         >\n-                          When regenerating a key, tokens signed with the previous key will be honored for 30 days.\n-                        </p>\n+                          <button\n+                            className=\"BaseButton-root Button-root Button-sizeRegular Button-colorRegular Button-variantRegular Button-uppercase Button-disabled\"\n+                            data-color=\"regular\"\n+                            data-variant=\"regular\"\n+                            disabled={true}\n+                            onBlur={[Function]}\n+                            onClick={[Function]}\n+                            onFocus={[Function]}\n+                            onMouseOut={[Function]}\n+                            onMouseOver={[Function]}\n+                            onTouchEnd={[Function]}\n+                            type=\"button\"\n+                          >\n+                            <span\n+                              className=\"RotationDropdown-rotate\"\n+                            >\n+                              Rotate\n+                            </span>\n+                            <i\n+                              aria-hidden=\"true\"\n+                              className=\"Icon-root Icon-sm\"\n+                            >\n+                              arrow_drop_down\n+                            </i>\n+                          </button>\n+                          <div\n+                            aria-hidden={true}\n+                            aria-labelledby=\"sso-key-rotate-ariainfo\"\n+                            id=\"sso-key-rotate\"\n+                            role=\"dialog\"\n+                          >\n+                            <div\n+                              className=\"AriaInfo-root\"\n+                              id=\"sso-key-rotate-ariainfo\"\n+                            >\n+                              A dropdown to rotate the SSO key\n+                            </div>\n+                          </div>\n+                        </div>\n                       </div>\n                     </div>\n-                    <button\n-                      className=\"BaseButton-root Button-root Button-sizeRegular Button-colorRegular Button-variantRegular Button-uppercase Button-disabled SSOKeyField-regenerateButton\"\n-                      data-color=\"regular\"\n-                      data-variant=\"regular\"\n-                      disabled={true}\n-                      id=\"configure-auth-sso-regenerate\"\n-                      onBlur={[Function]}\n-                      onClick={[Function]}\n-                      onFocus={[Function]}\n-                      onMouseOut={[Function]}\n-                      onMouseOver={[Function]}\n-                      onTouchEnd={[Function]}\n-                      type=\"button\"\n-                    >\n-                      Regenerate\n-                    </button>\n                   </div>\n                   <div\n                     className=\"Box-root HorizontalGutter-root FormField-root HorizontalGutter-spacing-2\""
    },
    {
      "sha": "b018430086e6d3427baa2f238bf4a054d7844849",
      "filename": "src/core/client/admin/test/configure/auth.spec.tsx",
      "status": "modified",
      "additions": 50,
      "deletions": 10,
      "changes": 60,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/test/configure/auth.spec.tsx",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/test/configure/auth.spec.tsx",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/test/configure/auth.spec.tsx?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -9,6 +9,7 @@ import {\n   CreateTestRendererParams,\n   findParentWithType,\n   replaceHistoryLocation,\n+  toJSON,\n   wait,\n   waitForElement,\n   within,\n@@ -57,20 +58,34 @@ it(\"renders configure auth\", async () => {\n   expect(within(configureContainer).toJSON()).toMatchSnapshot();\n });\n \n-it(\"regenerate sso key\", async () => {\n+it(\"rotate sso key\", async () => {\n   const { testRenderer } = await createTestRenderer({\n     resolvers: createResolversStub<GQLResolver>({\n       Mutation: {\n-        regenerateSSOKey: () => {\n+        rotateSSOKey: () => {\n           return {\n             settings: pureMerge<typeof settingsWithEmptyAuth>(\n               settingsWithEmptyAuth,\n               {\n                 auth: {\n                   integrations: {\n                     sso: {\n-                      key: \"==GENERATED_KEY==\",\n-                      keyGeneratedAt: \"2018-11-12T23:26:06.239Z\",\n+                      enabled: true,\n+                      keys: [\n+                        {\n+                          kid: \"kid-01\",\n+                          secret: \"secret\",\n+                          createdAt: \"2015-01-01T00:00:00.000Z\",\n+                          lastUsedAt: \"2016-01-01T01:45:00.000Z\",\n+                          rotatedAt: \"2016-01-01T01:45:00.000Z\",\n+                          inactiveAt: \"2016-01-01T01:45:00.000Z\",\n+                        },\n+                        {\n+                          kid: \"kid-02\",\n+                          secret: \"new-secret\",\n+                          createdAt: \"2019-01-01T01:45:00.000Z\",\n+                        },\n+                      ],\n                     },\n                   },\n                 },\n@@ -90,15 +105,40 @@ it(\"regenerate sso key\", async () => {\n \n   act(() => {\n     within(container)\n-      .getByText(\"Regenerate\", { selector: \"button\" })\n+      .getByText(\"Rotate\", { selector: \"button\" })\n       .props.onClick();\n   });\n \n-  await wait(() =>\n-    expect(within(container).getByLabelText(\"Key\").props.value).toBe(\n-      \"==GENERATED_KEY==\"\n-    )\n-  );\n+  const rotateNow = await waitForElement(() => {\n+    return within(container).getByText(\"Now\", { selector: \"button\" });\n+  });\n+\n+  act(() => {\n+    rotateNow.props.onClick();\n+  });\n+\n+  await wait(() => {\n+    // Check that we have two SSO Keys that match\n+    // our expected key IDs\n+    const keyIDs = within(container).getAllByTestID(\"SSO-Key-ID\");\n+    const hasOldKey = keyIDs.some(k => k.props.value === \"kid-01\");\n+    const hasNewKey = keyIDs.some(k => k.props.value === \"kid-02\");\n+    expect(hasNewKey).toBe(true);\n+    expect(hasOldKey).toBe(true);\n+\n+    const statuses = within(container).getAllByTestID(\"SSO-Key-Status\");\n+    expect(statuses.length).toBe(2);\n+    const firstStatus: any = toJSON(statuses[0]);\n+    const firstStatusIsActive = firstStatus.children.some(\n+      (s: string) => s === \"Active\"\n+    );\n+    expect(firstStatusIsActive).toBe(true);\n+    const secondStatus: any = toJSON(statuses[1]);\n+    const secondStatusIsActive = secondStatus.children.some(\n+      (s: string) => s === \"Active\"\n+    );\n+    expect(secondStatusIsActive).toBe(false);\n+  });\n });\n \n it(\"prevents admin lock out\", async () => {"
    },
    {
      "sha": "ae14ee502ae66405136acb1b9e3f2ac3ec1455e6",
      "filename": "src/core/client/admin/test/fixtures.ts",
      "status": "modified",
      "additions": 20,
      "deletions": 0,
      "changes": 20,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/test/fixtures.ts",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/client/admin/test/fixtures.ts",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/client/admin/test/fixtures.ts?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -114,6 +114,16 @@ export const settings = createFixture<GQLSettings>({\n           admin: true,\n           stream: true,\n         },\n+        keys: [\n+          {\n+            kid: \"kid-01\",\n+            secret: \"secret\",\n+            createdAt: \"2020-01-01T01:00:00.000Z\",\n+            lastUsedAt: undefined,\n+            rotatedAt: undefined,\n+            inactiveAt: undefined,\n+          },\n+        ],\n         key: \"\",\n         keyGeneratedAt: null,\n       },\n@@ -202,6 +212,16 @@ export const settingsWithEmptyAuth = createFixture<GQLSettings>(\n             stream: true,\n           },\n           key: \"\",\n+          keys: [\n+            {\n+              kid: \"kid-01\",\n+              secret: \"secret\",\n+              createdAt: \"2020-01-01T01:00:00.000Z\",\n+              lastUsedAt: undefined,\n+              rotatedAt: undefined,\n+              inactiveAt: undefined,\n+            },\n+          ],\n           keyGeneratedAt: null,\n         },\n         google: {"
    },
    {
      "sha": "2b63a86752293927f6485288599a9aa7ba577a24",
      "filename": "src/core/server/graph/schema/schema.graphql",
      "status": "modified",
      "additions": 28,
      "deletions": 28,
      "changes": 56,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/server/graph/schema/schema.graphql",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/core/server/graph/schema/schema.graphql",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/core/server/graph/schema/schema.graphql?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -5970,6 +5970,34 @@ type DeactivateSSOKeyPayload {\n   settings: Settings\n }\n \n+#########################\n+## deleteSSOKey\n+#########################\n+\n+input DeleteSSOKeyInput {\n+  \"\"\"\n+  clientMutationId is required for Relay support.\n+  \"\"\"\n+  clientMutationId: String!\n+\n+  \"\"\"\n+  kid is the ID of the SSOKey being deleted.\n+  \"\"\"\n+  kid: ID!\n+}\n+\n+type DeleteSSOKeyPayload {\n+  \"\"\"\n+  clientMutationId is required for Relay support.\n+  \"\"\"\n+  clientMutationId: String!\n+\n+  \"\"\"\n+  settings is the Settings that the SSO key was regenerated on.\n+  \"\"\"\n+  settings: Settings\n+}\n+\n #########################\n # disableFeatureFlag\n #########################\n@@ -6064,34 +6092,6 @@ type RemoveStoryExpertPayload {\n   story: Story!\n }\n \n-#########################\n-## deleteSSOKey\n-#########################\n-\n-input DeleteSSOKeyInput {\n-  \"\"\"\n-  clientMutationId is required for Relay support.\n-  \"\"\"\n-  clientMutationId: String!\n-\n-  \"\"\"\n-  kid is the ID of the SSOKey being deleted.\n-  \"\"\"\n-  kid: ID!\n-}\n-\n-type DeleteSSOKeyPayload {\n-  \"\"\"\n-  clientMutationId is required for Relay support.\n-  \"\"\"\n-  clientMutationId: String!\n-\n-  \"\"\"\n-  settings is the Settings that the SSO key was regenerated on.\n-  \"\"\"\n-  settings: Settings\n-}\n-\n #########################\n ## updateStoryMode\n #########################"
    },
    {
      "sha": "36a53526d1507f6fa9865253b095be9a2d0d452c",
      "filename": "src/locales/en-US/admin.ftl",
      "status": "modified",
      "additions": 45,
      "deletions": 0,
      "changes": 45,
      "blob_url": "https://github.com/coralproject/talk/blob/9a58673545e0d720b1719c273746f2a65b38e45c/src/locales/en-US/admin.ftl",
      "raw_url": "https://github.com/coralproject/talk/raw/9a58673545e0d720b1719c273746f2a65b38e45c/src/locales/en-US/admin.ftl",
      "contents_url": "https://api.github.com/repos/coralproject/talk/contents/src/locales/en-US/admin.ftl?ref=9a58673545e0d720b1719c273746f2a65b38e45c",
      "patch": "@@ -427,6 +427,51 @@ configure-auth-sso-regenerateAt = KEY GENERATED AT:\n configure-auth-sso-regenerateHonoredWarning =\n   When regenerating a key, tokens signed with the previous key will be honored for 30 days.\n \n+configure-auth-sso-description =\n+  To enable integration with your existing authentication system,\n+  you will need to create a JWT Token to connect. You can learn\n+  more about creating a JWT Token with <IntroLink>this introduction</IntroLink>. See our\n+  <DocLink>documentation</DocLink> for additional information on single sign on.\n+\n+configure-auth-sso-rotate-keys = Keys\n+configure-auth-sso-rotate-keyID = Key ID\n+configure-auth-sso-rotate-secret = Secret\n+configure-auth-sso-rotate-copySecret =\n+  .aria-label = Copy Secret\n+\n+configure-auth-sso-rotate-date =\n+  { DATETIME($date, year: \"numeric\", month: \"numeric\", day: \"numeric\", hour: \"numeric\", minute: \"numeric\") }\n+configure-auth-sso-rotate-activeSince = Active Since\n+configure-auth-sso-rotate-inactiveAt = Inactive At\n+configure-auth-sso-rotate-inactiveSince = Inactive Since\n+\n+configure-auth-sso-rotate-status = Status\n+configure-auth-sso-rotate-statusActive = Active\n+configure-auth-sso-rotate-statusExpiring = Expiring\n+configure-auth-sso-rotate-statusExpired = Expired\n+configure-auth-sso-rotate-statusUnknown = Unknown\n+\n+configure-auth-sso-rotate-expiringTooltip =\n+  An SSO key is expiring when it is scheduled for rotation.\n+configure-auth-sso-rotate-expiringTooltip-toggleButton =\n+  .aria-label = Toggle expiring tooltip visibility\n+configure-auth-sso-rotate-expiredTooltip =\n+  An SSO key is expired when it has been rotated out of use.\n+configure-auth-sso-rotate-expiredTooltip-toggleButton =\n+  Toggle expired tooltip visibility\n+\n+configure-auth-sso-rotate-rotate = Rotate\n+configure-auth-sso-rotate-deactivateNow = Deactivate Now\n+configure-auth-sso-rotate-delete = Delete\n+\n+configure-auth-sso-rotate-now = Now\n+configure-auth-sso-rotate-10seconds = 10 seconds from now\n+configure-auth-sso-rotate-1day = 1 day from now\n+configure-auth-sso-rotate-1week = 1 week from now\n+configure-auth-sso-rotate-30days = 30 days from now\n+configure-auth-sso-rotate-dropdown-description =\n+  .description = A dropdown to rotate the SSO key\n+\n configure-auth-local-loginWith = Login with email authentication\n configure-auth-local-useLoginOn = Use email authentication login on\n "
    }
  ]
}
